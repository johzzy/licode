/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 https://mths.be/utf8js v2.1.2 by @mathias */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(m,d,h){m!=Array.prototype&&m!=Object.prototype&&(m[d]=h.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(m){return $jscomp.SYMBOL_PREFIX+(m||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var m=$jscomp.global.Symbol.iterator;m||(m=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[m]&&$jscomp.defineProperty(Array.prototype,m,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(m){var d=0;return $jscomp.iteratorPrototype(function(){return d<m.length?{done:!1,value:m[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(m){$jscomp.initSymbolIterator();m={next:m};m[$jscomp.global.Symbol.iterator]=function(){return this};return m};$jscomp.makeIterator=function(m){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=m[Symbol.iterator];return d?d.call(m):$jscomp.arrayIterator(m)};
$jscomp.polyfill=function(m,d,h,e){if(d){h=$jscomp.global;m=m.split(".");for(e=0;e<m.length-1;e++){var q=m[e];q in h||(h[q]={});h=h[q]}m=m[m.length-1];e=h[m];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(h,m,{configurable:!0,writable:!0,value:d})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(m){function d(){this.batch_=null}function h(a){return a instanceof q?a:new q(function(b,k){b(a)})}if(m&&!$jscomp.FORCE_POLYFILL_PROMISE)return m;d.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};d.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global.setTimeout;d.prototype.asyncExecuteFunction=function(a){e(a,
0)};d.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var k=a[b];delete a[b];try{k()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};d.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var q=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};q.prototype.createResolveAndReject_=
function(){function a(a){return function(n){k||(k=!0,a.call(b,n))}}var b=this,k=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};q.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof q)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};q.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};q.prototype.reject_=function(a){this.settle_(2,a)};q.prototype.fulfill_=function(a){this.settle_(1,a)};q.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};q.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var g=new d;q.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};q.prototype.settleSameAsThenable_=function(a,b){var k=this.createResolveAndReject_();try{a.call(b,k.resolve,k.reject)}catch(p){k.reject(p)}};q.prototype.then=function(a,b){function k(a,c){return"function"==typeof a?function(c){try{p(a(c))}catch(u){n(u)}}:c}var p,n,l=new q(function(a,
c){p=a;n=c});this.callWhenSettled_(k(a,p),k(b,n));return l};q.prototype.catch=function(a){return this.then(void 0,a)};q.prototype.callWhenSettled_=function(a,b){function k(){switch(p.state_){case 1:a(p.result_);break;case 2:b(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?g.asyncExecute(k):this.onSettledCallbacks_.push(function(){g.asyncExecute(k)})};q.resolve=h;q.reject=function(a){return new q(function(b,k){k(a)})};q.race=function(a){return new q(function(b,
k){for(var p=$jscomp.makeIterator(a),n=p.next();!n.done;n=p.next())h(n.value).callWhenSettled_(b,k)})};q.all=function(a){var b=$jscomp.makeIterator(a),k=b.next();return k.done?h([]):new q(function(a,n){function l(b){return function(l){f[b]=l;c--;0==c&&a(f)}}var f=[],c=0;do f.push(void 0),c++,h(k.value).callWhenSettled_(l(f.length-1),n),k=b.next();while(!k.done)})};return q},"es6-impl","es3");
$jscomp.executeAsyncGenerator=function(m){function d(e){return m.next(e)}function h(e){return m.throw(e)}return new Promise(function(e,q){function g(a){a.done?e(a.value):Promise.resolve(a.value).then(d,h).then(g,q)}g(m.next())})};$jscomp.inherits=function(m,d){function h(){}h.prototype=d.prototype;m.superClass_=d.prototype;m.prototype=new h;m.prototype.constructor=m;for(var e in d)if(Object.defineProperties){var q=Object.getOwnPropertyDescriptor(d,e);q&&Object.defineProperty(m,e,q)}else m[e]=d[e]};
$jscomp.arrayFromIterator=function(m){for(var d,h=[];!(d=m.next()).done;)h.push(d.value);return h};$jscomp.arrayFromIterable=function(m){return m instanceof Array?m:$jscomp.arrayFromIterator($jscomp.makeIterator(m))};$jscomp.owns=function(m,d){return Object.prototype.hasOwnProperty.call(m,d)};
$jscomp.polyfill("WeakMap",function(m){function d(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function h(a){var b=Object[a];b&&(Object[a]=function(a){d(a);return b(a)})}if(function(){if(!m||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),k=new m([[a,2],[b,3]]);if(2!=k.get(a)||3!=k.get(b))return!1;k.delete(a);k.set(b,4);return!k.has(a)&&4==k.get(b)}catch(p){return!1}}())return m;var e="$jscomp_hidden_"+Math.random().toString().substring(2);h("freeze");h("preventExtensions");
h("seal");var q=0,g=function(a){this.id_=(q+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};g.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=b;return this};g.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};g.prototype.has=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};g.prototype.delete=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return g},"es6-impl","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(m){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!m||!m.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),k=new m($jscomp.makeIterator([[a,"s"]]));if("s"!=k.get(a)||1!=k.size||k.get({x:4})||k.set({x:4},"t")!=k||2!=k.size)return!1;var p=k.entries(),n=p.next();if(n.done||n.value[0]!=a||"s"!=n.value[1])return!1;n=p.next();return n.done||4!=n.value[0].x||"t"!=n.value[1]||!p.next().done?!1:!0}catch(l){return!1}}())return m;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var d=new WeakMap,h=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,k){var b=e(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=k:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:k},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};h.prototype.delete=
function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};h.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};h.prototype.has=function(a){return!!e(this,a).entry};h.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};h.prototype.entries=function(){return q(this,function(a){return[a.key,
a.value]})};h.prototype.keys=function(){return q(this,function(a){return a.key})};h.prototype.values=function(){return q(this,function(a){return a.value})};h.prototype.forEach=function(a,k){for(var b=this.entries(),n;!(n=b.next()).done;)n=n.value,a.call(k,n[1],n[0],this)};h.prototype[Symbol.iterator]=h.prototype.entries;var e=function(b,k){var p=k&&typeof k;"object"==p||"function"==p?d.has(k)?p=d.get(k):(p=""+ ++a,d.set(k,p)):p="p_"+k;var n=b.data_[p];if(n&&$jscomp.owns(b.data_,p))for(b=0;b<n.length;b++){var l=
n[b];if(k!==k&&l.key!==l.key||k===l.key)return{id:p,list:n,index:b,entry:l}}return{id:p,list:n,index:-1,entry:void 0}},q=function(a,k){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:k(b)};b=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=a.next=a.head=a},a=0;return h},"es6-impl","es3");
$jscomp.iteratorFromArray=function(m,d){$jscomp.initSymbolIterator();m instanceof String&&(m+="");var h=0,e={next:function(){if(h<m.length){var q=h++;return{value:d(q,m[q]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(m){return m?m:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6-impl","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");$jscomp.polyfill("Object.assign",function(m){return m?m:function(d,h){for(var e=1;e<arguments.length;e++){var q=arguments[e];if(q)for(var g in q)$jscomp.owns(q,g)&&(d[g]=q[g])}return d}},"es6-impl","es3");
$jscomp.checkStringArgs=function(m,d,h){if(null==m)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return m+""};
$jscomp.polyfill("String.prototype.startsWith",function(m){return m?m:function(d,h){var e=$jscomp.checkStringArgs(this,d,"startsWith");d+="";var q=e.length,g=d.length;h=Math.max(0,Math.min(h|0,e.length));for(var a=0;a<g&&h<q;)if(e[h++]!=d[a++])return!1;return a>=g}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(m){return m?m:function(d,h,e){var q=this.length||0;0>h&&(h=Math.max(0,q+h));if(null==e||e>q)e=q;e=Number(e);0>e&&(e=Math.max(0,q+e));for(h=Number(h||0);h<e;h++)this[h]=d;return this}},"es6-impl","es3");$jscomp.findInternal=function(m,d,h){m instanceof String&&(m=String(m));for(var e=m.length,q=0;q<e;q++){var g=m[q];if(d.call(h,g,q,m))return{i:q,v:g}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(m){return m?m:function(d,h){return $jscomp.findInternal(this,d,h).v}},"es6-impl","es3");$jscomp.polyfill("Object.is",function(m){return m?m:function(d,h){return d===h?0!==d||1/d===1/h:d!==d&&h!==h}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.includes",function(m){return m?m:function(d,h){var e=this;e instanceof String&&(e=String(e));var q=e.length;for(h=h||0;h<q;h++)if(e[h]==d||Object.is(e[h],d))return!0;return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(m){return m?m:function(d,h){return-1!==$jscomp.checkStringArgs(this,d,"includes").indexOf(d,h||0)}},"es6-impl","es3");$jscomp.polyfill("String.prototype.endsWith",function(m){return m?m:function(d,h){var e=$jscomp.checkStringArgs(this,d,"endsWith");d+="";void 0===h&&(h=e.length);h=Math.max(0,Math.min(h|0,e.length));for(var q=d.length;0<q&&0<h;)if(e[--h]!=d[--q])return!1;return 0>=q}},"es6-impl","es3");
var Erizo=function(m){function d(e){if(h[e])return h[e].exports;var q=h[e]={i:e,l:!1,exports:{}};m[e].call(q.exports,q,q.exports,d);q.l=!0;return q.exports}var h={};d.m=m;d.c=h;d.d=function(e,q,g){d.o(e,q)||Object.defineProperty(e,q,{configurable:!1,enumerable:!0,get:g})};d.n=function(e){var q=e&&e.__esModule?function(){return e["default"]}:function(){return e};d.d(q,"a",q);return q};d.o=function(e,q){return Object.prototype.hasOwnProperty.call(e,q)};d.p="";return d(d.s=35)}([function(m,d,h){var e=
function(){var q="";var g=function(a){console.log.apply(console,[].concat($jscomp.arrayFromIterable(a)))};var a=function(a,b){for(var f=[],c=1;c<arguments.length;++c)f[c-1]=arguments[c];c=q;a===e.DEBUG?c+="DEBUG":a===e.TRACE?c+="TRACE":a===e.INFO?c+="INFO":a===e.WARNING?c+="WARNING":a===e.ERROR&&(c+="ERROR");f=[c+": "].concat(f);if(void 0!==e.panel){for(var c="",l=0;l<f.length;l+=1)c+=f[l];e.panel.value=e.panel.value+"\n"+c}else g.apply(e,[f])},b=function(b,l,f,c){for(var n=[],k=3;k<arguments.length;++k)n[k-
3]=arguments[k];void 0===l&&f>=e.logLevel?a.apply(null,[].concat([f,"("+b+")"],$jscomp.arrayFromIterable(n))):f>=l&&a.apply(null,[].concat([f,"("+b+")"],$jscomp.arrayFromIterable(n)))},k=function(a){this.name=a};k.prototype.setLogLevel=function(a){this.level=a};k.prototype.debug=function(a){for(var l=[],f=0;f<arguments.length;++f)l[f-0]=arguments[f];b.apply(null,[].concat([this.name,this.level,e.DEBUG],$jscomp.arrayFromIterable(l)))};k.prototype.trace=function(a){for(var l=[],f=0;f<arguments.length;++f)l[f-
0]=arguments[f];b.apply(null,[].concat([this.name,this.level,e.TRACE],$jscomp.arrayFromIterable(l)))};k.prototype.info=function(a){for(var l=[],f=0;f<arguments.length;++f)l[f-0]=arguments[f];b.apply(null,[].concat([this.name,this.level,e.INFO],$jscomp.arrayFromIterable(l)))};k.prototype.warning=function(a){for(var l=[],f=0;f<arguments.length;++f)l[f-0]=arguments[f];b.apply(null,[].concat([this.name,this.level,e.WARNING],$jscomp.arrayFromIterable(l)))};k.prototype.error=function(a){for(var l=[],f=
0;f<arguments.length;++f)l[f-0]=arguments[f];b.apply(null,[].concat([this.name,this.level,e.ERROR],$jscomp.arrayFromIterable(l)))};var p=new Map;return{logLevel:0,DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){var b=a;a>e.NONE?b=e.NONE:a<e.DEBUG&&(b=e.DEBUG);e.logLevel=b},setOutputFunction:function(a){g=a},setLogPrefix:function(a){q=a},module:function(a){if(p.has(a))return p.get(a);var b=new k(a);p.set(a,b);return b}}}();d.a=e},function(m,d){d=function(){return this}();try{d=
d||Function("return this")()||(0,eval)("this")}catch(h){"object"===typeof window&&(d=window)}m.exports=d},function(m,d,h){h.d(d,"b",function(){return q});h.d(d,"c",function(){return g});h.d(d,"d",function(){return a});h.d(d,"e",function(){return k});h.d(d,"f",function(){return p});h.d(d,"a",function(){return b});var e=h(0).a.module("EventDispatcher"),q=function(){var a={},b={};a.addEventListener=function(a,c){void 0===b[a]&&(b[a]=[]);b[a].push(c)};a.removeEventListener=function(a,c){b[a]&&(c=b[a].indexOf(c),
-1!==c&&b[a].splice(c,1))};a.removeAllListeners=function(){b={}};a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");for(var c=b[a.type]||[],c=c.slice(0),f=0;f<c.length;f+=1)try{c[f](a)}catch(u){e.info("Error triggering event: "+a.type+", error: "+u)}};a.on=a.addEventListener;a.off=a.removeEventListener;a.emit=a.dispatchEvent;return a},g=function(){this.emitter=q()};g.prototype.addEventListener=function(a,b){this.emitter.addEventListener(a,b)};g.prototype.removeEventListener=
function(a,b){this.emitter.removeEventListener(a,b)};g.prototype.dispatchEvent=function(a){this.emitter.dispatchEvent(a)};g.prototype.on=function(a,b){this.addEventListener(a,b)};g.prototype.off=function(a,b){this.removeEventListener(a,b)};g.prototype.emit=function(a){this.dispatchEvent(a)};var a=function(a){var b={};b.type=a.type;return b},b=function(b){var l=a(b);l.stream=b.stream;l.connection=b.connection;l.state=b.state;l.message=b.message;l.wasAbleToConnect=b.wasAbleToConnect;return l},k=function(b){var l=
a(b);l.streams=b.streams;l.message=b.message;return l},p=function(b){var l=a(b);l.stream=b.stream;l.msg=b.msg;l.origin=b.origin;l.bandwidth=b.bandwidth;l.attrs=b.attrs;l.wasAbleToConnect=b.wasAbleToConnect;return l}},function(m,d,h){function e(q){if(q){for(var g in e.prototype)q[g]=e.prototype[g];return q}}m.exports=e;e.prototype.on=e.prototype.addEventListener=function(e,g){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(g);return this};e.prototype.once=
function(e,g){function a(){this.off(e,a);g.apply(this,arguments)}a.fn=g;this.on(e,a);return this};e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(e,g){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var a=this._callbacks["$"+e];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var b,k=0;k<a.length;k++)if(b=a[k],b===g||b.fn===g){a.splice(k,1);break}return this};
e.prototype.emit=function(e){this._callbacks=this._callbacks||{};var g=[].slice.call(arguments,1),a=this._callbacks["$"+e];if(a)for(var a=a.slice(0),b=0,k=a.length;b<k;++b)a[b].apply(this,g);return this};e.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};e.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(m,d,h){function e(c,a,b){if(!a)return d.encodeBase64Packet(c,b);var f=new FileReader;f.onload=function(){d.encodePacket({type:c.type,
data:f.result},a,!0,b)};return f.readAsArrayBuffer(c.data)}function q(c,a,f){var l=Array(c.length);f=b(c.length,f);for(var k=function(c,b,f){a(b,function(a,b){l[c]=b;f(a,l)})},n=0;n<c.length;n++)k(n,c[n],f)}m=h(58);var g=h(21),a=h(59),b=h(60),k=h(61),p;"undefined"!==typeof ArrayBuffer&&(p=h(62));var n="undefined"!==typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!==typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=n||l;d.protocol=3;var c=d.packets={open:0,close:1,ping:2,
pong:3,message:4,upgrade:5,noop:6},r=m(c),u={type:"error",data:"parser error"},y=h(63);d.encodePacket=function(a,b,l,n){"function"===typeof b&&(n=b,b=!1);"function"===typeof l&&(n=l,l=null);var p=void 0===a.data?void 0:a.data.buffer||a.data;if("undefined"!==typeof ArrayBuffer&&p instanceof ArrayBuffer){if(b){l=a.data;b=new Uint8Array(l);l=new Uint8Array(1+l.byteLength);l[0]=c[a.type];for(a=0;a<b.length;a++)l[a+1]=b[a];a=n(l.buffer)}else a=d.encodeBase64Packet(a,n);return a}if("undefined"!==typeof y&&
p instanceof y)return b?f?a=e(a,b,n):(b=new Uint8Array(1),b[0]=c[a.type],a=new y([b.buffer,a.data]),a=n(a)):a=d.encodeBase64Packet(a,n),a;if(p&&p.base64)return n("b"+d.packets[a.type]+a.data.data);b=c[a.type];void 0!==a.data&&(b+=l?k.encode(String(a.data),{strict:!1}):String(a.data));return n(""+b)};d.encodeBase64Packet=function(c,a){var b="b"+d.packets[c.type];if("undefined"!==typeof y&&c.data instanceof y){var f=new FileReader;f.onload=function(){var c=f.result.split(",")[1];a(b+c)};return f.readAsDataURL(c.data)}try{var l=
String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(F){c=new Uint8Array(c.data);l=Array(c.length);for(var n=0;n<c.length;n++)l[n]=c[n];l=String.fromCharCode.apply(null,l)}b+=btoa(l);return a(b)};d.decodePacket=function(c,b,f){if(void 0===c)return u;if("string"===typeof c){if("b"===c.charAt(0))return d.decodeBase64Packet(c.substr(1),b);if(f){a:{b=c;try{b=k.decode(b,{strict:!1})}catch(t){c=!1;break a}c=b}if(!1===c)return u}f=c.charAt(0);return Number(f)==f&&r[f]?1<c.length?{type:r[f],data:c.substring(1)}:
{type:r[f]}:u}f=(new Uint8Array(c))[0];c=a(c,1);y&&"blob"===b&&(c=new y([c]));return{type:r[f],data:c}};d.decodeBase64Packet=function(c,a){var b=r[c.charAt(0)];if(!p)return{type:b,data:{base64:!0,data:c.substr(1)}};c=p.decode(c.substr(1));"blob"===a&&y&&(c=new y([c]));return{type:b,data:c}};d.encodePayload=function(c,a,b){"function"===typeof a&&(b=a,a=null);var l=g(c);if(a&&l)return y&&!f?d.encodePayloadAsBlob(c,b):d.encodePayloadAsArrayBuffer(c,b);if(!c.length)return b("0:");q(c,function(c,b){d.encodePacket(c,
l?a:!1,!1,function(c){b(null,c.length+":"+c)})},function(c,a){return b(a.join(""))})};d.decodePayload=function(c,a,b){if("string"!==typeof c)return d.decodePayloadAsBinary(c,a,b);"function"===typeof a&&(b=a,a=null);if(""===c)return b(u,0,1);var f="";for(var l,n,k=0,p=c.length;k<p;k++)if(n=c.charAt(k),":"!==n)f+=n;else{if(""===f||f!=(l=Number(f)))return b(u,0,1);n=c.substr(k+1,l);if(f!=n.length)return b(u,0,1);if(n.length){f=d.decodePacket(n,a,!1);if(u.type===f.type&&u.data===f.data)return b(u,0,1);
if(!1===b(f,k+l,p))return}k+=l;f=""}if(""!==f)return b(u,0,1)};d.encodePayloadAsArrayBuffer=function(c,a){if(!c.length)return a(new ArrayBuffer(0));q(c,function(c,a){d.encodePacket(c,!0,!0,function(c){return a(null,c)})},function(c,b){c=b.reduce(function(c,a){a="string"===typeof a?a.length:a.byteLength;return c+a.toString().length+a+2},0);var f=new Uint8Array(c),l=0;b.forEach(function(c){var a="string"===typeof c;var b=c;if(a){b=new Uint8Array(c.length);for(var n=0;n<c.length;n++)b[n]=c.charCodeAt(n);
b=b.buffer}a?f[l++]=0:f[l++]=1;c=b.byteLength.toString();for(n=0;n<c.length;n++)f[l++]=parseInt(c[n]);f[l++]=255;b=new Uint8Array(b);for(n=0;n<b.length;n++)f[l++]=b[n]});return a(f.buffer)})};d.encodePayloadAsBlob=function(c,a){q(c,function(c,a){d.encodePacket(c,!0,!0,function(c){var b=new Uint8Array(1);b[0]=1;if("string"===typeof c){for(var f=new Uint8Array(c.length),l=0;l<c.length;l++)f[l]=c.charCodeAt(l);c=f.buffer;b[0]=0}for(var f=(c instanceof ArrayBuffer?c.byteLength:c.size).toString(),n=new Uint8Array(f.length+
1),l=0;l<f.length;l++)n[l]=parseInt(f[l]);n[f.length]=255;y&&(c=new y([b.buffer,n.buffer,c]),a(null,c))})},function(c,b){return a(new y(b))})};d.decodePayloadAsBinary=function(c,b,f){"function"===typeof b&&(f=b,b=null);for(var l=[];0<c.byteLength;){for(var n=new Uint8Array(c),k=0===n[0],p="",e=1;255!==n[e];e++){if(310<p.length)return f(u,0,1);p+=n[e]}c=a(c,2+p.length);p=parseInt(p);n=a(c,0,p);if(k)try{n=String.fromCharCode.apply(null,new Uint8Array(n))}catch(I){for(k=new Uint8Array(n),n="",e=0;e<
k.length;e++)n+=String.fromCharCode(k[e])}l.push(n);c=a(c,p)}var g=l.length;l.forEach(function(c,a){f(d.decodePacket(c,b,!0),a,g)})}},function(m,d,h){(function(e){function q(){try{var a=d.storage.debug}catch(k){}!a&&"undefined"!==typeof e&&"env"in e&&(a=e.env.DEBUG);return a}d=m.exports=h(45);d.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(a){var b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":
" ")+a[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff);if(b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var p=0,n=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(p++,"%c"===a&&(n=p))});a.splice(n,0,b)}};d.save=function(a){try{null==a?d.storage.removeItem("debug"):d.storage.debug=a}catch(k){}};d.load=q;d.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&
document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var g=d;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var a=
chrome.storage.local;else a:{try{a=window.localStorage;break a}catch(b){}a=void 0}g.storage=a;d.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");d.formatters.j=function(a){try{return JSON.stringify(a)}catch(k){return"[UnexpectedJSONParseError]: "+k.message}};d.enable(q())}).call(d,h(12))},function(m,d){d.encode=function(d){var e="",q;for(q in d)d.hasOwnProperty(q)&&(e.length&&(e+="\x26"),e+=encodeURIComponent(q)+"\x3d"+encodeURIComponent(d[q]));return e};d.decode=
function(d){var e={};d=d.split("\x26");for(var q=0,g=d.length;q<g;q++){var a=d[q].split("\x3d");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}},function(m,d){m.exports=function(d,e){var q=function(){};q.prototype=e.prototype;d.prototype=new q;d.prototype.constructor=d}},function(m,d,h){(function(e){function q(){try{var a=d.storage.debug}catch(k){}!a&&"undefined"!==typeof e&&"env"in e&&(a=e.env.DEBUG);return a}d=m.exports=h(64);d.log=function(){return"object"===typeof console&&console.log&&
Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(a){var b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff);if(b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var p=0,n=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(p++,"%c"===a&&(n=p))});a.splice(n,0,b)}};d.save=function(a){try{null==a?d.storage.removeItem("debug"):d.storage.debug=a}catch(k){}};d.load=q;d.useColors=function(){return"undefined"!==
typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&
31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var g=d;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var a=chrome.storage.local;else a:{try{a=window.localStorage;break a}catch(b){}a=void 0}g.storage=a;d.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
d.formatters.j=function(a){try{return JSON.stringify(a)}catch(k){return"[UnexpectedJSONParseError]: "+k.message}};d.enable(q())}).call(d,h(12))},function(m,d,h){var e=h(2);d.a=function(){var q=Object(e.b)({});q.url="";return q}},function(m,d,h){d.a=function(){var e={},q={};e.add=function(e,a){q[e]=a};e.get=function(e){return q[e]};e.has=function(e){return void 0!==q[e]};e.size=function(){return Object.keys(q).length};e.forEach=function(e){for(var a=Object.keys(q),b=0;b<a.length;b+=1){var k=a[b];e(q[k],
k)}};e.keys=function(){return Object.keys(q)};e.remove=function(e){delete q[e]};e.clear=function(){q={}};return e}},function(m,d,h){(function(e){var q=h(0).a.module("ConnectionHelpers"),g=function(){var a="none";"undefined"!==typeof e&&e.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?
a="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari");return a};d.a={GetUserMedia:function(a,b,k){b=void 0===b?function(){}:b;k=void 0===k?function(){}:k;var p,n=function(c,a,b){navigator.mediaDevices.getUserMedia(c).then(a).catch(b)},l=function(c,a,b){navigator.mediaDevices.getDisplayMedia(c).then(a).catch(b)},f=function(){switch(g()){case "electron":q.debug("message: Screen sharing in Electron");p={};p.video=a.video||{};p.video.mandatory=a.video.mandatory||{};p.video.mandatory.chromeMediaSource=
"desktop";p.video.mandatory.chromeMediaSourceId=a.desktopStreamId;n(p,b,k);break;case "mozilla":q.debug("message: Screen sharing in Firefox");p={};void 0!==a.video?(p.video=a.video,p.video.mediaSource||(p.video.mediaSource="window")):p={audio:a.audio,video:{mediaSource:"window"}};n(p,b,k);break;case "chrome-stable":q.debug("message: Screen sharing in Chrome");p={};if(a.desktopStreamId)p.video=a.video||{mandatory:{}},p.video.mandatory=p.video.mandatory||{},p.video.mandatory.chromeMediaSource="desktop",
p.video.mandatory.chromeMediaSourceId=a.desktopStreamId,n(p,b,k);else{var c="okeephmleflklcdebijnponpabbmmgeo";a.extensionId&&(q.debug("message: extensionId supplied, extensionId: "+a.extensionId),c=a.extensionId);q.debug("message: Screen access on chrome stable looking for extension");try{chrome.runtime.sendMessage(c,{getStream:!0},function(c){void 0===c?(q.error("message: Access to screen denied"),k({code:"Access to screen denied"})):(c=c.streamId,void 0!==a.video.mandatory?(p.video=a.video||{mandatory:{}},
p.video.mandatory.chromeMediaSource="desktop",p.video.mandatory.chromeMediaSourceId=c):p={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}}},n(p,b,k))})}catch(r){q.debug("message: Screensharing plugin is not accessible"),k({code:"no_plugin_present"})}}break;default:q.error("message: This browser does not support ScreenSharing")}};a.screen?a.desktopStreamId||a.extensionId?(q.debug("message: Screen access requested using GetUserMedia"),f()):(q.debug("message: Screen access requested using GetDisplayMedia"),
l(a,b,k)):"undefined"!==typeof e&&e.exports?q.error("message: Video/audio streams not supported in erizofc yet"):(q.debug("message: Calling getUserMedia, config: "+JSON.stringify(a)),n(a,b,k))},getBrowser:g}}).call(d,h(41)(m))},function(m,d){function h(){throw Error("setTimeout has not been defined");}function e(){throw Error("clearTimeout has not been defined");}function q(c){if(n===setTimeout)return setTimeout(c,0);if((n===h||!n)&&setTimeout)return n=setTimeout,setTimeout(c,0);try{return n(c,0)}catch(A){try{return n.call(null,
c,0)}catch(B){return n.call(this,c,0)}}}function g(c){if(l===clearTimeout)return clearTimeout(c);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(c);try{return l(c)}catch(A){try{return l.call(null,c)}catch(B){return l.call(this,c)}}}function a(){c&&r&&(c=!1,r.length?f=r.concat(f):u=-1,f.length&&b())}function b(){if(!c){var b=q(a);c=!0;for(var l=f.length;l;){r=f;for(f=[];++u<l;)r&&r[u].run();u=-1;l=f.length}r=null;c=!1;g(b)}}function k(c,a){this.fun=c;this.array=a}function p(){}m=m.exports=
{};try{var n="function"===typeof setTimeout?setTimeout:h}catch(y){n=h}try{var l="function"===typeof clearTimeout?clearTimeout:e}catch(y){l=e}var f=[],c=!1,r,u=-1;m.nextTick=function(a){var l=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)l[n-1]=arguments[n];f.push(new k(a,l));1!==f.length||c||q(b)};k.prototype.run=function(){this.fun.apply(null,this.array)};m.title="browser";m.browser=!0;m.env={};m.argv=[];m.version="";m.versions={};m.on=p;m.addListener=p;m.once=
p;m.off=p;m.removeListener=p;m.removeAllListeners=p;m.emit=p;m.prependListener=p;m.prependOnceListener=p;m.listeners=function(c){return[]};m.binding=function(c){throw Error("process.binding is not supported");};m.cwd=function(){return"/"};m.chdir=function(c){throw Error("process.chdir is not supported");};m.umask=function(){return 0}},function(m,d){function h(a){a=String(a);if(!(100<a.length)&&(a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a))){var b=
parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return b*g;case "days":case "day":case "d":return b*q;case "hours":case "hour":case "hrs":case "hr":case "h":return 36E5*b;case "minutes":case "minute":case "mins":case "min":case "m":return 6E4*b;case "seconds":case "second":case "secs":case "sec":case "s":return 1E3*b;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return b}}}function e(a,b,k){if(!(a<b))return a<1.5*
b?Math.floor(a/b)+" "+k:Math.ceil(a/b)+" "+k+"s"}var q=864E5,g=365.25*q;m.exports=function(a,b){b=b||{};var k=typeof a;if("string"===k&&0<a.length)return h(a);if("number"===k&&!1===isNaN(a))return b.long?e(a,q,"day")||e(a,36E5,"hour")||e(a,6E4,"minute")||e(a,1E3,"second")||a+" ms":a>=q?Math.round(a/q)+"d":36E5<=a?Math.round(a/36E5)+"h":6E4<=a?Math.round(a/6E4)+"m":1E3<=a?Math.round(a/1E3)+"s":a+"ms";throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(a));}},function(m,
d,h){function e(){}function q(c){var a=""+c.type;if(d.BINARY_EVENT===c.type||d.BINARY_ACK===c.type)a+=c.attachments+"-";c.nsp&&"/"!==c.nsp&&(a+=c.nsp+",");null!=c.id&&(a+=c.id);null!=c.data&&(a+=JSON.stringify(c.data));k("encoded %j as %s",c,a);return a}function g(c,a){n.removeBlobs(c,function(c){var b=n.deconstructPacket(c);c=q(b.packet);b=b.buffers;b.unshift(c);a(b)})}function a(){this.reconstructor=null}function b(c){this.reconPack=c;this.buffers=[]}var k=h(46)("socket.io-parser");m=h(3);var p=
h(21),n=h(53),l=h(22),f=h(23);d.protocol=4;d.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");d.CONNECT=0;d.DISCONNECT=1;d.EVENT=2;d.ACK=3;d.ERROR=4;d.BINARY_EVENT=5;d.BINARY_ACK=6;d.Encoder=e;d.Decoder=a;e.prototype.encode=function(c,a){c.type!==d.EVENT&&c.type!==d.ACK||!p(c.data)||(c.type=c.type===d.EVENT?d.BINARY_EVENT:d.BINARY_ACK);k("encoding packet %j",c);d.BINARY_EVENT===c.type||d.BINARY_ACK===c.type?g(c,a):(c=q(c),a([c]))};m(a.prototype);a.prototype.add=function(c){if("string"===
typeof c){a:{var a,n=0,p={type:Number(c.charAt(0))};if(null==d.types[p.type])c={type:d.ERROR,data:"parser error: unknown packet type "+p.type};else{if(d.BINARY_EVENT===p.type||d.BINARY_ACK===p.type){for(a="";"-"!==c.charAt(++n)&&(a+=c.charAt(n),n!=c.length););if(a!=Number(a)||"-"!==c.charAt(n))throw Error("Illegal attachments");p.attachments=Number(a)}if("/"===c.charAt(n+1))for(p.nsp="";++n;){a=c.charAt(n);if(","===a)break;p.nsp+=a;if(n===c.length)break}else p.nsp="/";a=c.charAt(n+1);if(""!==a&&Number(a)==
a){for(p.id="";++n;){a=c.charAt(n);if(null==a||Number(a)!=a){--n;break}p.id+=c.charAt(n);if(n===c.length)break}p.id=Number(p.id)}if(c.charAt(++n)){n=c.substr(n);try{var e=JSON.parse(n)}catch(B){e=!1}if(!1===e||p.type!==d.ERROR&&!l(e)){c={type:d.ERROR,data:"parser error: invalid payload"};break a}else p.data=e}k("decoded %s as %j",c,p);c=p}}d.BINARY_EVENT===c.type||d.BINARY_ACK===c.type?(this.reconstructor=new b(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",
c)}else if(f(c)||c.base64)if(this.reconstructor){if(c=this.reconstructor.takeBinaryData(c))this.reconstructor=null,this.emit("decoded",c)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+c);};a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};b.prototype.takeBinaryData=function(c){this.buffers.push(c);return this.buffers.length===this.reconPack.attachments?(c=n.reconstructPacket(this.reconPack,this.buffers),
this.finishedReconstruction(),c):null};b.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(m,d,h){(function(e){var q=h(56);m.exports=function(g){var a=g.xdomain,b=g.xscheme;g=g.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!a||q))return new XMLHttpRequest}catch(k){}try{if("undefined"!==typeof XDomainRequest&&!b&&g)return new XDomainRequest}catch(k){}if(!a)try{return new (e[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(k){}}}).call(d,
h(1))},function(m,d,h){function e(e){this.path=e.path;this.hostname=e.hostname;this.port=e.port;this.secure=e.secure;this.query=e.query;this.timestampParam=e.timestampParam;this.timestampRequests=e.timestampRequests;this.readyState="";this.agent=e.agent||!1;this.socket=e.socket;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.forceNode=e.forceNode;this.extraHeaders=
e.extraHeaders;this.localAddress=e.localAddress}var q=h(4);d=h(3);m.exports=e;d(e.prototype);e.prototype.onError=function(e,a){e=Error(e);e.type="TransportError";e.description=a;this.emit("error",e);return this};e.prototype.open=function(){if("closed"===this.readyState||""===this.readyState)this.readyState="opening",this.doOpen();return this};e.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState)this.doClose(),this.onClose();return this};e.prototype.send=function(e){if("open"===
this.readyState)this.write(e);else throw Error("Transport not open");};e.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};e.prototype.onData=function(e){e=q.decodePacket(e,this.socket.binaryType);this.onPacket(e)};e.prototype.onPacket=function(e){this.emit("packet",e)};e.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(m,d,h){var e=h(18),q=h(38),g=h(39),a=h(40);m=h(0);var b=h(2),k=h(10),p=h(11),n=b.c,l=103,f=["high-packet-losses",
"low-packet-losses","good"],c=m.a.module("ErizoConnection"),r=function(f,r){var d=n.call(this)||this;d.stack={};d.erizoId=r;d.streamsMap=Object(k.a)();l+=1;f.sessionId=l;d.sessionId=l;d.connectionId=f.connectionId;d.disableIceRestart=f.disableIceRestart;d.qualityLevel="good";d.wasAbleToConnect=!1;c.debug("message: Building a new Connection, "+d.toLog());f.onEnqueueingTimeout=function(c){d.emit(Object(b.a)({type:"connection-failed",connection:d,message:"reason: Timeout in "+c}))};f.streamRemovedListener||
(f.streamRemovedListener=function(){});d.streamRemovedListener=f.streamRemovedListener;d.browser=p.a.getBrowser();if("fake"===d.browser)c.warning("message: Publish/subscribe video/audio streams not supported in erizofc yet, "+d.toLog()),d.stack=Object(a.a)(f);else if("mozilla"===d.browser)c.debug("message: Firefox Stack, "+d.toLog()),d.stack=Object(g.a)(f);else if("safari"===d.browser)c.debug("message: Safari Stack, "+d.toLog()),d.stack=Object(q.a)(f);else if("chrome-stable"===d.browser||"electron"===
d.browser)c.debug("message: Chrome Stable Stack, "+d.toLog()),d.stack=Object(e.a)(f);else throw c.error("message: No stack available for this browser, "+d.toLog()),Error("WebRTC stack not available");d.stack.updateSpec||(d.stack.updateSpec=function(a,b){b=void 0===b?function(){}:b;c.error("message: Update Configuration not implemented in this browser, "+d.toLog());b("unimplemented")});d.stack.setSignallingCallback||(d.stack.setSignallingCallback=function(){c.error("message: setSignallingCallback is not implemented in this stack, "+
d.toLog())});d.stack.peerConnection&&(d.peerConnection=d.stack.peerConnection,d.stack.peerConnection.onaddstream=function(c){d.emit(Object(b.a)({type:"add-stream",stream:c.stream}))},d.stack.peerConnection.onremovestream=function(c){d.emit(Object(b.a)({type:"remove-stream",stream:c.stream}));d.streamRemovedListener(c.stream.id)},d.stack.peerConnection.oniceconnectionstatechange=function(){var a=d.stack.peerConnection.iceConnectionState;-1!==["completed","connected"].indexOf(a)&&(d.wasAbleToConnect=
!0);"failed"===a&&d.wasAbleToConnect&&!d.disableIceRestart?(c.warning("message: Restarting ICE, "+d.toLog()),d.stack.restartIce()):d.emit(Object(b.a)({type:"ice-state-change",state:a,wasAbleToConnect:d.wasAbleToConnect}))});return d};$jscomp.inherits(r,n);r.prototype.toLog=function(){return"connectionId: "+this.connectionId+", sessionId: "+this.sessionId+", qualityLevel: "+this.qualityLevel+", erizoId: "+this.erizoId};r.prototype.close=function(){c.debug("message: Closing ErizoConnection, "+this.toLog());
this.streamsMap.clear();this.stack.close()};r.prototype.addStream=function(a){c.debug("message: Adding stream to Connection, "+this.toLog()+", "+a.toLog());this.streamsMap.add(a.getID(),a);a.local&&this.stack.addStream(a.stream)};r.prototype.removeStream=function(a){var b=a.getID();this.streamsMap.has(b)?(this.streamsMap.remove(b),a.local?this.stack.removeStream(a.stream):0===this.streamsMap.size()&&this.streamRemovedListener(a.getLabel())):c.debug("message: Cannot remove stream not in map, "+this.toLog()+
", "+a.toLog())};r.prototype.processSignalingMessage=function(c){this.stack.processSignalingMessage(c)};r.prototype.sendSignalingMessage=function(c){this.stack.sendSignalingMessage(c)};r.prototype.setSimulcast=function(c){this.stack.setSimulcast(c)};r.prototype.setVideo=function(c){this.stack.setVideo(c)};r.prototype.setAudio=function(c){this.stack.setAudio(c)};r.prototype.updateSpec=function(c,a,b){this.stack.updateSpec(c,a,b)};r.prototype.updateSimulcastLayersBitrate=function(c){this.stack.updateSimulcastLayersBitrate(c)};
r.prototype.updateSimulcastActiveLayers=function(c){this.stack.updateSimulcastActiveLayers(c)};r.prototype.setQualityLevel=function(c){this.qualityLevel=f[c]};r.prototype.getQualityLevel=function(){return{message:this.qualityLevel,index:f.indexOf(this.qualityLevel)}};h=function(){this.ErizoConnectionsMap=new Map};h.prototype.getErizoConnection=function(c){var a;this.ErizoConnectionsMap.forEach(function(b){Object.keys(b).forEach(function(f){b[f].connectionId===c&&(a=b[f])})});return a};h.prototype.getOrBuildErizoConnection=
function(a,b,f){f=void 0===f?!1:f;c.debug("message: getOrBuildErizoConnection, erizoId: "+b+", singlePC: "+f);var l=a.isRemote?"subscribe":"publish";if(void 0===b)return new r(a);f?(this.ErizoConnectionsMap.has(b)?f=this.ErizoConnectionsMap.get(b):(f={},this.ErizoConnectionsMap.set(b,f)),f["single-pc-"+l]||(f["single-pc-"+l]=new r(a,b)),l=f["single-pc-"+l]):(l=new r(a,b),this.ErizoConnectionsMap.has(b)?this.ErizoConnectionsMap.get(b)[l.sessionId]=l:(f={},f[l.sessionId]=l,this.ErizoConnectionsMap.set(b,
f)));a.simulcast&&l.setSimulcast(a.simulcast);a.video&&l.setVideo(a.video);a.audio&&l.setVideo(a.audio);return l};h.prototype.maybeCloseConnection=function(a,b){b=void 0===b?!1:b;c.debug("message: Trying to remove connection, "+a.toLog());if(0===a.streamsMap.size()||b){c.debug("message: No streams in connection, "+a.toLog());var f=this.ErizoConnectionsMap.get(a.erizoId);void 0===f||!f["single-pc-publish"]&&!f["single-pc-subscribe"]||b?(a.close(),void 0!==f&&(delete f["single-pc-subscribe"],delete f["single-pc-publish"],
delete f[a.sessionId])):c.debug("message: Will not remove empty connection, "+a.toLog()+", reason: It is singlePC")}};d.a=h},function(m,d,h){var e=h(19),q=h(37),g=h(0).a.module("ChromeStableStack");d.a=function(a){g.debug("message: Starting Chrome stable stack, spec: "+JSON.stringify(a));var b=Object(e.a)(a);b.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0};b.enableSimulcast=function(a){var n=a;if(!b.simulcast||null!==n.match(/a=ssrc-group:SIM/g))return n;a=n.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);
if(!a||0>=a.length)return n;var l=b.simulcast.numSpatialLayers||2;var f=parseInt(a[1],10),c=parseInt(a[2],10),e=n.match(new RegExp("a\x3dssrc:"+a[1]+" cname:(.*)\r?\n"))[1],k=n.match(new RegExp("a\x3dssrc:"+a[1]+" msid:(.*)\r?\n"))[1],p=n.match(new RegExp("a\x3dssrc:"+a[1]+" mslabel:(.*)\r?\n"))[1],g=n.match(new RegExp("a\x3dssrc:"+a[1]+" label:(.*)\r?\n"))[1];n.match(new RegExp("a\x3dssrc:"+a[1]+".*\r?\n","g")).forEach(function(c){n=n.replace(c,"")});n.match(new RegExp("a\x3dssrc:"+a[2]+".*\r?\n",
"g")).forEach(function(c){n=n.replace(c,"")});for(var d=[f],h=[c],t=1;t<l;t+=1)d.push(f+1E3*t),h.push(c+1E3*t);l=q.a.addSim(d);for(t=0;t<d.length;t+=1)f=d[t],c=h[t],l+=q.a.addGroup(f,c);for(t=0;t<d.length;t+=1)f=d[t],c=h[t],l+=q.a.addSpatialLayer(e,k,p,g,f,c);return n.replace(a[0],l+"a\x3dx-google-flag:conference\r\n")};var k=function(a){if("function"!==typeof a.getParameters||"function"!==typeof a.setParameters)g.warning("message: Cannot set simulcast layers bitrate, reason: get/setParameters not available");
else{var n=a.getParameters();Object.keys(b.simulcast.spatialLayerConfigs).forEach(function(a){if(void 0!==n.encodings[a]){g.debug("message: Configure parameters for layer, layer: "+a+", config: "+b.simulcast.spatialLayerConfigs[a]);var f=b.simulcast.spatialLayerConfigs;if(void 0!==n.encodings[a]&&void 0!==f[a]){var c=n;c.encodings[a].maxBitrate=f[a].maxBitrate;void 0!==f[a].active&&(c.encodings[a].active=f[a].active);n=c}}});a.setParameters(n).then(function(a){g.debug("message: Success setting simulcast layer configs, result: "+
a)}).catch(function(a){g.warning("message: Error setting simulcast layer configs, error: "+a)})}};b.prepareCreateOffer=function(){return Promise.resolve()};b.setSimulcastLayersConfig=function(){g.debug("message: Maybe set simulcast Layers config, simulcast: "+JSON.stringify(b.simulcast));b.simulcast&&b.simulcast.spatialLayerConfigs&&b.peerConnection.getSenders().forEach(function(a){"video"===a.track.kind&&k(a)})};b.setStartVideoBW=function(e){b.video&&a.startVideoBW&&(g.debug("message: startVideoBW, requested: "+
a.startVideoBW),q.a.setParamForCodecs(e,"video","x-google-start-bitrate",a.startVideoBW))};b.setHardMinVideoBW=function(e){b.video&&a.hardMinVideoBW&&(g.debug("message: hardMinVideoBW, requested: "+a.hardMinVideoBW),q.a.setParamForCodecs(e,"video","x-google-min-bitrate",a.hardMinVideoBW))};return b}},function(m,d,h){var e=h(0).a.module("BaseStack");d.a=function(d){var g={},a=[],b=function(b){for(var l=[],f=0;f<arguments.length;++f)l[f-0]=arguments[f];a.push([].concat(["Negotiation:"],$jscomp.arrayFromIterable(l)).reduce(function(c,
a){return c+" "+a}))};g.getNegotiationLogs=function(){return a.reduce(function(a,b){return a+"'\n'"+b})};e.debug("message: Starting Base stack, spec: "+JSON.stringify(d));g.pcConfig={iceServers:[],sdpSemantics:"unified-plan"};g.con={};void 0!==d.iceServers&&(g.pcConfig.iceServers=d.iceServers);!0===d.forceTurn&&(g.pcConfig.iceTransportPolicy="relay");g.pcConfig.bundlePolicy="max-bundle";g.audio=d.audio;g.video=d.video;void 0===g.audio&&(g.audio=!0);void 0===g.video&&(g.video=!0);g.peerConnection=
new RTCPeerConnection(g.pcConfig,g.con);g.peerConnection.onnegotiationneeded=function(){return $jscomp.executeAsyncGenerator(function(){function a(a,n){for(;;)switch(l){case 0:if(!d.managed){l=1;break}l=-1;return{value:void 0,done:!0};case 1:try{return l=4,{value:g.peerConnection.setLocalDescription(),done:!1}}catch(A){c=A;l=2;break}case 4:try{if(void 0===n){l=5;break}l=-1;throw n;}catch(A){c=A;l=2;break}case 5:try{d.callback({type:g.peerConnection.localDescription.type,sdp:g.peerConnection.localDescription.sdp,
config:{maxVideoBW:d.maxVideoBW}});l=3;break}catch(A){c=A;l=2;break}case 2:f=c,b("onnegotiationneeded - error",f.message);case 3:l=-1;default:return{value:void 0,done:!0}}}var l=0,f,c,e={next:function(c){return a(c,void 0)},throw:function(c){return a(void 0,c)},return:function(c){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e}())};g.peerConnection.onicecandidate=function(a){(a=a.candidate)?(a={sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid,
candidate:a.candidate},a.candidate.match(/a=/)||(a.candidate="a\x3d"+a.candidate)):(e.debug("message: Gathered all candidates and sending END candidate"),a={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});d.callback({type:"candidate",candidate:a})};g.setStartVideoBW=function(a){e.error("message: startVideoBW not implemented for this browser");return a};g.setHardMinVideoBW=function(a){e.error("message: hardMinVideoBw not implemented for this browser");return a};g.enableSimulcast=function(a){e.error("message: Simulcast not implemented");
return a};var k=function(a,b,f){f=void 0===f?function(){return!0}:f;g.simulcast&&(Object.keys(b).forEach(function(c){var l=b[c];g.simulcast.spatialLayerConfigs||(g.simulcast.spatialLayerConfigs={});g.simulcast.spatialLayerConfigs[c]||(g.simulcast.spatialLayerConfigs[c]={});f(l)&&(g.simulcast.spatialLayerConfigs[c][a]=l)}),g.setSimulcastLayersConfig())};g.updateSimulcastLayersBitrate=function(a){k("maxBitrate",a)};g.updateSimulcastActiveLayers=function(a){k("active",a,function(a){return!0===a||!1===
a})};g.setSimulcastLayersConfig=function(){e.error("message: Simulcast not implemented")};g.setSimulcast=function(a){g.simulcast=a};g.setVideo=function(a){g.video=a};g.setAudio=function(a){g.audio=a};g.updateSpec=function(a,b,f){f=void 0===f?function(){}:f;var c=d.p2p&&a.maxVideoBW,l=!d.p2p&&a.maxVideoBW;a.maxVideoBW&&(e.debug("message: Maxvideo Requested, value: "+a.maxVideoBW+", limit: "+d.limitMaxVideoBW),a.maxVideoBW>d.limitMaxVideoBW&&(a.maxVideoBW=d.limitMaxVideoBW),d.maxVideoBW=a.maxVideoBW,
e.debug("message: Maxvideo Result, value: "+a.maxVideoBW+", limit: "+d.limitMaxVideoBW));a.maxAudioBW&&(a.maxAudioBW>d.limitMaxAudioBW&&(a.maxAudioBW=d.limitMaxAudioBW),d.maxAudioBW=a.maxAudioBW);(c||a.maxAudioBW)&&g.enqueuedCalls.negotiationQueue.negotiateMaxBW(a,f);if(l||a.minVideoBW||void 0!==a.slideShowMode||void 0!==a.muteStream||void 0!==a.qualityLayer||void 0!==a.slideShowBelowLayer||void 0!==a.video||void 0!==a.priorityLevel)e.debug("message: Configuration changed, maxVideoBW: "+a.maxVideoBW+
(", minVideoBW: "+a.minVideoBW+", slideShowMode: "+a.slideShowMode)+(", muteStream: "+JSON.stringify(a.muteStream)+", videoConstraints: "+JSON.stringify(a.video))+(", slideShowBelowMinLayer: "+a.slideShowBelowLayer)+(", priority: "+a.priorityLevel)),d.callback({type:"updatestream",config:a},b)};var p=[{rid:"3"},{rid:"2",scaleResolutionDownBy:2},{rid:"1",scaleResolutionDownBy:4}];g.addStream=function(a){a.transceivers=[];a.getTracks().forEach(function(b){return $jscomp.executeAsyncGenerator(function(){function f(f,
n){for(;;)switch(c){case 0:e={};if("video"===b.kind&&g.simulcast){f=g.simulcast.numSpatialLayers||3;n=p.length;f=f<n?f:n;for(var k=[],t=n-1;t>=n-f;--t)k.push(p[t]);e={sendEncodings:k}}e.streams=[a];l=g.peerConnection.addTransceiver(b,e);a.transceivers.push(l);c=-1;default:return{value:void 0,done:!0}}}var c=0,l,e,n={next:function(a){return f(a,void 0)},throw:function(a){return f(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();n[Symbol.iterator]=function(){return this};
return n}())})};g.removeStream=function(a){a.transceivers.forEach(function(a){e.error("Stopping transceiver",a);"0"===a.mid?g.peerConnection.removeTrack(a.sender):a.stop()})};g.close=function(){g.peerConnection.close()};g.setLocalDescription=function(){return $jscomp.executeAsyncGenerator(function(){function a(a,f){for(;;)switch(b){case 0:return b=-1,{value:g.peerConnection.setLocalDescription(),done:!0};default:return{value:void 0,done:!0}}}var b=0,f={next:function(c){return a(c,void 0)},throw:function(c){return a(void 0,
c)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f}())};g.getLocalDescription=function(){return $jscomp.executeAsyncGenerator(function(){function a(a,f){for(;;)switch(b){case 0:return b=-1,{value:g.peerConnection.localDescription.sdp,done:!0};default:return{value:void 0,done:!0}}}var b=0,f={next:function(c){return a(c,void 0)},throw:function(c){return a(void 0,c)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();f[Symbol.iterator]=function(){return this};return f}())};g.setRemoteDescription=function(a){return $jscomp.executeAsyncGenerator(function(){function b(c,b){for(;;)switch(f){case 0:return f=1,{value:g.peerConnection.setRemoteDescription(a),done:!1};case 1:if(void 0===b){f=2;break}f=-1;throw b;case 2:f=-1;default:return{value:void 0,done:!0}}}var f=0,c={next:function(a){return b(a,void 0)},throw:function(a){return b(void 0,a)},return:function(a){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c}())};g.processSignalingMessage=function(a){return $jscomp.executeAsyncGenerator(function(){function l(l,t){for(;;)switch(f){case 0:q=a;b("processSignalingMessage, type: ",a.type);if("candidate"!==a.type){f=1;break}p="object"===typeof q.candidate?q.candidate:JSON.parse(q.candidate);if("end"!==p.candidate){f=3;break}f=-1;return{value:void 0,done:!0};case 3:p.candidate=p.candidate.replace(/a=/g,"");p.sdpMLineIndex=parseInt(p.sdpMLineIndex,
10);n=new RTCIceCandidate(p);g.peerConnection.addIceCandidate(n);f=2;break;case 1:if("error"!==a.type){f=4;break}e.error("message: Received error signaling message, state: "+a.previousType);f=5;break;case 4:if(-1===["offer","answer"].indexOf(a.type)){f=6;break}try{return f=9,{value:g.peerConnection.setRemoteDescription(q),done:!1}}catch(x){k=x;f=7;break}case 9:try{if(void 0===t){f=10;break}f=-1;throw t;}catch(x){k=x;f=7;break}case 10:try{if("offer"!==q.type){f=11;break}f=12;return{value:g.peerConnection.setLocalDescription(),
done:!1}}catch(x){k=x;f=7;break}case 12:try{if(void 0===t){f=13;break}f=-1;throw t;}catch(x){k=x;f=7;break}case 13:try{d.callback({type:g.peerConnection.localDescription.type,sdp:g.peerConnection.localDescription.sdp,config:{maxVideoBW:d.maxVideoBW}})}catch(x){k=x;f=7;break}case 11:try{f=8;break}catch(x){k=x;f=7;break}case 7:c=k,e.error("message: Error during negotiation, message: ",c.message),"offer"===q.type&&d.callback({type:"offer-error",sdp:g.peerConnection.localDescription.sdp,config:{maxVideoBW:d.maxVideoBW}});
case 8:case 6:case 5:case 2:f=-1;default:return{value:void 0,done:!0}}}var f=0,c,k,n,p,q,h={next:function(a){return l(a,void 0)},throw:function(a){return l(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h}())};g.restartIce=function(){g.peerConnection.restartIce();g.peerConnection.onnegotiationneeded()};return g}},function(m,d){var h=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
e="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");m.exports=function(d){var g=d,a=d.indexOf("["),b=d.indexOf("]");-1!=a&&-1!=b&&(d=d.substring(0,a)+d.substring(a,b).replace(/:/g,";")+d.substring(b,d.length));d=h.exec(d||"");for(var k={},p=14;p--;)k[e[p]]=d[p]||"";-1!=a&&-1!=b&&(k.source=g,k.host=k.host.substring(1,k.host.length-1).replace(/;/g,":"),k.authority=k.authority.replace("[","").replace("]","").replace(/;/g,":"),k.ipv6uri=
!0);return k}},function(m,d,h){(function(e){function d(a){if(!a||"object"!==typeof a)return!1;if(g(a)){for(var n=0,l=a.length;n<l;n++)if(d(a[n]))return!0;return!1}if("function"===typeof e&&e.isBuffer&&e.isBuffer(a)||"function"===typeof ArrayBuffer&&a instanceof ArrayBuffer||b&&a instanceof Blob||k&&a instanceof File)return!0;if(a.toJSON&&"function"===typeof a.toJSON&&1===arguments.length)return d(a.toJSON(),!0);for(n in a)if(Object.prototype.hasOwnProperty.call(a,n)&&d(a[n]))return!0;return!1}var g=
h(52),a=Object.prototype.toString,b="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===a.call(Blob),k="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===a.call(File);m.exports=d}).call(d,h(48).Buffer)},function(m,d){var h={}.toString;m.exports=Array.isArray||function(e){return"[object Array]"==h.call(e)}},function(m,d,h){(function(e){m.exports=function(d){return e.Buffer&&e.Buffer.isBuffer(d)||e.ArrayBuffer&&(d instanceof ArrayBuffer||
ArrayBuffer.isView(d))}}).call(d,h(1))},function(m,d,h){function e(c,b){if(!(this instanceof e))return new e(c,b);c&&"object"===typeof c&&(b=c,c=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new l({min:this.reconnectionDelay(),
max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=c;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];c=b.parser||a;this.encoder=new c.Encoder;this.decoder=new c.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}var q=h(54),g=h(29);d=h(3);var a=h(14),b=h(30),k=h(31),p=h(5)("socket.io-client:manager"),n=h(28),l=h(69),f=Object.prototype.hasOwnProperty;m.exports=e;e.prototype.emitAll=
function(){this.emit.apply(this,arguments);for(var a in this.nsps)f.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};e.prototype.updateSocketIds=function(){for(var a in this.nsps)f.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};e.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};d(e.prototype);e.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};e.prototype.reconnectionAttempts=
function(a){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=a;return this};e.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;this.backoff&&this.backoff.setMin(a);return this};e.prototype.randomizationFactor=function(a){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=a;this.backoff&&this.backoff.setJitter(a);return this};e.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;
this._reconnectionDelayMax=a;this.backoff&&this.backoff.setMax(a);return this};e.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};e.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};e.prototype.open=e.prototype.connect=function(a,f){p("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;p("opening %s",this.uri);var c=this.engine=q(this.uri,this.opts),
l=this;this.readyState="opening";this.skipReconnect=!1;var e=b(c,"open",function(){l.onopen();a&&a()});f=b(c,"error",function(c){p("connect_error");l.cleanup();l.readyState="closed";l.emitAll("connect_error",c);if(a){var b=Error("Connection error");b.data=c;a(b)}else l.maybeReconnectOnOpen()});if(!1!==this._timeout){var k=this._timeout;p("connect attempt will timeout after %d",k);var n=setTimeout(function(){p("connect attempt timed out after %d",k);e.destroy();c.close();c.emit("error","timeout");
l.emitAll("connect_timeout",k)},k);this.subs.push({destroy:function(){clearTimeout(n)}})}this.subs.push(e);this.subs.push(f);return this};e.prototype.onopen=function(){p("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(b(a,"data",k(this,"ondata")));this.subs.push(b(a,"ping",k(this,"onping")));this.subs.push(b(a,"pong",k(this,"onpong")));this.subs.push(b(a,"error",k(this,"onerror")));this.subs.push(b(a,"close",k(this,"onclose")));this.subs.push(b(this.decoder,
"decoded",k(this,"ondecoded")))};e.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};e.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};e.prototype.ondata=function(a){this.decoder.add(a)};e.prototype.ondecoded=function(a){this.emit("packet",a)};e.prototype.onerror=function(a){p("error",a);this.emitAll("error",a)};e.prototype.socket=function(a,b){function c(){~n(l.connecting,f)||l.connecting.push(f)}var f=this.nsps[a];if(!f){f=new g(this,a,b);this.nsps[a]=
f;var l=this;f.on("connecting",c);f.on("connect",function(){f.id=l.generateId(a)});this.autoConnect&&c()}return f};e.prototype.destroy=function(a){a=n(this.connecting,a);~a&&this.connecting.splice(a,1);this.connecting.length||this.close()};e.prototype.packet=function(a){p("writing packet %j",a);var c=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);c.encoding?c.packetBuffer.push(a):(c.encoding=!0,this.encoder.encode(a,function(b){for(var f=0;f<b.length;f++)c.engine.write(b[f],a.options);c.encoding=
!1;c.processPacketQueue()}))};e.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};e.prototype.cleanup=function(){p("cleanup");for(var a=this.subs.length,b=0;b<a;b++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};e.prototype.close=e.prototype.disconnect=function(){p("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();
this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};e.prototype.onclose=function(a){p("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};e.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=
!1;else{var b=this.backoff.duration();p("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var f=setTimeout(function(){a.skipReconnect||(p("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(c){c?(p("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",c.data)):(p("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(f)}})}};
e.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},function(m,d,h){(function(e){var q=h(15),g=h(57),a=h(65),b=h(66);d.polling=function(b){var k=!1,n=!1,l=!1!==b.jsonp;e.location&&(n="https:"===location.protocol,(k=location.port)||(k=n?443:80),k=b.hostname!==location.hostname||k!==b.port,n=b.secure!==n);b.xdomain=k;b.xscheme=n;if("open"in new q(b)&&!b.forceJSONP)return new g(b);if(!l)throw Error("JSONP disabled");
return new a(b)};d.websocket=b}).call(d,h(1))},function(m,d,h){function e(a){var b=a&&a.forceBase64;if(!p||b)this.supportsBinary=!1;q.call(this,a)}var q=h(16),g=h(6),a=h(4);d=h(7);var b=h(27),k=h(8)("engine.io-client:polling");m.exports=e;var p=null!=(new (h(15))({xdomain:!1})).responseType;d(e,q);e.prototype.name="polling";e.prototype.doOpen=function(){this.poll()};e.prototype.pause=function(a){function b(){k("paused");f.readyState="paused";a()}var f=this;this.readyState="pausing";if(this.polling||
!this.writable){var c=0;this.polling&&(k("we are currently polling - waiting to pause"),c++,this.once("pollComplete",function(){k("pre-pause polling complete");--c||b()}));this.writable||(k("we are currently writing - waiting to pause"),c++,this.once("drain",function(){k("pre-pause writing complete");--c||b()}))}else b()};e.prototype.poll=function(){k("polling");this.polling=!0;this.doPoll();this.emit("poll")};e.prototype.onData=function(b){var l=this;k("polling got data %s",b);a.decodePayload(b,
this.socket.binaryType,function(a,c,b){if("opening"===l.readyState)l.onOpen();if("close"===a.type)return l.onClose(),!1;l.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():k('ignoring poll - transport state "%s"',this.readyState))};e.prototype.doClose=function(){function a(){k("writing close packet");b.write([{type:"close"}])}var b=this;"open"===this.readyState?(k("transport open - closing"),a()):(k("transport not open - deferring close"),
this.once("open",a))};e.prototype.write=function(b){var l=this;this.writable=!1;var f=function(){l.writable=!0;l.emit("drain")};a.encodePayload(b,this.supportsBinary,function(a){l.doWrite(a,f)})};e.prototype.uri=function(){var a=this.query||{},l=this.secure?"https":"http",f="";!1!==this.timestampRequests&&(a[this.timestampParam]=b());this.supportsBinary||a.sid||(a.b64=1);a=g.encode(a);this.port&&("https"===l&&443!==Number(this.port)||"http"===l&&80!==Number(this.port))&&(f=":"+this.port);a.length&&
(a="?"+a);var c=-1!==this.hostname.indexOf(":");return l+"://"+(c?"["+this.hostname+"]":this.hostname)+f+this.path+a}},function(m,d,h){function e(a){var b="";do b=g[a%64]+b,a=Math.floor(a/64);while(0<a);return b}function q(){var a=e(+new Date);return a!==p?(b=0,p=a):a+"."+e(b++)}for(var g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a={},b=0,k=0,p;64>k;k++)a[g[k]]=k;q.encode=e;q.decode=function(b){var l=0;for(k=0;k<b.length;k++)l=64*l+a[b.charAt(k)];return l};m.exports=
q},function(m,d){var h=[].indexOf;m.exports=function(e,d){if(h)return e.indexOf(d);for(var g=0;g<e.length;++g)if(e[g]===d)return g;return-1}},function(m,d,h){function e(a,c,b){this.io=a;this.nsp=c;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;b&&b.query&&(this.query=b.query);this.io.autoConnect&&this.open()}var q=h(14);d=h(3);var g=h(68),a=h(30),b=h(31),k=h(5)("socket.io-client:socket"),p=h(6);m.exports=e;var n={connect:1,connect_error:1,
connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=d.prototype.emit;d(e.prototype);e.prototype.subEvents=function(){if(!this.subs){var f=this.io;this.subs=[a(f,"open",b(this,"onopen")),a(f,"packet",b(this,"onpacket")),a(f,"close",b(this,"onclose"))]}};e.prototype.open=e.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"===this.io.readyState)this.onopen();
this.emit("connecting");return this};e.prototype.send=function(){var a=g(arguments);a.unshift("message");this.emit.apply(this,a);return this};e.prototype.emit=function(a){if(n.hasOwnProperty(a))return l.apply(this,arguments),this;var c=g(arguments),b={type:q.EVENT,data:c,options:{}};b.options.compress=!this.flags||!1!==this.flags.compress;"function"===typeof c[c.length-1]&&(k("emitting packet with ack id %d",this.ids),this.acks[this.ids]=c.pop(),b.id=this.ids++);this.connected?this.packet(b):this.sendBuffer.push(b);
delete this.flags;return this};e.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};e.prototype.onopen=function(){k("transport is open - connecting");if("/"!==this.nsp)if(this.query){var a="object"===typeof this.query?p.encode(this.query):this.query;k("sending connect packet with query %s",a);this.packet({type:q.CONNECT,query:a})}else this.packet({type:q.CONNECT})};e.prototype.onclose=function(a){k("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",
a)};e.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case q.CONNECT:this.onconnect();break;case q.EVENT:this.onevent(a);break;case q.BINARY_EVENT:this.onevent(a);break;case q.ACK:this.onack(a);break;case q.BINARY_ACK:this.onack(a);break;case q.DISCONNECT:this.ondisconnect();break;case q.ERROR:this.emit("error",a.data)}};e.prototype.onevent=function(a){var c=a.data||[];k("emitting event %j",c);null!=a.id&&(k("attaching ack callback to event"),c.push(this.ack(a.id)));this.connected?
l.apply(this,c):this.receiveBuffer.push(c)};e.prototype.ack=function(a){var c=this,b=!1;return function(){if(!b){b=!0;var f=g(arguments);k("sending ack %j",f);c.packet({type:q.ACK,id:a,data:f})}}};e.prototype.onack=function(a){var c=this.acks[a.id];"function"===typeof c?(k("calling ack %s with %j",a.id,a.data),c.apply(this,a.data),delete this.acks[a.id]):k("bad ack %s",a.id)};e.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};e.prototype.emitBuffered=
function(){var a;for(a=0;a<this.receiveBuffer.length;a++)l.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};e.prototype.ondisconnect=function(){k("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};e.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};e.prototype.close=e.prototype.disconnect=
function(){this.connected&&(k("performing disconnect (%s)",this.nsp),this.packet({type:q.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this};e.prototype.compress=function(a){this.flags=this.flags||{};this.flags.compress=a;return this}},function(m,d){m.exports=function(d,e,q){d.on(e,q);return{destroy:function(){d.removeListener(e,q)}}}},function(m,d){var h=[].slice;m.exports=function(e,d){"string"==typeof d&&(d=e[d]);if("function"!=typeof d)throw Error("bind() requires a function");
var g=h.call(arguments,2);return function(){return d.apply(e,g.concat(h.call(arguments)))}}},function(m,d,h){var e=this,q=h(2),g=h(11),a=h(10),b=h(71),k=h(72),p=h(74),n=h(0).a.module("Stream");d.a=function(l,f){var c=Object(q.b)(f);c.stream=f.stream;c.url=f.url;c.recording=f.recording;c.room=void 0;c.showing=!1;c.local=!1;c.video=f.video;c.audio=f.audio;c.screen=f.screen;c.videoSize=f.videoSize;c.videoFrameRate=f.videoFrameRate;c.extensionId=f.extensionId;c.desktopStreamId=f.desktopStreamId;c.audioMuted=
!1;c.videoMuted=!1;c.unsubscribing={callbackReceived:!1,pcEventReceived:!1};c.p2p=!1;c.ConnectionHelpers=void 0===l?g.a:l;void 0!==c.url&&(f.label="ei_"+b.a.getRandomValue());var d=function(a){a.stream.id===c.getLabel()&&c.emit(Object(q.f)({type:"added",stream:a.stream}))},h=function(a){a.stream.id===c.getLabel()&&c.emit(Object(q.f)({type:"removed",stream:c}))},y=function(a){c.emit(Object(q.f)({type:"icestatechanged",msg:a}))};if(!(void 0===c.videoSize||c.videoSize instanceof Array&&4===c.videoSize.length))throw Error("Invalid Video Size");
if(void 0===f.local||!0===f.local)c.local=!0;c.getID=function(){return c.local&&!f.streamID?"local":f.streamID};c.getLabel=function(){return c.stream&&c.stream.id?c.stream.id:f.label};c.getAttributes=function(){return f.attributes};c.setAttributes=function(a){c.local?c.emit(Object(q.f)({type:"internal-set-attributes",stream:c,attrs:a})):n.error("message: Failed to set attributes data, reason: Stream has not been published, "+c.toLog())};c.toLog=function(){var a="streamId: "+c.getID()+", label: "+
c.getLabel();f.attributes&&Object.keys(f.attributes).forEach(function(c){a=a+", "+c+": "+f.attributes[c]});return a};c.updateLocalAttributes=function(a){f.attributes=a};c.hasAudio=function(){return!1!==f.audio&&void 0!==f.audio};c.hasVideo=function(){return!1!==f.video&&void 0!==f.video};c.hasData=function(){return!1!==f.data&&void 0!==f.data};c.hasScreen=function(){return f.screen};c.hasMedia=function(){return f.audio||f.video||f.screen};c.isExternal=function(){return void 0!==c.url||void 0!==c.recording};
c.addPC=function(b,f){f?(c.p2p=!0,void 0===c.pc&&(c.pc=Object(a.a)()),c.pc.add(f,b),b.on("ice-state-change",y)):(c.pc&&(c.pc.off("add-stream",d),c.pc.off("remove-stream",h),c.pc.off("ice-state-change",y)),c.pc=b,c.pc.on("add-stream",d),c.pc.on("remove-stream",h),c.pc.on("ice-state-change",y))};c.sendData=function(a){c.local&&c.hasData()?c.emit(Object(q.f)({type:"internal-send-data",stream:c,msg:a})):n.error("message: Failed to send data, reason: Stream has not been published, "+c.toLog())};c.init=
function(){try{if((f.audio||f.video||f.screen)&&void 0===f.url){n.debug("message: Requested access to local media, "+c.toLog());var a=f.video;!0===a||!0===f.screen?(a=!0===a||null===a?{}:a,void 0!==c.videoSize&&(a.width={min:c.videoSize[0],max:c.videoSize[2]},a.height={min:c.videoSize[1],max:c.videoSize[3]}),void 0!==c.videoFrameRate&&(a.frameRate={min:c.videoFrameRate[0],max:c.videoFrameRate[1]})):!0===f.screen&&void 0===a&&(a=!0);c.ConnectionHelpers.GetUserMedia({video:a,audio:f.audio,fake:f.fake,
screen:f.screen,extensionId:c.extensionId,desktopStreamId:c.desktopStreamId},function(a){n.debug("message: User has granted access to local media, "+c.toLog());c.stream=a;c.dispatchEvent(Object(q.f)({type:"access-accepted"}));a=0<c.stream.getVideoTracks().length;0<c.stream.getAudioTracks().length||(f.audio=!1);a||(f.video=!1);c.stream.getTracks().forEach(function(a){n.debug("message: getTracks, track: "+a.kind+", "+c.toLog());a.onended=function(){c.stream.getTracks().forEach(function(a){a.onended=
null});var b=Object(q.f)({type:"stream-ended",stream:c,msg:a.kind});c.dispatchEvent(b)}})},function(a){n.error("message: Failed to get access to local media, "+c.toLog()+", error: "+a.name+", message: "+a.message);a=Object(q.f)({type:"access-denied",msg:a});c.dispatchEvent(a)})}else{var b=Object(q.f)({type:"access-accepted"});c.dispatchEvent(b)}}catch(z){n.error("message: Failed to get access to local media, "+c.toLog()+", error: "+z),a=Object(q.f)({type:"access-denied",msg:z}),c.dispatchEvent(a)}};
c.close=function(){c.local&&(void 0!==c.room&&c.room.unpublish(c),c.hide(),void 0!==c.stream&&c.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),c.stream=void 0);c.pc&&!c.p2p?(c.pc.off("add-stream",d),c.pc.off("remove-stream",h),c.pc.off("ice-state-change",y)):c.pc&&c.p2p&&c.pc.forEach(function(a){a.off("add-stream",d);a.off("remove-stream",h);a.off("ice-state-change",y)});c.removeAllListeners()};c.play=function(a,b){b=b||{};c.elementID=a;var f=c.stream&&0<c.stream.getVideoTracks().length,
l=c.stream&&0<c.stream.getAudioTracks().length;f&&(c.hasVideo()||c.hasScreen())?void 0!==a&&(a=Object(k.a)({id:c.getID(),stream:c,elementID:a,options:b}),c.player=a,c.showing=!0):l&&c.hasAudio()&&(a=Object(p.a)({id:c.getID(),stream:c,elementID:a,options:b}),c.player=a,c.showing=!0)};c.stop=function(){if(c.showing&&void 0!==c.player){try{c.player.destroy()}catch(t){n.warning("message: Exception when destroying Player, error: "+t.message+", "+c.toLog())}c.showing=!1}};c.show=c.play;c.hide=c.stop;var m=
function(){if(void 0!==c.player&&void 0!==c.stream){var a=c.player.video,b=document.defaultView.getComputedStyle(a),f=parseInt(b.getPropertyValue("width"),10),l=parseInt(b.getPropertyValue("height"),10),e=parseInt(b.getPropertyValue("left"),10),b=parseInt(b.getPropertyValue("top"),10);var k="object"===typeof c.elementID&&"function"===typeof c.elementID.appendChild?c.elementID:document.getElementById(c.elementID);var n=document.defaultView.getComputedStyle(k);k=parseInt(n.getPropertyValue("width"),
10);var n=parseInt(n.getPropertyValue("height"),10),p=document.createElement("canvas");p.id="testing";p.width=k;p.height=n;p.setAttribute("style","display: none");p.getContext("2d").drawImage(a,e,b,f,l);return p}return null};c.getVideoFrameURL=function(a){var c=m();return null!==c?a?c.toDataURL(a):c.toDataURL():null};c.getVideoFrame=function(){var a=m();return null!==a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};c.checkOptions=function(a,b){if(!0===b){if(a.audio||a.screen)n.warning("message: Cannot update type of subscription, "+
c.toLog()),a.audio=void 0,a.screen=void 0}else!1===c.local&&(!0===a.video&&!1===c.hasVideo()&&(n.warning("message: Trying to subscribe to video when there is no video, "+c.toLog()),a.video=!1),!0===a.audio&&!1===c.hasAudio()&&(n.warning("message: Trying to subscribe to audio when there is no audio, "+c.toLog()),a.audio=!1));!1!==c.local||c.hasVideo()||!0!==a.slideShowMode||(n.warning("message: Cannot enable slideShowMode without video, "+c.toLog()),a.slideShowMode=!1)};var B=function(a){a=void 0===
a?function(){}:a;if(c.room&&c.room.p2p)n.warning("message: muteAudio/muteVideo are not implemented in p2p streams, "+c.toLog()),a("error");else{c.stream&&c.pc||(n.warning("message: muteAudio/muteVideo cannot be called until a stream is published or subscribed, "+c.toLog()),a("error"));for(var b=0;b<c.stream.getVideoTracks().length;b+=1)c.stream.getVideoTracks()[b].enabled=!c.videoMuted;b={muteStream:{audio:c.audioMuted,video:c.videoMuted}};c.checkOptions(b,!0);c.pc.updateSpec(b,c.getID(),a)}};c.muteAudio=
function(a,b){c.audioMuted=a;B(void 0===b?function(){}:b)};c.muteVideo=function(a,b){c.videoMuted=a;B(void 0===b?function(){}:b)};c._setStaticQualityLayer=function(a,b,f){f=void 0===f?function(){}:f;c.room&&c.room.p2p?(n.warning("message: setStaticQualityLayer is not implemented in p2p streams, "+c.toLog()),f("error")):(a={qualityLayer:{spatialLayer:a,temporalLayer:b}},c.checkOptions(a,!0),c.pc.updateSpec(a,c.getID(),f))};c._setDynamicQualityLayer=function(a){if(c.room&&c.room.p2p)n.warning("message: setDynamicQualityLayer is not implemented in p2p streams, "+
c.toLog()),a("error");else{var b={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};c.checkOptions(b,!0);c.pc.updateSpec(b,c.getID(),a)}};c._enableSlideShowBelowSpatialLayer=function(a,b,f){b=void 0===b?0:b;f=void 0===f?function(){}:f;c.room&&c.room.p2p?(n.warning("message: enableSlideShowBelowSpatialLayer is not implemented in p2p streams, "+c.toLog()),f("error")):(a={slideShowBelowLayer:{enabled:a,spatialLayer:b}},c.checkOptions(a,!0),n.debug("message: Calling updateSpec, "+c.toLog()+", config: "+
JSON.stringify(a)),c.pc.updateSpec(a,c.getID(),f))};c._setMinSpatialLayer=c._enableSlideShowBelowSpatialLayer.bind(e,!0);var v=function(a,b,f){!0!==b&&(b=!1);a="string"===typeof a?[a]:a;a=a instanceof Array?a:[];0<a.length&&c.room.sendControlMessage(c,"control",{name:"controlhandlers",enable:f,publisherSide:b,handlers:a})};c.disableHandlers=function(a,c){v(a,c,!1)};c.enableHandlers=function(a,c){v(a,c,!0)};c.updateSimulcastLayersBitrate=function(a){c.pc&&c.local&&c.pc.updateSimulcastLayersBitrate(a)};
c.updateSimulcastActiveLayers=function(a){c.pc&&c.local&&c.pc.updateSimulcastActiveLayers(a)};c.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(c.pc)if(c.checkOptions(a,!0),c.local)if(c.room.p2p)for(var f=0;f<c.pc.length;f+=1)c.pc[f].updateSpec(a,c.getID(),b);else c.pc.updateSpec(a,c.getID(),b);else c.pc.updateSpec(a,c.getID(),b);else b("This stream has no peerConnection attached, ignoring")};return c}},function(m,d,h){var e=h(9),q=h(73);d.a=function(d){var a=Object(e.a)({}),
b;a.elementID=d.elementID;a.id=d.id;a.div=document.createElement("div");a.div.setAttribute("id","bar_"+a.id);a.div.setAttribute("class","licode_bar");a.bar=document.createElement("div");a.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");a.bar.setAttribute("id","subbar_"+a.id);a.bar.setAttribute("class","licode_subbar");a.link=document.createElement("a");a.link.setAttribute("href","http://www.lynckia.com/");
a.link.setAttribute("class","licode_link");a.link.setAttribute("target","_blank");a.logo=document.createElement("img");a.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");a.logo.setAttribute("class","licode_logo");a.logo.setAttribute("alt","Lynckia");a.logo.setAttribute("src",a.url+"/assets/star.svg");var k=function(e){var k=e;"block"!==e?k="none":clearTimeout(b);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+
k)};a.display=function(){k("block")};a.hide=function(){b=setTimeout(k,1E3)};document.getElementById(a.elementID).appendChild(a.div);a.div.appendChild(a.bar);a.bar.appendChild(a.link);a.link.appendChild(a.logo);d.stream.screen||void 0!==d.options&&void 0!==d.options.speaker&&!0!==d.options.speaker||(a.speaker=Object(q.a)({elementID:"subbar_"+a.id,id:a.id,stream:d.stream,media:d.media}));a.display();a.hide();return a}},function(m,d,h){m=function(){for(var e,d,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),
a=[],b=0;b<g.length;b+=1)a[g[b]]=b;var k=function(){if(!e||d>=e.length)return-1;var a=e.charCodeAt(d)&255;d+=1;return a},p=function(){if(!e)return-1;for(;;){if(d>=e.length)return-1;var b=e.charAt(d);d+=1;if(a[b])return a[b];if("A"===b)return 0}},n=function(a){a=a.toString(16);1===a.length&&(a="0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var b;e=a;d=0;a="";var c=Array(3);var l=0;for(b=!1;!b&&-1!==(c[0]=k());)c[1]=k(),c[2]=k(),a+=g[c[0]>>2],-1!==c[1]?(a+=g[c[0]<<4&48|c[1]>>4],-1!==
c[2]?(a+=g[c[1]<<2&60|c[2]>>6],a+=g[c[2]&63]):(a+=g[c[1]<<2&60],a+="\x3d",b=!0)):(a+=g[c[0]<<4&48],a+="\x3d",a+="\x3d",b=!0),l+=4,76<=l&&(a+="\n",l=0);return a},decodeBase64:function(a){var b;e=a;d=0;a="";var c=Array(4);for(b=!1;!b&&-1!==(c[0]=p())&&-1!==(c[1]=p());)c[2]=p(),c[3]=p(),a+=n(c[0]<<2&255|c[1]>>4),-1!==c[2]?(a+=n(c[1]<<4&255|c[2]>>2),-1!==c[3]?a+=n(c[2]<<6&255|c[3]):b=!0):b=!0;return a}}}();d.a=m},function(m,d,h){Object.defineProperty(d,"__esModule",{value:!0});m=h(36);var e=h(34),q=h(17),
g=h(2),a=h(32),b=h(0);h(75);h={Room:m.a.bind(null,void 0,void 0,void 0),LicodeEvent:g.d,RoomEvent:g.e,StreamEvent:g.f,ConnectionEvent:g.a,Stream:a.a.bind(null,void 0),Logger:b.a,_:{ErizoConnectionManager:q.a,Room:m.a,Base64:e.a}};d["default"]=h},function(m,d,h){var e=this,q=h(17),g=h(11),a=h(2),b=h(42),k=h(32),p=h(10),n=h(34),l=h(0).a.module("Room");d.a=function(f,c,d,h){var r=Object(a.b)(h);r.remoteStreams=Object(p.a)();r.localStreams=Object(p.a)();r.roomID="";r.state=0;r.p2p=!1;r.minConnectionQualityLevel=
"";r.ConnectionHelpers=void 0===c?g.a:c;r.erizoConnectionManager=void 0===d?new q.a:new d.ErizoConnectionManager;r.disableIceRestart=!!h.disableIceRestart;var u=Object(b.a)(f);r.socket=u;var m=r.remoteStreams,v=r.localStreams,t=function(){return"roomId: "+(0<r.roomID.length?r.roomID:"undefined")},x=function(a){a.removeAllListeners();a.pc&&!r.p2p&&a.pc.removeStream(a);l.debug("message: Removed stream, "+a.toLog()+", "+t());a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&r.p2p?
a.pc.forEach(function(c,b){c.close();a.pc.remove(b)}):(r.erizoConnectionManager.maybeCloseConnection(a.pc),delete a.pc))},z=function(c,b){l.info("message: Stream subscribed, "+c.toLog()+", "+t());c.stream=b.stream;r.p2p||c.pc.addStream(c);c.state="subscribed";c=Object(a.f)({type:"stream-subscribed",stream:c});r.dispatchEvent(c)},F=function(c){l.debug("message: Unsubscribing Stream, "+c.toLog()+", unsubscribing: "+c.unsubscribing+", "+t());c&&c.unsubscribing.callbackReceived&&(c.unsubscribing.pcEventReceived||
c.failed)?(l.info("message: Stream fully unsubscribed, "+c.toLog()+", "+t()),c.unsubscribing.callbackReceived=!1,c.unsubscribing.pcEventReceived=!1,x(c),delete c.failed,c.state="unsubscribed",c=Object(a.f)({type:"stream-unsubscribed",stream:c}),r.dispatchEvent(c)):l.debug("message: Not dispatching stream unsubscribed yet, "+c.toLog()+", "+t())},D=function(c,b,f,l){0!==r.state&&c&&!c.failed&&(c.failed=!0,b=Object(a.f)({type:"stream-failed",msg:b||"Stream failed after connection",stream:c,origin:void 0===
f?"unknown":f,wasAbleToConnect:void 0===l?!1:l}),r.dispatchEvent(b),b=c.pc,c.local?r.unpublish(c):c.unsubscribing.callbackReceived?F(c):r.unsubscribe(c),b&&h.singlePC&&r.erizoConnectionManager.maybeCloseConnection(b,!0))},E=function(a,c){return{callback:function(b,f){u.sendSDP("streamMessageP2P",{streamId:a.getID(),streamIds:f,peerSocket:c,msg:b})},audio:a.hasAudio(),video:a.hasVideo(),iceServers:r.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:h.maxAudioBW,limitMaxVideoBW:h.maxVideoBW,
forceTurn:a.forceTurn,p2p:!0,disableIceRestart:r.disableIceRestart}},I=function(a,c){c=r.erizoConnectionManager.getOrBuildErizoConnection(E(a,c));a.addPC(c);c.on("connection-failed",r.dispatchEvent.bind(e));a.on("added",z.bind(null,a));a.on("icestatechanged",function(c){l.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+c.msg.state+", "+t());"failed"===c.msg.state&&D(a,"ICE Connection Failed","ice-client",c.msg.wasAbleToConnect)})},C=function(a,c){var b=r.erizoConnectionManager.getOrBuildErizoConnection(E(a,
c));a.addPC(b,c);b.on("connection-failed",r.dispatchEvent.bind(e));a.on("icestatechanged",function(b){l.debug("message: icestatechanged, streamId: "+a.getID()+", iceConnectionState: "+b.msg.state+", "+t());"failed"===b.msg.state&&(a.pc.get(c).close(),a.pc.remove(c))});b.addStream(a)},M=function(a){r.remoteStreams.forEach(function(c){c.local||c.getLabel()!==a||(c.unsubscribing.pcEventReceived=!0,F(c))})},G=function(a,c,b,f,e){var k={callback:function(f,e){e=void 0===e?a.getID():e;l.debug("message: Sending message, data: "+
JSON.stringify(f)+", "+a.toLog()+", "+t());f&&f.type&&"updatestream"===f.type?u.sendSDP("streamMessage",{streamId:e,erizoId:b,msg:f,browser:a.pc&&a.pc.browser},void 0,function(){}):u.sendSDP("connectionMessage",{connectionId:c,erizoId:b,msg:f,browser:a.pc&&a.pc.browser},void 0,function(){})},connectionId:c,nop2p:!0,audio:f.audio&&a.hasAudio(),video:f.video&&a.hasVideo(),maxAudioBW:f.maxAudioBW,maxVideoBW:f.maxVideoBW,limitMaxAudioBW:h.maxAudioBW,limitMaxVideoBW:h.maxVideoBW,label:a.getLabel(),iceServers:r.iceServers,
disableIceRestart:r.disableIceRestart,forceTurn:a.forceTurn,p2p:!1,streamRemovedListener:M,isRemote:e};e||(k.simulcast=f.simulcast,k.startVideoBW=f.startVideoBW,k.hardMinVideoBW=f.hardMinVideoBW);return k},H=function(a,c,b,f){var k=G(a,c,b,f,!0);c=r.erizoConnectionManager.getOrBuildErizoConnection(k,b,h.singlePC);a.addPC(c);c.on("connection-failed",r.dispatchEvent.bind(e));a.on("added",z.bind(null,a));a.on("icestatechanged",function(c){l.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+
c.msg.state+", "+t());"failed"===c.msg.state&&(D(a,"ICE Connection Failed","ice-client",c.msg.wasAbleToConnect),h.singlePC&&k.callback({type:"failed"}))})},J=function(a,c,b,f){var k=G(a,c,b,f);c=r.erizoConnectionManager.getOrBuildErizoConnection(k,b,h.singlePC);a.addPC(c);c.on("connection-failed",r.dispatchEvent.bind(e));a.on("icestatechanged",function(c){l.debug("message: icestatechanged, "+a.toLog()+", iceConnectionState: "+c.msg.state+", "+t());"failed"===c.msg.state&&(D(a,"ICE Connection Failed",
"ice-client",c.msg.wasAbleToConnect),h.singlePC&&k.callback({type:"failed"}))});a.pc.addStream(a)},N=function(c){var b=c.evt.level,f=Number.MAX_SAFE_INTEGER,l="";v.forEach(function(a){!a.failed&&a.pc&&(a.pc.connectionId===c.connectionId&&a.pc.setQualityLevel(b),a=a.pc.getQualityLevel(),a.index<f&&(f=a.index,l=a.message))});m.forEach(function(a){a.failed&&a.pc&&(a.pc.connectionId===c.connectionId&&a.pc.setQualityLevel(b),a=a.pc.getQualityLevel(),a.index<f&&(f=a.index,l=a.message))});l!==r.minConnectionQualityLevel&&
(r.minConnectionQualityLevel=l,r.dispatchEvent(Object(a.e)({type:"quality-level",message:l})))},K=function(a){var c=a.stream;a=a.msg;c.local?u.sendMessage("sendDataStream",{id:c.getID(),msg:a}):l.error("message: You can not send data through a remote stream, "+c.toLog()+", "+t())},O=function(a){var c=a.stream;a=a.attrs;c.local?(c.updateLocalAttributes(a),u.sendMessage("updateStreamAttributes",{id:c.getID(),attrs:a})):l.error("message: You can not update attributes in a remote stream, "+c.toLog()+
", "+t())};f=function(a,c){c.args?a.apply(null,[].concat($jscomp.arrayFromIterable(c.args))):a()};var P=function(a,c,b){return{state:a,data:c.hasData(),audio:c.hasAudio(),video:c.hasVideo(),label:c.getLabel(),screen:c.hasScreen(),attributes:c.getAttributes(),metadata:b.metadata,createOffer:b.createOffer,muteStream:b.muteStream,encryptTransport:void 0===b.encryptTransport?!0:b.encryptTransport,handlerProfile:b.handlerProfile}},L=function(a,c,b,f){f=void 0===f?function(){}:f;null===a?(l.error("message: Error when publishing the stream, "+
c.toLog()+", "+t()+", error: "+b),f(void 0,b)):(l.info("message: Stream published, "+c.toLog()+", "+t()),c.getID=function(){return a},c.on("internal-send-data",K),c.on("internal-set-attributes",O),v.add(a,c),c.room=r,f(a))},R=function(a,c,b){b=void 0===b?function(){}:b;if(a.url){var f="url";var e=a.url}else f="recording",e=a.recording;l.debug("message: Checking publish options, "+a.toLog()+", "+t());a.checkOptions(c);u.sendSDP("publish",P(f,a,c),e,function(c,f){L(c,a,f,b)})},S=function(a,c,b){b=void 0===
b?function(){}:b;a.maxAudioBW=c.maxAudioBW;a.maxVideoBW=c.maxVideoBW;u.sendSDP("publish",P("p2p",a,c),void 0,function(c,f){L(c,a,f,b)})},T=function(a,c,b){b=void 0===b?function(){}:b;u.sendSDP("publish",P("data",a,c),void 0,function(c,f){L(c,a,f,b)})},U=function(a,c,b){b=void 0===b?function(){}:b;l.debug("message: Publishing to Erizo Normally, createOffer: "+c.createOffer+", "+t());var f=P("erizo",a,c);f.minVideoBW=c.minVideoBW;f.maxVideoBW=c.maxVideoBW;f.scheme=c.scheme;u.sendSDP("publish",f,void 0,
function(f,e,k,n){null===f?(l.error("message: Error publishing stream, "+a.toLog()+", "+t()+", error: "+n),b(void 0,n)):(L(f,a,n,void 0),J(a,k,e,c),b(f))})},V=function(a,c){a=c&&a.hasVideo();var b=c&&c.width,f=c&&c.height;c=c&&c.frameRate;return b||f||c?{width:b,height:f,frameRate:c}:a},W=function(a,c,b){b=void 0===b?function(){}:b;c.maxVideoBW=c.maxVideoBW||h.defaultVideoBW;c.maxVideoBW>h.maxVideoBW&&(c.maxVideoBW=h.maxVideoBW);c.audio=void 0===c.audio?!0:c.audio;c.video=void 0===c.video?!0:c.video;
c.data=void 0===c.data?!0:c.data;c.encryptTransport=void 0===c.encryptTransport?!0:c.encryptTransport;a.checkOptions(c);var f={streamId:a.getID(),audio:c.audio&&a.hasAudio(),video:V(a,c.video),maxVideoBW:c.maxVideoBW,data:c.data&&a.hasData(),browser:r.ConnectionHelpers.getBrowser(),createOffer:c.createOffer,metadata:c.metadata,muteStream:c.muteStream,encryptTransport:c.encryptTransport,slideShowMode:c.slideShowMode,handlerProfile:c.handlerProfile};u.sendSDP("subscribe",f,void 0,function(f,e,k,n){null===
f?(l.error("message: Error subscribing to stream, "+a.toLog()+", "+t()+", error: "+n),a.state="unsubscribed",b(void 0,n)):(l.debug("message: Subscriber added, "+a.toLog()+", "+t()+", erizoId: "+e+", connectionId: "+k),H(a,k,e,c),b(!0))})},w=function(c,b,f){f=void 0===f?function(){}:f;u.sendSDP("subscribe",{streamId:c.getID(),data:b.data,metadata:b.metadata},void 0,function(b,e){null===b?(l.error("message: Error subscribing to stream, "+c.toLog()+", "+t()+", error: "+e),c.state="unsubscribed",f(void 0,
e)):(l.debug("message: Stream subscribed, "+c.toLog()+", "+t()),b=Object(a.f)({type:"stream-subscribed",stream:c}),r.dispatchEvent(b),f(!0))})};r.connect=function(c){c=void 0===c?{}:c;var b=JSON.parse(n.a.decodeBase64(h.token));0!==r.state&&l.warning("message: Room already connected, roomId: "+r.roomID+", "+t());r.state=1;r.clientIntiatedDisconnection=!1;l.info("message: Connecting to room, tokenId: "+b.tokenId);u.connect(b,c,function(c){var b=[],f=c.streams||[],e=c.id;r.p2p=c.p2p;r.iceServers=c.iceServers;
r.state=2;h.singlePC=c.singlePC;h.defaultVideoBW=c.defaultVideoBW;h.maxVideoBW=c.maxVideoBW;r.streamPriorityStrategy=c.streamPriorityStrategy;for(var n=Object.keys(f),d=0;d<n.length;d+=1){var p=f[n[d]];c=Object(k.a)(r.ConnectionHelpers,{streamID:p.id,local:!1,audio:p.audio,video:p.video,data:p.data,label:p.label,screen:p.screen,attributes:p.attributes});c.room=r;c.state="unsubscribed";b.push(c);m.add(p.id,c)}r.roomID=e;l.info("message: Connected to room, "+t());b=Object(a.e)({type:"room-connected",
streams:b});r.dispatchEvent(b)},function(c){l.error("message: Error connecting to room, "+t()+", error: "+c);c=Object(a.e)({type:"room-error",message:c});r.dispatchEvent(c)})};r.disconnect=function(){l.info("message: Disconnection requested, "+t());var c=Object(a.e)({type:"room-disconnected",message:"expected-disconnection"});r.clientIntiatedDisconnection=!0;r.dispatchEvent(c)};r.publish=function(a,c,b){c=void 0===c?{}:c;b=void 0===b?function(){}:b;l.info("message: Publishing stream, "+a.toLog()+
", "+t());c.maxVideoBW=c.maxVideoBW||h.defaultVideoBW;c.maxVideoBW>h.maxVideoBW&&(c.maxVideoBW=h.maxVideoBW);void 0===c.minVideoBW&&(c.minVideoBW=0);c.minVideoBW>h.defaultVideoBW&&(c.minVideoBW=h.defaultVideoBW);a.forceTurn=c.forceTurn;c.simulcast=c.simulcast||!1;c.handlerProfile=c.handlerProfile||null;c.muteStream={audio:a.audioMuted,video:a.videoMuted};a&&a.local&&!a.failed&&!v.has(a.getID())?a.hasMedia()?a.isExternal()?R(a,c,b):r.p2p?S(a,c,b):U(a,c,b):a.hasData()&&T(a,c,b):(l.error("message: Trying to publish invalid stream, "+
a.toLog()+", "+t()),b(void 0,"Invalid Stream"))};r.startRecording=function(a,c){c=void 0===c?function(){}:c;void 0===a?(l.error("message: Trying to start recording on an invalid stream, "+a.toLog()+", "+t()),c(void 0,"Invalid Stream")):(l.debug("message: Start Recording stream, "+a.toLog()+", "+t()),u.sendMessage("startRecorder",{to:a.getID()},function(b,f){null===b?(l.error("message: Error on start recording, "+a.toLog()+", "+t()+", error: "+f),c(void 0,f)):(l.debug("message: Start recording, id: "+
b+", "+t()),c(b))}))};r.stopRecording=function(a,c){c=void 0===c?function(){}:c;u.sendMessage("stopRecorder",{id:a},function(b,f){null===b?(l.error("message: Error on stop recording, recordingId: "+a+", "+t()+", error: "+f),c(void 0,f)):(l.debug("message: Stop recording, id: "+a+", "+t()),c(!0))})};r.unpublish=function(a,c){c=void 0===c?function(){}:c;var b=r.localStreams.get(a.getID());b&&b.local?(u.sendMessage("unpublish",b.getID(),function(a,f){null===a?(l.error("message: Error unpublishing stream, "+
b.toLog()+", "+t()+", error: "+f),c(void 0,f)):(l.info("message: Stream unpublished, "+b.toLog()+", "+t()),delete b.failed,c(!0))}),l.info("message: Unpublishing stream, "+b.toLog()+", "+t()),b.room=void 0,b.hasMedia()&&!b.isExternal()&&(a=v.has(b.getID())?v.get(b.getID()):b,x(a)),v.remove(b.getID()),b.getID=function(){},b.off("internal-send-data",K),b.off("internal-set-attributes",O)):(a="message: Cannot unpublish because stream does not exist or is not local, "+b.toLog()+", "+t(),l.error(a),c(void 0,
a))};r.sendControlMessage=function(a,c,b){a&&a.getID()&&(c={type:"control",action:b},u.sendSDP("streamMessage",{streamId:a.getID(),msg:c}))};r.subscribe=function(a,c,b){c=void 0===c?{}:c;b=void 0===b?function(){}:b;a=r.remoteStreams.get(a.getID());if(!a||a.local||a.failed)c="Error on subscribe",a.state="unsubscribed",a?a.local?(l.warning("message: Cannot subscribe to local stream, "+a.toLog()+", "+t()),c="Local copy of stream"):a.failed&&(l.warning("message: Cannot subscribe to failed stream, "+a.toLog()+
", "+t()+","+("unsubscribing: "+a.unsubscribing+", failed: "+a.failed)),c="Failed stream"):(l.warning("message: Cannot subscribe to invalid stream, "+a.toLog()+", "+t()),c="Invalid or undefined stream"),b(void 0,c);else if("unsubscribed"!==a.state&&"unsubscribing"!==a.state)l.warning("message: Cannot subscribe to a subscribed stream, "+a.toLog()+", "+t()),b(void 0,"Stream already subscribed");else{a.state="subscribing";if(a.hasMedia())if(a.hasVideo()||a.hasScreen()||(c.video=!1),a.hasAudio()||(c.audio=
!1),c.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=c.forceTurn,r.p2p){var f=m.get(a.getID());f.maxAudioBW=c.maxAudioBW;f.maxVideoBW=c.maxVideoBW;u.sendSDP("subscribe",{streamId:a.getID(),metadata:c.metadata});b(!0)}else W(a,c,b);else if(a.hasData()&&!1!==c.data)w(a,c,b);else{l.warning("message: There is nothing to subscribe to in stream, "+a.toLog()+", "+t());a.state="unsubscribed";b(void 0,"Nothing to subscribe to");return}l.info("message: Subscribing to stream, "+a.toLog()+", "+
t())}};r.unsubscribe=function(a,c){c=void 0===c?function(){}:c;var b=r.remoteStreams.get(a.getID());void 0!==u&&(b&&!b.local?"subscribed"!==b.state&&"subscribing"!==b.state?(l.warning("message: Cannot unsubscribe to a stream that is not subscribed, "+b.toLog()+", "+t()),c(void 0,"Stream not subscribed")):(b.state="unsubscribing",l.info("message: Unsubscribing stream, "+b.toLog()+", "+t()),u.sendMessage("unsubscribe",b.getID(),function(a,f){null===a?(b.state="subscribed",c(void 0,f)):(c(!0),b.unsubscribing.callbackReceived=
!0,F(b))},function(){b.state="subscribed";l.error("message: Error calling unsubscribe, "+b.toLog()+", "+t())})):(b.state="unsubscribed",c(void 0,"Error unsubscribing, stream does not exist or is not local")))};r.getStreamStats=function(a,c){c=void 0===c?function(){}:c;if(!u)return"Error getting stats - no socket";if(!a)return"Error getting stats - no stream";u.sendMessage("getStreamStats",a.getID(),function(a){a&&c(a)})};r.getStreamsByAttribute=function(a,c){var b=[];m.forEach(function(f){void 0!==
f.getAttributes()&&f.getAttributes()[a]===c&&b.push(f)});return b};r.setStreamPriorityStrategy=function(a,c){c=void 0===c?function(){}:c;u.sendMessage("setStreamPriorityStrategy",a,function(a){a&&c(a)})};r.on("room-disconnected",function(){r.state=0;u.state=u.DISCONNECTED;r.erizoConnectionManager.ErizoConnectionsMap.forEach(function(a){Object.keys(a).forEach(function(c){a[c].close()})});m.forEach(function(c,b){x(c);m.remove(b);c&&!c.failed&&(c=Object(a.f)({type:"stream-removed",stream:c}),r.dispatchEvent(c))});
m=Object(p.a)();v.forEach(function(a,c){x(a);v.remove(c)});v=Object(p.a)();try{u.disconnect(r.clientIntiatedDisconnection)}catch(Q){l.debug("message: Socket already disconnected, "+t()+", error: "+Q)}l.info("message: Disconnected from room, roomId: "+r.roomID+", "+t());u=void 0});u.on("onAddStream",f.bind(null,function(c){if(!m.has(c.id)){var b=Object(k.a)(r.Connection,{streamID:c.id,local:v.has(c.id),audio:c.audio,video:c.video,data:c.data,label:c.label,screen:c.screen,attributes:c.attributes});
b.room=r;b.state="unsubscribed";m.add(c.id,b);c=Object(a.f)({type:"stream-added",stream:b});r.dispatchEvent(c)}}));u.on("stream_message_erizo",f.bind(null,function(a){l.debug("message: Failed applying a stream message from erizo, "+t()+", msg: "+JSON.stringify(a))}));u.on("stream_message_p2p",f.bind(null,function(a){var c=v.get(a.streamId);c&&!c.failed?c.pc.get(a.peerSocket).processSignalingMessage(a.msg):(c=m.get(a.streamId),c.pc||I(c,a.peerSocket),c.pc.processSignalingMessage(a.msg))}));u.on("connection_message_erizo",
f.bind(null,function(a){if("quality_level"===a.evt.type)N(a);else{var c=r.erizoConnectionManager.getErizoConnection(a.connectionId);c?c.processSignalingMessage(a.evt):l.warning("message: Received signaling message to unknown connectionId, connectionId: "+a.connectionId+", "+t())}}));u.on("publish_me",f.bind(null,function(a){var c=v.get(a.streamId);C(c,a.peerSocket)}));u.on("unpublish_me",f.bind(null,function(a){var c=v.get(a.streamId);c&&(a=a.peerSocket,void 0!==c.pc&&c.pc.has(a)&&(c.pc.get(a).close(),
c.pc.remove(a)))}));u.on("onBandwidthAlert",f.bind(null,function(c){l.debug("message: Bandwidth Alert, streamId: "+c.streamID+", bwMessage: "+c.message+", bandwidth: "+c.bandwidth+", "+t());if(c.streamID){var b=m.get(c.streamID);b&&!b.failed&&(c=Object(a.f)({type:"bandwidth-alert",stream:b,msg:c.message,bandwidth:c.bandwidth}),b.dispatchEvent(c))}}));u.on("onDataStream",f.bind(null,function(c){var b=m.get(c.id);c=Object(a.f)({type:"stream-data",msg:c.msg,stream:b});b.dispatchEvent(c)}));u.on("onUpdateAttributeStream",
f.bind(null,function(c){var b=m.get(c.id),f=Object(a.f)({type:"stream-attributes-update",attrs:c.attrs,stream:b});b.updateLocalAttributes(c.attrs);b.dispatchEvent(f)}));u.on("onRemoveStream",f.bind(null,function(c){var b=v.get(c.id);if(b)D(b,"Stream removed from server","server");else if(b=m.get(c.id))l.info("message: Stream removed, "+b.toLog()+", "+t()),x(b),m.remove(c.id),c=Object(a.f)({type:"stream-removed",stream:b}),r.dispatchEvent(c)}));u.on("disconnect",f.bind(null,function(){l.info("message: Socket disconnected, reason: lost connection to ErizoController, "+
t());if(0!==r.state){l.error("message: Unexpected disconnection from ErizoController, "+t());var c=Object(a.e)({type:"room-disconnected",message:"unexpected-disconnection"});r.dispatchEvent(c)}}));u.on("reconnecting",f.bind(null,function(c){l.info("message: Socket reconnecting, reason: lost connection to ErizoController, "+t());c=Object(a.e)({type:"room-reconnecting",message:"reconnecting - "+c});r.dispatchEvent(c)}));u.on("reconnected",f.bind(null,function(){l.info("message: Socket reconnected, reason: restablished connection to ErizoController, "+
t());var c=Object(a.e)({type:"room-reconnected",message:"reconnected"});r.dispatchEvent(c)}));u.on("connection_failed",f.bind(null,function(a){if(a.streamId){var c="message: ICE Connection Failed, type: "+a.type+", streamId: "+a.streamId+", state: "+r.state+", "+t();l.error(c);a="publish"===a.type?v.get(a.streamId):m.get(a.streamId);D(a,c,"ice-server")}}));u.on("error",f.bind(null,function(c){l.error("message: Error in the connection to Erizo Controller, "+t()+", error: "+c);c=Object(a.e)({type:"room-error",
message:c});r.dispatchEvent(c)}));return r}},function(m,d,h){d.a={addSim:function(e){var d="a\x3dssrc-group:SIM";e.forEach(function(e){d+=" "+e});return d+"\r\n"},addGroup:function(e,d){return"a\x3dssrc-group:FID "+e+" "+d+"\r\n"},addSpatialLayer:function(e,d,g,a,b,k){return"a\x3dssrc:"+b+" cname:"+e+"\r\n"+("a\x3dssrc:"+b+" msid:"+d+"\r\n")+("a\x3dssrc:"+b+" mslabel:"+g+"\r\n")+("a\x3dssrc:"+b+" label:"+a+"\r\n")+("a\x3dssrc:"+k+" cname:"+e+"\r\n")+("a\x3dssrc:"+k+" msid:"+d+"\r\n")+("a\x3dssrc:"+
k+" mslabel:"+g+"\r\n")+("a\x3dssrc:"+k+" label:"+a+"\r\n")},setMaxBW:function(e,d){if(d.p2p){if(d.video&&d.maxVideoBW){var g=e.getMedia("video");g&&g.setBitrate(d.maxVideoBW)}d.audio&&d.maxAudioBW&&(e=e.getMedia("audio"))&&e.setBitrate(d.maxAudioBW)}},enableOpusNacks:function(e){var d=e.match(/a=rtpmap:(.*)opus.*\r\n/);null!==d&&(e=e.replace(d[0],d[0]+"a\x3drtcp-fb:"+d[1]+"nack\r\n"));return e},setParamForCodecs:function(e,d,g,a){e.medias.forEach(function(b){b.id===d&&b.codecs.forEach(function(b){b.setParam(g,
a)})})}}},function(m,d,h){m=h(0);var e=h(18),q=m.a.module("SafariStack");d.a=function(d){q.debug("message: Starting Safari stack");var a=Object(e.a)(d);a._updateTracksToBeNegotiatedFromStream=function(){a.tracksToBeNegotiated+=1};return a}},function(m,d,h){m=h(0);var e=h(19),q=m.a.module("FirefoxStack"),g=[{rid:"3"},{rid:"2",scaleResolutionDownBy:2},{rid:"1",scaleResolutionDownBy:4}];d.a=function(a){q.debug("message: Starting Firefox stack");var b=Object(e.a)(a);b.enableSimulcast=function(a){return a};
var k=function(a){for(var e=a.getParameters()||{},l=b.simulcast.numSpatialLayers||3,f=g.length,l=l<f?l:f,c=[],k=f-1;k>=f-l;--k)c.push(g[k]);e.encodings=c;return a.setParameters(e)};b.addStream=function(a){a.transceivers=[];a.getTracks().forEach(function(e){return $jscomp.executeAsyncGenerator(function(){function l(l,n){for(;;)switch(f){case 0:d={},"video"===e.kind&&b.simulcast&&(d={sendEncodings:[]}),d.streams=[a],c=b.peerConnection.addTransceiver(e,d),a.transceivers.push(c),"video"===e.kind&&b.simulcast&&
k(c.sender).catch(function(){}),f=-1;default:return{value:void 0,done:!0}}}var f=0,c,d,n={next:function(a){return l(a,void 0)},throw:function(a){return l(void 0,a)},return:function(a){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();n[Symbol.iterator]=function(){return this};return n}())})};b.prepareCreateOffer=function(){return Promise.resolve()};return b}},function(m,d,h){var e=h(0).a.module("FcStack");d.a=function(d){var g={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,
close:function(){e.debug("message: Close FcStack")},createOffer:function(){e.debug("message: CreateOffer")},addStream:function(a){e.debug("message: addStream, "+a.toLog())},processSignalingMessage:function(a){e.debug("message: processSignaling, message: "+a);void 0!==g.signalCallback&&g.signalCallback(a)},sendSignalingMessage:function(a){e.debug("message: Sending signaling Message, message: "+a);d.callback(a)},setSignalingCallback:function(a){a=void 0===a?function(){}:a;e.debug("message: Setting signalling callback");
g.signalCallback=a}};return g}},function(m,d){m.exports=function(d){if(!d.webpackPolyfill){var e=Object.create(d);e.children||(e.children=[]);Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}});Object.defineProperty(e,"exports",{enumerable:!0});e.webpackPolyfill=1}return e}},function(m,d,h){h.d(d,"a",function(){return k});m=h(43);var e=h.n(m);m=h(0);var q=h(70);h.n(q);var g=h(2),a=m.a.module("Socket"),
b=function(a,b){a=Object(g.d)({type:a});a.args=b.args;return a},k=function(k){var d=Object(g.b)(),l=function(){};$jscomp.initSymbol();d.CONNECTED=Symbol("connected");$jscomp.initSymbol();d.RECONNECTING=Symbol("reconnecting");$jscomp.initSymbol();d.DISCONNECTED=Symbol("disconnected");d.state=d.DISCONNECTED;d.IO=void 0===k?e.a:k;var f,c,p=!1,h=function(a,c){for(var f=[],l=1;l<arguments.length;++l)f[l-1]=arguments[l];d.emit(b(a,{args:f}))};d.connect=function(b,e,k,n){k=void 0===k?l:k;n=void 0===n?l:
n;Object.assign(e,b);f=d.IO.connect((b.secure?"wss://":"ws://")+b.host,{reconnection:!0,reconnectionAttempts:3,reconnectionDelay:1E3,reconnectionDelayMax:4E3,randomizationFactor:.5,secure:b.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1,query:e});c=new q.ReliableSocket(f);d.reliableSocket=c;var g=1E3,r=f.io.engine.transport.ws.onclose;f.io.engine.transport.ws.onclose=function(c){a.info("message: WebSocket closed, code: "+c.code+", id: "+d.id);g=c.code;r(c)};c.on("connected",function(c){a.info("message: connected, previousState: "+
d.state.toString()+", id: "+d.id);d.state=d.CONNECTED;d.id=c.clientId;k(c)});c.on("onAddStream",h.bind(d,"onAddStream"));c.on("stream_message_erizo",h.bind(d,"stream_message_erizo"));c.on("stream_message_p2p",h.bind(d,"stream_message_p2p"));c.on("connection_message_erizo",h.bind(d,"connection_message_erizo"));c.on("publish_me",h.bind(d,"publish_me"));c.on("unpublish_me",h.bind(d,"unpublish_me"));c.on("onBandwidthAlert",h.bind(d,"onBandwidthAlert"));c.on("onDataStream",h.bind(d,"onDataStream"));c.on("onUpdateAttributeStream",
h.bind(d,"onUpdateAttributeStream"));c.on("onRemoveStream",h.bind(d,"onRemoveStream"));c.on("onAutomaticStreamsSubscription",h.bind(d,"onAutomaticStreamsSubscription"));c.on("connection_failed",function(c){a.warning("message: connection failed, id: "+d.id+", evt: "+c);h("connection_failed",c)});c.on("connect",function(){a.info("message: connect, previousState: "+d.state.toString()+", id: "+d.id);d.state===d.RECONNECTING&&(a.info("message: reconnected, id: "+d.id),d.state=d.CONNECTED,h("reconnected",
d.id))});c.on("error",function(b){a.warning("message: socket error, id: "+d.id+", state: "+d.state.toString()+", error: "+b);b.startsWith("token: ")?(d.state=d.DISCONNECTED,n(b.slice(7)),c.disconnect()):d.state===d.RECONNECTING?(d.state=d.DISCONNECTED,c.disconnect(!0),h("disconnect",b)):d.state===d.DISCONNECTED?c.disconnect(!0):h("error")});c.on("disconnect",function(b){var f=c.getNumberOfPending();a.info("message: disconnect, id: "+d.id+", reason: "+b+", closeCode: "+g+", pending: "+f);d.clientInitiated?
(d.state=d.DISCONNECTED,p||h("disconnect",b),c.disconnect(!0)):(d.state=d.RECONNECTING,h("reconnecting","reason: "+b+", pendingMessages: "+f))});c.on("connect_error",function(c){a.warning("message: connect error, id: "+d.id+", error: "+c.message)});c.on("connect_timeout",function(c){a.warning("message: connect timeout, id: "+d.id+", error: "+c.message)});c.on("reconnecting",function(c){a.info("message: reconnecting, id: "+d.id+", attempt: "+c)});c.on("reconnect",function(c){a.info("message: internal ws reconnected, id: "+
d.id+", attempt: "+c)});c.on("reconnect_attempt",function(c){a.debug("message: reconnect attempt, id: "+d.id+", attempt: "+c);e.clientId=d.id;f.io.opts.query=e});c.on("reconnect_error",function(c){a.info("message: error reconnecting, id: "+d.id+", error: "+c.message)});c.on("reconnect_failed",function(){a.info("message: reconnect failed, id: "+d.id);d.state=d.DISCONNECTED;h("disconnect","reconnect failed");c.disconnect(!0)})};var m=function(a){d.state!==d.DISCONNECTED&&(a.preventDefault(),delete a.returnValue,
p=!0,d.disconnect(!0))};d.disconnect=function(b){a.warning("message: disconnect, id: "+d.id+", clientInitiated: "+b+", state: "+d.state.toString());d.state=d.DISCONNECTED;(d.clientInitiated=b)&&c.emit("clientDisconnection");c.disconnect();window.removeEventListener("beforeunload",m)};window.addEventListener("beforeunload",m);d.sendMessage=function(b,f,e,k){e=void 0===e?l:e;k=void 0===k?l:k;d.state===d.DISCONNECTED?a.debug("message: Trying to send a message over a disconnected Socket, id: "+d.id+", type: "+
b):c.emit(b,f,function(a,c){"success"===a?e(c):"error"===a?k(c):e(a,c)})};d.sendSDP=function(b,f,e,k){k=void 0===k?l:k;d.state===d.DISCONNECTED?a.warning("message: Trying to send a message over a disconnected Socket, id: "+d.id):c.emit(b,{options:f,sdp:e},function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];k.apply(null,[].concat($jscomp.arrayFromIterable(c)))})};return d}},function(m,d,h){function e(d,e){"object"===typeof d&&(e=d,d=void 0);e=e||{};d=q(d);var l=d.source,f=d.id,
c=d.path,c=k[f]&&c in k[f].nsps;e.forceNew||e["force new connection"]||!1===e.multiplex||c?(b("ignoring socket cache for %s",l),l=a(l,e)):(k[f]||(b("new io instance for %s",l),k[f]=a(l,e)),l=k[f]);d.query&&!e.query&&(e.query=d.query);return l.socket(d.path,e)}var q=h(44),g=h(14),a=h(24),b=h(5)("socket.io-client");m.exports=d=e;var k=d.managers={};d.protocol=g.protocol;d.connect=e;d.Manager=h(24);d.Socket=h(29)},function(m,d,h){(function(d){var e=h(20),g=h(5)("socket.io-client:url");m.exports=function(a,
b){var k=a;b=b||d.location;null==a&&(a=b.protocol+"//"+b.host);"string"===typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?b.protocol+a:b.host+a),/^(https?|wss?):\/\//.test(a)||(g("protocol-less url %s",a),a="undefined"!==typeof b?b.protocol+"//"+a:"https://"+a),g("parse %s",a),k=e(a));k.port||(/^(http|ws)$/.test(k.protocol)?k.port="80":/^(http|ws)s$/.test(k.protocol)&&(k.port="443"));k.path=k.path||"/";a=-1!==k.host.indexOf(":")?"["+k.host+"]":k.host;k.id=k.protocol+"://"+a+":"+k.port;k.href=k.protocol+
"://"+a+(b&&b.port===k.port?"":":"+k.port);return k}}).call(d,h(1))},function(m,d,h){function e(a){var b=0,e;for(e in a)b=(b<<5)-b+a.charCodeAt(e),b|=0;return d.colors[Math.abs(b)%d.colors.length]}function q(a){function b(){if(b.enabled){var a=+new Date;b.diff=a-(g||a);b.prev=g;g=b.curr=a;for(var e=Array(arguments.length),a=0;a<e.length;a++)e[a]=arguments[a];e[0]=d.coerce(e[0]);"string"!==typeof e[0]&&e.unshift("%O");var n=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(a,f){if("%%"===a)return a;n++;
f=d.formatters[f];"function"===typeof f&&(a=f.call(b,e[n]),e.splice(n,1),n--);return a});d.formatArgs.call(b,e);(b.log||d.log||console.log.bind(console)).apply(b,e)}}b.namespace=a;b.enabled=d.enabled(a);b.useColors=d.useColors();b.color=e(a);"function"===typeof d.init&&d.init(b);return b}d=m.exports=q.debug=q["default"]=q;d.coerce=function(a){return a instanceof Error?a.stack||a.message:a};d.disable=function(){d.enable("")};d.enable=function(a){d.save(a);d.names=[];d.skips=[];for(var b=("string"===
typeof a?a:"").split(/[\s,]+/),e=b.length,p=0;p<e;p++)b[p]&&(a=b[p].replace(/\*/g,".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$")))};d.enabled=function(a){var b;var e=0;for(b=d.skips.length;e<b;e++)if(d.skips[e].test(a))return!1;e=0;for(b=d.names.length;e<b;e++)if(d.names[e].test(a))return!0;return!1};d.humanize=h(13);d.names=[];d.skips=[];d.formatters={};var g},function(m,d,h){(function(e){function q(){try{var a=d.storage.debug}catch(k){}!a&&"undefined"!==
typeof e&&"env"in e&&(a=e.env.DEBUG);return a}d=m.exports=h(47);d.log=function(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};d.formatArgs=function(a){var b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+d.humanize(this.diff);if(b){b="color: "+this.color;a.splice(1,0,b,"color: inherit");var e=0,n=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(n=e))});a.splice(n,0,b)}};d.save=function(a){try{null==
a?d.storage.removeItem("debug"):d.storage.debug=a}catch(k){}};d.load=q;d.useColors=function(){return"undefined"!==typeof window&&window.process&&"renderer"===window.process.type?!0:"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||
window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var g=d;if("undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage)var a=chrome.storage.local;else a:{try{a=window.localStorage;break a}catch(b){}a=void 0}g.storage=a;d.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" ");
d.formatters.j=function(a){try{return JSON.stringify(a)}catch(k){return"[UnexpectedJSONParseError]: "+k.message}};d.enable(q())}).call(d,h(12))},function(m,d,h){function e(a){var b=0,e;for(e in a)b=(b<<5)-b+a.charCodeAt(e),b|=0;return d.colors[Math.abs(b)%d.colors.length]}function q(a){function b(){if(b.enabled){var a=+new Date;b.diff=a-(k||a);b.prev=k;k=b.curr=a;for(var e=Array(arguments.length),a=0;a<e.length;a++)e[a]=arguments[a];e[0]=d.coerce(e[0]);"string"!==typeof e[0]&&e.unshift("%O");var l=
0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(a,c){if("%%"===a)return a;l++;c=d.formatters[c];"function"===typeof c&&(a=c.call(b,e[l]),e.splice(l,1),l--);return a});d.formatArgs.call(b,e);(b.log||d.log||console.log.bind(console)).apply(b,e)}}var k;b.namespace=a;b.enabled=d.enabled(a);b.useColors=d.useColors();b.color=e(a);b.destroy=g;"function"===typeof d.init&&d.init(b);d.instances.push(b);return b}function g(){var a=d.instances.indexOf(this);return-1!==a?(d.instances.splice(a,1),!0):!1}d=m.exports=
q.debug=q["default"]=q;d.coerce=function(a){return a instanceof Error?a.stack||a.message:a};d.disable=function(){d.enable("")};d.enable=function(a){d.save(a);d.names=[];d.skips=[];var b,e=("string"===typeof a?a:"").split(/[\s,]+/),p=e.length;for(b=0;b<p;b++)e[b]&&(a=e[b].replace(/\*/g,".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$")));for(b=0;b<d.instances.length;b++)a=d.instances[b],a.enabled=d.enabled(a.namespace)};d.enabled=function(a){if("*"===
a[a.length-1])return!0;var b;var e=0;for(b=d.skips.length;e<b;e++)if(d.skips[e].test(a))return!1;e=0;for(b=d.names.length;e<b;e++)if(d.names[e].test(a))return!0;return!1};d.humanize=h(13);d.instances=[];d.names=[];d.skips=[];d.formatters={}},function(m,d,h){(function(e){function q(){try{var a=new Uint8Array(1);a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===a.foo()&&"function"===typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(L){return!1}}function g(c,b){if((a.TYPED_ARRAY_SUPPORT?
2147483647:1073741823)<b)throw new RangeError("Invalid typed array length");a.TYPED_ARRAY_SUPPORT?(c=new Uint8Array(b),c.__proto__=a.prototype):(null===c&&(c=new a(b)),c.length=b);return c}function a(c,f,e){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(c,f,e);if("number"===typeof c){if("string"===typeof f)throw Error("If encoding is specified then the first argument must be a string");return p(this,c)}return b(this,c,f,e)}function b(b,f,e,d){if("number"===typeof f)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&f instanceof ArrayBuffer){f.byteLength;if(0>e||f.byteLength<e)throw new RangeError("'offset' is out of bounds");if(f.byteLength<e+(d||0))throw new RangeError("'length' is out of bounds");f=void 0===e&&void 0===d?new Uint8Array(f):void 0===d?new Uint8Array(f,e):new Uint8Array(f,e,d);a.TYPED_ARRAY_SUPPORT?(b=f,b.__proto__=a.prototype):b=n(b,f);return b}if("string"===typeof f){d=b;b=e;if("string"!==typeof b||""===b)b="utf8";if(!a.isEncoding(b))throw new TypeError('"encoding" must be a valid string encoding');
e=c(f,b)|0;d=g(d,e);f=d.write(f,b);f!==e&&(d=d.slice(0,f));return d}return l(b,f)}function k(a){if("number"!==typeof a)throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative');}function p(c,b){k(b);c=g(c,0>b?0:f(b)|0);if(!a.TYPED_ARRAY_SUPPORT)for(var e=0;e<b;++e)c[e]=0;return c}function n(a,c){var b=0>c.length?0:f(c.length)|0;a=g(a,b);for(var e=0;e<b;e+=1)a[e]=c[e]&255;return a}function l(c,b){if(a.isBuffer(b)){var e=f(b.length)|
0;c=g(c,e);if(0===c.length)return c;b.copy(c,0,0,e);return c}if(b){if("undefined"!==typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return(e="number"!==typeof b.length)||(e=b.length,e=e!==e),e?g(c,0):n(c,b);if("Buffer"===b.type&&N(b.data))return n(c,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function f(c){if(c>=(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+
(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return c|0}function c(c,b){if(a.isBuffer(c))return c.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(c)||c instanceof ArrayBuffer))return c.byteLength;"string"!==typeof c&&(c=""+c);var f=c.length;if(0===f)return 0;for(var e=!1;;)switch(b){case "ascii":case "latin1":case "binary":return f;case "utf8":case "utf-8":case void 0:return C(c).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
f;case "hex":return f>>>1;case "base64":return H.toByteArray(I(c)).length;default:if(e)return C(c).length;b=(""+b).toLowerCase();e=!0}}function r(a,c,b){var f=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";for(a||(a="utf8");;)switch(a){case "hex":a=c;c=b;b=this.length;if(!a||0>a)a=0;if(!c||0>c||c>b)c=b;f="";for(b=a;b<c;++b)a=f,f=this[b],f=16>f?"0"+f.toString(16):f.toString(16),f=a+f;return f;case "utf8":case "utf-8":return B(this,
c,b);case "ascii":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]&127);return a;case "latin1":case "binary":a="";for(b=Math.min(this.length,b);c<b;++c)a+=String.fromCharCode(this[c]);return a;case "base64":return c=0===c&&b===this.length?H.fromByteArray(this):H.fromByteArray(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(c,b);b="";for(a=0;a<c.length;a+=2)b+=String.fromCharCode(c[a]+256*c[a+1]);return b;default:if(f)throw new TypeError("Unknown encoding: "+
a);a=(a+"").toLowerCase();f=!0}}function u(a,c,b){var f=a[c];a[c]=a[b];a[b]=f}function m(c,b,f,e,d){if(0===c.length)return-1;"string"===typeof f?(e=f,f=0):2147483647<f?f=2147483647:-2147483648>f&&(f=-2147483648);f=+f;isNaN(f)&&(f=d?0:c.length-1);0>f&&(f=c.length+f);if(f>=c.length){if(d)return-1;f=c.length-1}else if(0>f)if(d)f=0;else return-1;"string"===typeof b&&(b=a.from(b,e));if(a.isBuffer(b))return 0===b.length?-1:A(c,b,f,e,d);if("number"===typeof b)return b&=255,a.TYPED_ARRAY_SUPPORT&&"function"===
typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(c,b,f):Uint8Array.prototype.lastIndexOf.call(c,b,f):A(c,[b],f,e,d);throw new TypeError("val must be string, number or Buffer");}function A(a,c,b,f,e){function d(a,c){return 1===l?a[c]:a.readUInt16BE(c*l)}var l=1,k=a.length,p=c.length;if(void 0!==f&&(f=String(f).toLowerCase(),"ucs2"===f||"ucs-2"===f||"utf16le"===f||"utf-16le"===f)){if(2>a.length||2>c.length)return-1;l=2;k/=2;p/=2;b/=2}if(e)for(f=-1;b<k;b++)if(d(a,b)===d(c,-1===
f?0:b-f)){if(-1===f&&(f=b),b-f+1===p)return f*l}else-1!==f&&(b-=b-f),f=-1;else for(b+p>k&&(b=k-p);0<=b;b--){k=!0;for(f=0;f<p;f++)if(d(a,b+f)!==d(c,f)){k=!1;break}if(k)return b}return-1}function B(a,c,b){b=Math.min(a.length,b);for(var f=[];c<b;){var e=a[c],d=null,l=239<e?4:223<e?3:191<e?2:1;if(c+l<=b)switch(l){case 1:128>e&&(d=e);break;case 2:var k=a[c+1];128===(k&192)&&(e=(e&31)<<6|k&63,127<e&&(d=e));break;case 3:k=a[c+1];var p=a[c+2];128===(k&192)&&128===(p&192)&&(e=(e&15)<<12|(k&63)<<6|p&63,2047<
e&&(55296>e||57343<e)&&(d=e));break;case 4:k=a[c+1];p=a[c+2];var g=a[c+3];128===(k&192)&&128===(p&192)&&128===(g&192)&&(e=(e&15)<<18|(k&63)<<12|(p&63)<<6|g&63,65535<e&&1114112>e&&(d=e))}null===d?(d=65533,l=1):65535<d&&(d-=65536,f.push(d>>>10&1023|55296),d=56320|d&1023);f.push(d);c+=l}a=f.length;if(a<=K)f=String.fromCharCode.apply(String,f);else{b="";for(c=0;c<a;)b+=String.fromCharCode.apply(String,f.slice(c,c+=K));f=b}return f}function v(a,c,b){if(0!==a%1||0>a)throw new RangeError("offset is not uint");
if(a+c>b)throw new RangeError("Trying to access beyond buffer length");}function t(c,b,f,e,d,l){if(!a.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>d||b<l)throw new RangeError('"value" argument is out of bounds');if(f+e>c.length)throw new RangeError("Index out of range");}function x(a,c,b,f){0>c&&(c=65535+c+1);for(var e=0,d=Math.min(a.length-b,2);e<d;++e)a[b+e]=(c&255<<8*(f?e:1-e))>>>8*(f?e:1-e)}function z(a,c,b,f){0>c&&(c=4294967295+c+1);for(var e=0,d=Math.min(a.length-
b,4);e<d;++e)a[b+e]=c>>>8*(f?e:3-e)&255}function F(a,c,b,f,e,d){if(b+f>a.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function D(a,c,b,f,e){e||F(a,c,b,4,3.4028234663852886e+38,-3.4028234663852886e+38);J.write(a,c,b,f,23,4);return b+4}function E(a,c,b,f,e){e||F(a,c,b,8,1.7976931348623157e+308,-1.7976931348623157e+308);J.write(a,c,b,f,52,8);return b+8}function I(a){a=a.trim?a.trim():a.replace(/^\s+|\s+$/g,"");a=a.replace(O,"");if(2>a.length)return"";
for(;0!==a.length%4;)a+="\x3d";return a}function C(a,c){c=c||Infinity;for(var b,f=a.length,e=null,d=[],l=0;l<f;++l){b=a.charCodeAt(l);if(55295<b&&57344>b){if(!e){if(56319<b){-1<(c-=3)&&d.push(239,191,189);continue}else if(l+1===f){-1<(c-=3)&&d.push(239,191,189);continue}e=b;continue}if(56320>b){-1<(c-=3)&&d.push(239,191,189);e=b;continue}b=(e-55296<<10|b-56320)+65536}else e&&-1<(c-=3)&&d.push(239,191,189);e=null;if(128>b){if(0>--c)break;d.push(b)}else if(2048>b){if(0>(c-=2))break;d.push(b>>6|192,
b&63|128)}else if(65536>b){if(0>(c-=3))break;d.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;d.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return d}function M(a){for(var c=[],b=0;b<a.length;++b)c.push(a.charCodeAt(b)&255);return c}function G(a,c,b,f){for(var e=0;e<f&&!(e+b>=c.length||e>=a.length);++e)c[e+b]=a[e];return e}var H=h(49),J=h(50),N=h(51);d.Buffer=a;d.SlowBuffer=function(c){+c!=c&&(c=0);return a.alloc(+c)};d.INSPECT_MAX_BYTES=
50;a.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:q();d.kMaxLength=a.TYPED_ARRAY_SUPPORT?2147483647:1073741823;a.poolSize=8192;a._augment=function(c){c.__proto__=a.prototype;return c};a.from=function(a,c,f){return b(null,a,c,f)};a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&($jscomp.initSymbol(),Object.defineProperty(a,
Symbol.species,{value:null,configurable:!0})));a.alloc=function(a,c,b){k(a);a=0>=a?g(null,a):void 0!==c?"string"===typeof b?g(null,a).fill(c,b):g(null,a).fill(c):g(null,a);return a};a.allocUnsafe=function(a){return p(null,a)};a.allocUnsafeSlow=function(a){return p(null,a)};a.isBuffer=function(a){return!(null==a||!a._isBuffer)};a.compare=function(c,b){if(!a.isBuffer(c)||!a.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(c===b)return 0;for(var f=c.length,e=b.length,d=0,l=Math.min(f,
e);d<l;++d)if(c[d]!==b[d]){f=c[d];e=b[d];break}return f<e?-1:e<f?1:0};a.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};a.concat=function(c,b){if(!N(c))throw new TypeError('"list" argument must be an Array of Buffers');if(0===c.length)return a.alloc(0);var f;if(void 0===b)for(f=b=0;f<c.length;++f)b+=c[f].length;b=a.allocUnsafe(b);
var e=0;for(f=0;f<c.length;++f){var d=c[f];if(!a.isBuffer(d))throw new TypeError('"list" argument must be an Array of Buffers');d.copy(b,e);e+=d.length}return b};a.byteLength=c;a.prototype._isBuffer=!0;a.prototype.swap16=function(){var a=this.length;if(0!==a%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<a;c+=2)u(this,c,c+1);return this};a.prototype.swap32=function(){var a=this.length;if(0!==a%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=
0;c<a;c+=4)u(this,c,c+3),u(this,c+1,c+2);return this};a.prototype.swap64=function(){var a=this.length;if(0!==a%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<a;c+=8)u(this,c,c+7),u(this,c+1,c+6),u(this,c+2,c+5),u(this,c+3,c+4);return this};a.prototype.toString=function(){var a=this.length|0;return 0===a?"":0===arguments.length?B(this,0,a):r.apply(this,arguments)};a.prototype.equals=function(c){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===
c?!0:0===a.compare(this,c)};a.prototype.inspect=function(){var a="",c=d.INSPECT_MAX_BYTES;0<this.length&&(a=this.toString("hex",0,c).match(/.{2}/g).join(" "),this.length>c&&(a+=" ... "));return"\x3cBuffer "+a+"\x3e"};a.prototype.compare=function(c,b,f,e,d){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");void 0===b&&(b=0);void 0===f&&(f=c?c.length:0);void 0===e&&(e=0);void 0===d&&(d=this.length);if(0>b||f>c.length||0>e||d>this.length)throw new RangeError("out of range index");if(e>=
d&&b>=f)return 0;if(e>=d)return-1;if(b>=f)return 1;b>>>=0;f>>>=0;e>>>=0;d>>>=0;if(this===c)return 0;var l=d-e,k=f-b,p=Math.min(l,k);e=this.slice(e,d);c=c.slice(b,f);for(b=0;b<p;++b)if(e[b]!==c[b]){l=e[b];k=c[b];break}return l<k?-1:k<l?1:0};a.prototype.includes=function(a,c,b){return-1!==this.indexOf(a,c,b)};a.prototype.indexOf=function(a,c,b){return m(this,a,c,b,!0)};a.prototype.lastIndexOf=function(a,c,b){return m(this,a,c,b,!1)};a.prototype.write=function(a,c,b,f){if(void 0===c)f="utf8",b=this.length,
c=0;else if(void 0===b&&"string"===typeof c)f=c,b=this.length,c=0;else if(isFinite(c))c|=0,isFinite(b)?(b|=0,void 0===f&&(f="utf8")):(f=b,b=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-c;if(void 0===b||b>e)b=e;if(0<a.length&&(0>b||0>c)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");f||(f="utf8");for(e=!1;;)switch(f){case "hex":a:{c=Number(c)||0;f=this.length-c;b?(b=Number(b),b>f&&(b=f)):b=f;f=a.length;
if(0!==f%2)throw new TypeError("Invalid hex string");b>f/2&&(b=f/2);for(f=0;f<b;++f){e=parseInt(a.substr(2*f,2),16);if(isNaN(e)){a=f;break a}this[c+f]=e}a=f}return a;case "utf8":case "utf-8":return G(C(a,this.length-c),this,c,b);case "ascii":return G(M(a),this,c,b);case "latin1":case "binary":return G(M(a),this,c,b);case "base64":return G(H.toByteArray(I(a)),this,c,b);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":f=a;for(var e=this.length-c,d=[],l=0;l<f.length&&!(0>(e-=2));++l){var k=f.charCodeAt(l);
a=k>>8;k%=256;d.push(k);d.push(a)}return G(d,this,c,b);default:if(e)throw new TypeError("Unknown encoding: "+f);f=(""+f).toLowerCase();e=!0}};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var K=4096;a.prototype.slice=function(c,b){var f=this.length;c=~~c;b=void 0===b?f:~~b;0>c?(c+=f,0>c&&(c=0)):c>f&&(c=f);0>b?(b+=f,0>b&&(b=0)):b>f&&(b=f);b<c&&(b=c);if(a.TYPED_ARRAY_SUPPORT)b=this.subarray(c,b),b.__proto__=a.prototype;else{f=b-c;b=new a(f,void 0);
for(var e=0;e<f;++e)b[e]=this[e+c]}return b};a.prototype.readUIntLE=function(a,c,b){a|=0;c|=0;b||v(a,c,this.length);b=this[a];for(var f=1,e=0;++e<c&&(f*=256);)b+=this[a+e]*f;return b};a.prototype.readUIntBE=function(a,c,b){a|=0;c|=0;b||v(a,c,this.length);b=this[a+--c];for(var f=1;0<c&&(f*=256);)b+=this[a+--c]*f;return b};a.prototype.readUInt8=function(a,c){c||v(a,1,this.length);return this[a]};a.prototype.readUInt16LE=function(a,c){c||v(a,2,this.length);return this[a]|this[a+1]<<8};a.prototype.readUInt16BE=
function(a,c){c||v(a,2,this.length);return this[a]<<8|this[a+1]};a.prototype.readUInt32LE=function(a,c){c||v(a,4,this.length);return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};a.prototype.readUInt32BE=function(a,c){c||v(a,4,this.length);return 16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])};a.prototype.readIntLE=function(a,c,b){a|=0;c|=0;b||v(a,c,this.length);b=this[a];for(var f=1,e=0;++e<c&&(f*=256);)b+=this[a+e]*f;b>=128*f&&(b-=Math.pow(2,8*c));return b};a.prototype.readIntBE=
function(a,c,b){a|=0;c|=0;b||v(a,c,this.length);b=c;for(var f=1,e=this[a+--b];0<b&&(f*=256);)e+=this[a+--b]*f;e>=128*f&&(e-=Math.pow(2,8*c));return e};a.prototype.readInt8=function(a,c){c||v(a,1,this.length);return this[a]&128?-1*(255-this[a]+1):this[a]};a.prototype.readInt16LE=function(a,c){c||v(a,2,this.length);a=this[a]|this[a+1]<<8;return a&32768?a|4294901760:a};a.prototype.readInt16BE=function(a,c){c||v(a,2,this.length);a=this[a+1]|this[a]<<8;return a&32768?a|4294901760:a};a.prototype.readInt32LE=
function(a,c){c||v(a,4,this.length);return this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};a.prototype.readInt32BE=function(a,c){c||v(a,4,this.length);return this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};a.prototype.readFloatLE=function(a,c){c||v(a,4,this.length);return J.read(this,a,!0,23,4)};a.prototype.readFloatBE=function(a,c){c||v(a,4,this.length);return J.read(this,a,!1,23,4)};a.prototype.readDoubleLE=function(a,c){c||v(a,8,this.length);return J.read(this,a,!0,52,8)};a.prototype.readDoubleBE=
function(a,c){c||v(a,8,this.length);return J.read(this,a,!1,52,8)};a.prototype.writeUIntLE=function(a,c,b,f){a=+a;c|=0;b|=0;f||t(this,a,c,b,Math.pow(2,8*b)-1,0);f=1;var e=0;for(this[c]=a&255;++e<b&&(f*=256);)this[c+e]=a/f&255;return c+b};a.prototype.writeUIntBE=function(a,c,b,f){a=+a;c|=0;b|=0;f||t(this,a,c,b,Math.pow(2,8*b)-1,0);f=b-1;var e=1;for(this[c+f]=a&255;0<=--f&&(e*=256);)this[c+f]=a/e&255;return c+b};a.prototype.writeUInt8=function(c,b,f){c=+c;b|=0;f||t(this,c,b,1,255,0);a.TYPED_ARRAY_SUPPORT||
(c=Math.floor(c));this[b]=c&255;return b+1};a.prototype.writeUInt16LE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):x(this,c,b,!0);return b+2};a.prototype.writeUInt16BE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):x(this,c,b,!1);return b+2};a.prototype.writeUInt32LE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[b+3]=c>>>24,this[b+2]=c>>>16,this[b+
1]=c>>>8,this[b]=c&255):z(this,c,b,!0);return b+4};a.prototype.writeUInt32BE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):z(this,c,b,!1);return b+4};a.prototype.writeIntLE=function(a,c,b,f){a=+a;c|=0;f||(f=Math.pow(2,8*b-1),t(this,a,c,b,f-1,-f));f=0;var e=1,d=0;for(this[c]=a&255;++f<b&&(e*=256);)0>a&&0===d&&0!==this[c+f-1]&&(d=1),this[c+f]=(a/e>>0)-d&255;return c+b};a.prototype.writeIntBE=function(a,
c,b,f){a=+a;c|=0;f||(f=Math.pow(2,8*b-1),t(this,a,c,b,f-1,-f));f=b-1;var e=1,d=0;for(this[c+f]=a&255;0<=--f&&(e*=256);)0>a&&0===d&&0!==this[c+f+1]&&(d=1),this[c+f]=(a/e>>0)-d&255;return c+b};a.prototype.writeInt8=function(c,b,f){c=+c;b|=0;f||t(this,c,b,1,127,-128);a.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));0>c&&(c=255+c+1);this[b]=c&255;return b+1};a.prototype.writeInt16LE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):x(this,c,b,!0);return b+
2};a.prototype.writeInt16BE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):x(this,c,b,!1);return b+2};a.prototype.writeInt32LE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,4,2147483647,-2147483648);a.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8,this[b+2]=c>>>16,this[b+3]=c>>>24):z(this,c,b,!0);return b+4};a.prototype.writeInt32BE=function(c,b,f){c=+c;b|=0;f||t(this,c,b,4,2147483647,-2147483648);0>c&&(c=4294967295+c+1);a.TYPED_ARRAY_SUPPORT?
(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):z(this,c,b,!1);return b+4};a.prototype.writeFloatLE=function(a,c,b){return D(this,a,c,!0,b)};a.prototype.writeFloatBE=function(a,c,b){return D(this,a,c,!1,b)};a.prototype.writeDoubleLE=function(a,c,b){return E(this,a,c,!0,b)};a.prototype.writeDoubleBE=function(a,c,b){return E(this,a,c,!1,b)};a.prototype.copy=function(c,b,f,e){f||(f=0);e||0===e||(e=this.length);b>=c.length&&(b=c.length);b||(b=0);0<e&&e<f&&(e=f);if(e===f||0===c.length||
0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>f||f>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length);c.length-b<e-f&&(e=c.length-b+f);var d=e-f;if(this===c&&f<b&&b<e)for(e=d-1;0<=e;--e)c[e+b]=this[e+f];else if(1E3>d||!a.TYPED_ARRAY_SUPPORT)for(e=0;e<d;++e)c[e+b]=this[e+f];else Uint8Array.prototype.set.call(c,this.subarray(f,f+d),b);return d};a.prototype.fill=
function(c,b,f,e){if("string"===typeof c){"string"===typeof b?(e=b,b=0,f=this.length):"string"===typeof f&&(e=f,f=this.length);if(1===c.length){var d=c.charCodeAt(0);256>d&&(c=d)}if(void 0!==e&&"string"!==typeof e)throw new TypeError("encoding must be a string");if("string"===typeof e&&!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);}else"number"===typeof c&&(c&=255);if(0>b||this.length<b||this.length<f)throw new RangeError("Out of range index");if(f<=b)return this;b>>>=0;f=void 0===
f?this.length:f>>>0;c||(c=0);if("number"===typeof c)for(e=b;e<f;++e)this[e]=c;else for(c=a.isBuffer(c)?c:C((new a(c,e)).toString()),d=c.length,e=0;e<f-b;++e)this[e+b]=c[e%d];return this};var O=/[^+\/0-9A-Za-z-_]/g}).call(d,h(1))},function(m,d,h){function e(a){var b=a.length;if(0<b%4)throw Error("Invalid string. Length must be a multiple of 4");a=a.indexOf("\x3d");-1===a&&(a=b);return[a,a===b?0:4-a%4]}function q(a,b,e){for(var d=[],f=b;f<e;f+=3)b=(a[f]<<16&16711680)+(a[f+1]<<8&65280)+(a[f+2]&255),
d.push(g[b>>18&63]+g[b>>12&63]+g[b>>6&63]+g[b&63]);return d.join("")}d.byteLength=function(a){a=e(a);var b=a[1];return 3*(a[0]+b)/4-b};d.toByteArray=function(d){var k=e(d);var g=k[0];var k=k[1],l=new b(3*(g+k)/4-k),f=0,c=0<k?g-4:g,h;for(h=0;h<c;h+=4)g=a[d.charCodeAt(h)]<<18|a[d.charCodeAt(h+1)]<<12|a[d.charCodeAt(h+2)]<<6|a[d.charCodeAt(h+3)],l[f++]=g>>16&255,l[f++]=g>>8&255,l[f++]=g&255;2===k&&(g=a[d.charCodeAt(h)]<<2|a[d.charCodeAt(h+1)]>>4,l[f++]=g&255);1===k&&(g=a[d.charCodeAt(h)]<<10|a[d.charCodeAt(h+
1)]<<4|a[d.charCodeAt(h+2)]>>2,l[f++]=g>>8&255,l[f++]=g&255);return l};d.fromByteArray=function(a){for(var b=a.length,e=b%3,d=[],f=0,c=b-e;f<c;f+=16383)d.push(q(a,f,f+16383>c?c:f+16383));1===e?(a=a[b-1],d.push(g[a>>2]+g[a<<4&63]+"\x3d\x3d")):2===e&&(a=(a[b-2]<<8)+a[b-1],d.push(g[a>>10]+g[a>>4&63]+g[a<<2&63]+"\x3d"));return d.join("")};var g=[],a=[],b="undefined"!==typeof Uint8Array?Uint8Array:Array;for(m=0;64>m;++m)g[m]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m],a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(m)]=
m;a[45]=62;a[95]=63},function(m,d){d.read=function(d,e,q,g,a){var b=8*a-g-1;var k=(1<<b)-1,p=k>>1,n=-7;a=q?a-1:0;var l=q?-1:1,f=d[e+a];a+=l;q=f&(1<<-n)-1;f>>=-n;for(n+=b;0<n;q=256*q+d[e+a],a+=l,n-=8);b=q&(1<<-n)-1;q>>=-n;for(n+=g;0<n;b=256*b+d[e+a],a+=l,n-=8);if(0===q)q=1-p;else{if(q===k)return b?NaN:Infinity*(f?-1:1);b+=Math.pow(2,g);q-=p}return(f?-1:1)*b*Math.pow(2,q-g)};d.write=function(d,e,q,g,a,b){var k,p=8*b-a-1,n=(1<<p)-1,l=n>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0;b=g?0:b-1;var c=g?
1:-1,h=0>e||0===e&&0>1/e?1:0;e=Math.abs(e);isNaN(e)||Infinity===e?(e=isNaN(e)?1:0,g=n):(g=Math.floor(Math.log(e)/Math.LN2),1>e*(k=Math.pow(2,-g))&&(g--,k*=2),e=1<=g+l?e+f/k:e+f*Math.pow(2,1-l),2<=e*k&&(g++,k/=2),g+l>=n?(e=0,g=n):1<=g+l?(e=(e*k-1)*Math.pow(2,a),g+=l):(e=e*Math.pow(2,l-1)*Math.pow(2,a),g=0));for(;8<=a;d[q+b]=e&255,b+=c,e/=256,a-=8);g=g<<a|e;for(p+=a;0<p;d[q+b]=g&255,b+=c,g/=256,p-=8);d[q+b-c]|=128*h}},function(m,d){var h={}.toString;m.exports=Array.isArray||function(e){return"[object Array]"==
h.call(e)}},function(m,d){var h={}.toString;m.exports=Array.isArray||function(e){return"[object Array]"==h.call(e)}},function(m,d,h){(function(e){function q(e,f){if(!e)return e;if(b(e)){var c={_placeholder:!0,num:f.length};f.push(e);return c}if(a(e)){c=Array(e.length);for(var d=0;d<e.length;d++)c[d]=q(e[d],f);return c}if("object"===typeof e&&!(e instanceof Date)){c={};for(d in e)c[d]=q(e[d],f);return c}return e}function g(b,f){if(!b)return b;if(b&&b._placeholder)return f[b.num];if(a(b))for(var c=
0;c<b.length;c++)b[c]=g(b[c],f);else if("object"===typeof b)for(c in b)b[c]=g(b[c],f);return b}var a=h(22),b=h(23),k=Object.prototype.toString,p="function"===typeof e.Blob||"[object BlobConstructor]"===k.call(e.Blob),n="function"===typeof e.File||"[object FileConstructor]"===k.call(e.File);d.deconstructPacket=function(a){var b=[];a.data=q(a.data,b);a.attachments=b.length;return{packet:a,buffers:b}};d.reconstructPacket=function(a,b){a.data=g(a.data,b);a.attachments=void 0;return a};d.removeBlobs=function(e,
f){function c(e,k,g){if(!e)return e;if(p&&e instanceof Blob||n&&e instanceof File){d++;var h=new FileReader;h.onload=function(){g?g[k]=this.result:l=this.result;--d||f(l)};h.readAsArrayBuffer(e)}else if(a(e))for(h=0;h<e.length;h++)c(e[h],h,e);else if("object"===typeof e&&!b(e))for(h in e)c(e[h],h,e)}var d=0,l=e;c(l);d||f(l)}}).call(d,h(1))},function(m,d,h){m.exports=h(55);m.exports.parser=h(4)},function(m,d,h){(function(e){function d(a,c){if(!(this instanceof d))return new d(a,c);c=c||{};a&&"object"===
typeof a&&(c=a,a=null);a?(a=n(a),c.hostname=a.host,c.secure="https"===a.protocol||"wss"===a.protocol,c.port=a.port,a.query&&(c.query=a.query)):c.host&&(c.hostname=n(c.host).host);this.secure=null!=c.secure?c.secure:e.location&&"https:"===location.protocol;c.hostname&&!c.port&&(c.port=this.secure?"443":"80");this.agent=c.agent||!1;this.hostname=c.hostname||(e.location?location.hostname:"localhost");this.port=c.port||(e.location&&location.port?location.port:this.secure?443:80);this.query=c.query||{};
"string"===typeof this.query&&(this.query=l.decode(this.query));this.upgrade=!1!==c.upgrade;this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!c.forceJSONP;this.jsonp=!1!==c.jsonp;this.forceBase64=!!c.forceBase64;this.enablesXDR=!!c.enablesXDR;this.timestampParam=c.timestampParam||"t";this.timestampRequests=c.timestampRequests;this.transports=c.transports||["polling","websocket"];this.transportOptions=c.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=
0;this.policyPort=c.policyPort||843;this.rememberUpgrade=c.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=c.onlyBinaryUpgrades;this.perMessageDeflate=!1!==c.perMessageDeflate?c.perMessageDeflate||{}:!1;!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024);this.pfx=c.pfx||null;this.key=c.key||null;this.passphrase=c.passphrase||null;this.cert=c.cert||null;this.ca=c.ca||null;this.ciphers=
c.ciphers||null;this.rejectUnauthorized=void 0===c.rejectUnauthorized?!0:c.rejectUnauthorized;this.forceNode=!!c.forceNode;a="object"===typeof e&&e;a.global===a&&(c.extraHeaders&&0<Object.keys(c.extraHeaders).length&&(this.extraHeaders=c.extraHeaders),c.localAddress&&(this.localAddress=c.localAddress));this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null;this.open()}var g=h(25),a=h(3),b=h(8)("engine.io-client:socket"),k=h(28),p=h(4),n=h(20),l=
h(6);m.exports=d;d.priorWebsocketSuccess=!1;a(d.prototype);d.protocol=p.protocol;d.Socket=d;d.Transport=h(16);d.transports=h(25);d.parser=h(4);d.prototype.createTransport=function(a){b('creating transport "%s"',a);var c=this.query,f={},e;for(e in c)c.hasOwnProperty(e)&&(f[e]=c[e]);f.EIO=p.protocol;f.transport=a;c=this.transportOptions[a]||{};this.id&&(f.sid=this.id);return new g[a]({query:f,socket:this,agent:c.agent||this.agent,hostname:c.hostname||this.hostname,port:c.port||this.port,secure:c.secure||
this.secure,path:c.path||this.path,forceJSONP:c.forceJSONP||this.forceJSONP,jsonp:c.jsonp||this.jsonp,forceBase64:c.forceBase64||this.forceBase64,enablesXDR:c.enablesXDR||this.enablesXDR,timestampRequests:c.timestampRequests||this.timestampRequests,timestampParam:c.timestampParam||this.timestampParam,policyPort:c.policyPort||this.policyPort,pfx:c.pfx||this.pfx,key:c.key||this.key,passphrase:c.passphrase||this.passphrase,cert:c.cert||this.cert,ca:c.ca||this.ca,ciphers:c.ciphers||this.ciphers,rejectUnauthorized:c.rejectUnauthorized||
this.rejectUnauthorized,perMessageDeflate:c.perMessageDeflate||this.perMessageDeflate,extraHeaders:c.extraHeaders||this.extraHeaders,forceNode:c.forceNode||this.forceNode,localAddress:c.localAddress||this.localAddress,requestTimeout:c.requestTimeout||this.requestTimeout,protocols:c.protocols||void 0})};d.prototype.open=function(){if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var c=this;setTimeout(function(){c.emit("error",
"No transports available")},0);return}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(r){this.transports.shift();this.open();return}a.open();this.setTransport(a)};d.prototype.setTransport=function(a){b("setting transport %s",a.name);var c=this;this.transport&&(b("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){c.onDrain()}).on("packet",function(a){c.onPacket(a)}).on("error",function(a){c.onError(a)}).on("close",
function(){c.onClose("transport close")})};d.prototype.probe=function(a){function c(){if(q.onlyBinaryUpgrades){var c=!this.supportsBinary&&q.transport.supportsBinary;h=h||c}h||(b('probe transport "%s" opened',a),n.send([{type:"ping",data:"probe"}]),n.once("packet",function(c){h||("pong"===c.type&&"probe"===c.data?(b('probe transport "%s" pong',a),q.upgrading=!0,q.emit("upgrading",n),n&&(d.priorWebsocketSuccess="websocket"===n.name,b('pausing current transport "%s"',q.transport.name),q.transport.pause(function(){h||
"closed"===q.readyState||(b("changing transport and sending upgrade packet"),g(),q.setTransport(n),n.send([{type:"upgrade"}]),q.emit("upgrade",n),n=null,q.upgrading=!1,q.flush())}))):(b('probe transport "%s" failed',a),c=Error("probe error"),c.transport=n.name,q.emit("upgradeError",c)))}))}function f(){h||(h=!0,g(),n.close(),n=null)}function e(c){var e=Error("probe error: "+c);e.transport=n.name;f();b('probe transport "%s" failed because of error: %s',a,c);q.emit("upgradeError",e)}function l(){e("transport closed")}
function k(){e("socket closed")}function p(a){n&&a.name!==n.name&&(b('"%s" works - aborting "%s"',a.name,n.name),f())}function g(){n.removeListener("open",c);n.removeListener("error",e);n.removeListener("close",l);q.removeListener("close",k);q.removeListener("upgrading",p)}b('probing transport "%s"',a);var n=this.createTransport(a,{probe:1}),h=!1,q=this;d.priorWebsocketSuccess=!1;n.once("open",c);n.once("error",e);n.once("close",l);this.once("close",k);this.once("upgrading",p);n.open()};d.prototype.onOpen=
function(){b("socket open");this.readyState="open";d.priorWebsocketSuccess="websocket"===this.transport.name;this.emit("open");this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){b("starting upgrade probes");for(var a=0,c=this.upgrades.length;a<c;a++)this.probe(this.upgrades[a])}};d.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(b('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",
a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(JSON.parse(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var c=Error("server error");c.code=a.data;this.onError(c);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else b('packet received with socket readyState "%s"',this.readyState)};d.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);
this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var c=this;c.pingTimeoutTimer=setTimeout(function(){if("closed"!==c.readyState)c.onClose("ping timeout")},a||c.pingInterval+c.pingTimeout)};d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=
setTimeout(function(){b("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};d.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&
(b("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};d.prototype.write=d.prototype.send=function(a,c,b){this.sendPacket("message",a,c,b);return this};d.prototype.sendPacket=function(a,c,b,e){"function"===typeof c&&(e=c,c=void 0);"function"===typeof b&&(e=b,b=null);if("closing"!==this.readyState&&"closed"!==this.readyState){b=b||{};b.compress=!1!==b.compress;a={type:a,data:c,options:b};this.emit("packetCreate",
a);this.writeBuffer.push(a);if(e)this.once("flush",e);this.flush()}};d.prototype.close=function(){function a(){d.onClose("forced close");b("socket closing - telling transport to close");d.transport.close()}function c(){d.removeListener("upgrade",c);d.removeListener("upgradeError",c);a()}function e(){d.once("upgrade",c);d.once("upgradeError",c)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var d=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?
e():a()});else this.upgrading?e():a()}return this};d.prototype.onError=function(a){b("socket error %j",a);d.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};d.prototype.onClose=function(a,c){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)b('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),
this.readyState="closed",this.id=null,this.emit("close",a,c),this.writeBuffer=[],this.prevBufferLen=0};d.prototype.filterUpgrades=function(a){for(var c=[],b=0,f=a.length;b<f;b++)~k(this.transports,a[b])&&c.push(a[b]);return c}}).call(d,h(1))},function(m,d){try{m.exports="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(h){m.exports=!1}},function(m,d,h){(function(e){function d(){}function g(a){p.call(this,a);this.requestTimeout=a.requestTimeout;this.extraHeaders=a.extraHeaders;
if(e.location){var c="https:"===location.protocol,b=location.port;b||(b=c?443:80);this.xd=a.hostname!==e.location.hostname||b!==a.port;this.xs=a.secure!==c}}function a(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;
this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function b(){for(var c in a.requests)a.requests.hasOwnProperty(c)&&a.requests[c].abort()}var k=h(15),p=h(26),n=h(3),l=h(7),f=h(8)("engine.io-client:polling-xhr");m.exports=g;m.exports.Request=a;l(g,p);g.prototype.supportsBinary=!0;g.prototype.request=function(c){c=c||{};c.uri=this.uri();c.xd=this.xd;c.xs=this.xs;c.agent=this.agent||!1;c.supportsBinary=this.supportsBinary;
c.enablesXDR=this.enablesXDR;c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;c.requestTimeout=this.requestTimeout;c.extraHeaders=this.extraHeaders;return new a(c)};g.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};g.prototype.doPoll=
function(){f("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};n(a.prototype);a.prototype.create=function(){var c={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new k(c),d=this;try{f("xhr open %s: %s",
this.method,this.uri);b.open(this.method,this.uri,this.async);try{if(this.extraHeaders){b.setDisableHeaderCheck&&b.setDisableHeaderCheck(!0);for(var l in this.extraHeaders)this.extraHeaders.hasOwnProperty(l)&&b.setRequestHeader(l,this.extraHeaders[l])}}catch(A){}if("POST"===this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset\x3dUTF-8")}catch(A){}try{b.setRequestHeader("Accept","*/*")}catch(A){}"withCredentials"in
b&&(b.withCredentials=!0);this.requestTimeout&&(b.timeout=this.requestTimeout);this.hasXDR()?(b.onload=function(){d.onLoad()},b.onerror=function(){d.onError(b.responseText)}):b.onreadystatechange=function(){if(2===b.readyState)try{var a=b.getResponseHeader("Content-Type");d.supportsBinary&&"application/octet-stream"===a&&(b.responseType="arraybuffer")}catch(B){}if(4===b.readyState)if(200===b.status||1223===b.status)d.onLoad();else setTimeout(function(){d.onError(b.status)},0)};f("xhr data %s",this.data);
b.send(this.data)}catch(A){setTimeout(function(){d.onError(A)},0);return}e.document&&(this.index=a.requestsCount++,a.requests[this.index]=this)};a.prototype.onSuccess=function(){this.emit("success");this.cleanup()};a.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};a.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};a.prototype.cleanup=function(c){if("undefined"!==typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=
d;if(c)try{this.xhr.abort()}catch(r){}e.document&&delete a.requests[this.index];this.xhr=null}};a.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(u){}var b="application/octet-stream"===a?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(u){this.onError(u)}if(null!=b)this.onData(b)};a.prototype.hasXDR=function(){return"undefined"!==typeof e.XDomainRequest&&!this.xs&&this.enablesXDR};a.prototype.abort=function(){this.cleanup()};a.requestsCount=
0;a.requests={};e.document&&(e.attachEvent?e.attachEvent("onunload",b):e.addEventListener&&e.addEventListener("beforeunload",b,!1))}).call(d,h(1))},function(m,d){m.exports=Object.keys||function(d){var e=[],h=Object.prototype.hasOwnProperty,g;for(g in d)h.call(d,g)&&e.push(g);return e}},function(m,d){m.exports=function(d,e,q){var g=d.byteLength;e=e||0;q=q||g;if(d.slice)return d.slice(e,q);0>e&&(e+=g);0>q&&(q+=g);q>g&&(q=g);if(e>=g||e>=q||0===g)return new ArrayBuffer(0);d=new Uint8Array(d);for(var g=
new Uint8Array(q-e),a=0;e<q;e++,a++)g[a]=d[e];return g.buffer}},function(m,d){function h(){}m.exports=function(e,d,g){function a(e,p){if(0>=a.count)throw Error("after called too many times");--a.count;e?(b=!0,d(e),d=g):0!==a.count||b||d(null,p)}var b=!1;g=g||h;a.count=e;return 0===e?d():a}},function(m,d){function h(a){for(var b=[],f=0,c=a.length,e,d;f<c;)e=a.charCodeAt(f++),55296<=e&&56319>=e&&f<c?(d=a.charCodeAt(f++),56320==(d&64512)?b.push(((e&1023)<<10)+(d&1023)+65536):(b.push(e),f--)):b.push(e);
return b}function e(a,b){if(55296<=a&&57343>=a){if(b)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function q(){if(p>=k)throw Error("Invalid byte index");var a=b[p]&255;p++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function g(a){if(p>k)throw Error("Invalid byte index");if(p==k)return!1;var d=b[p]&255;p++;if(0==(d&128))return d;if(192==(d&224)){var f=q();d=(d&31)<<6|f;if(128<=d)return d;throw Error("Invalid continuation byte");
}if(224==(d&240)){f=q();var c=q();d=(d&15)<<12|f<<6|c;if(2048<=d)return e(d,a)?d:65533;throw Error("Invalid continuation byte");}if(240==(d&248)&&(f=q(),c=q(),a=q(),d=(d&7)<<18|f<<12|c<<6|a,65536<=d&&1114111>=d))return d;throw Error("Invalid UTF-8 detected");}var a=String.fromCharCode,b,k,p;m.exports={version:"2.1.2",encode:function(b,d){d=d||{};d=!1!==d.strict;b=h(b);for(var f=b.length,c=-1,l,k="";++c<f;){l=b[c];var p=d;if(0==(l&4294967168))l=a(l);else{var g="";0==(l&4294965248)?g=a(l>>6&31|192):
0==(l&4294901760)?(e(l,p)||(l=65533),g=a(l>>12&15|224),g+=a(l>>6&63|128)):0==(l&4292870144)&&(g=a(l>>18&7|240),g+=a(l>>12&63|128),g+=a(l>>6&63|128));l=g+=a(l&63|128)}k+=l}return k},decode:function(e,d){d=d||{};d=!1!==d.strict;b=h(e);k=b.length;p=0;e=[];for(var f;!1!==(f=g(d));)e.push(f);d=e.length;f=-1;for(var c,l="";++f<d;)c=e[f],65535<c&&(c-=65536,l+=a(c>>>10&1023|55296),c=56320|c&1023),l+=a(c);return l}}},function(m,d){(function(){for(var h=new Uint8Array(256),e=0;64>e;e++)h["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=
e;d.encode=function(e){e=new Uint8Array(e);var d,a=e.length,b="";for(d=0;d<a;d+=3)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e[d]>>2],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(e[d]&3)<<4|e[d+1]>>4],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(e[d+1]&15)<<2|e[d+2]>>6],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e[d+2]&63];2===a%3?b=b.substring(0,b.length-1)+"\x3d":1===a%3&&(b=b.substring(0,b.length-
2)+"\x3d\x3d");return b};d.decode=function(e){var d=.75*e.length,a=e.length,b=0;"\x3d"===e[e.length-1]&&(d--,"\x3d"===e[e.length-2]&&d--);for(var k=new ArrayBuffer(d),p=new Uint8Array(k),d=0;d<a;d+=4){var n=h[e.charCodeAt(d)];var l=h[e.charCodeAt(d+1)];var f=h[e.charCodeAt(d+2)];var c=h[e.charCodeAt(d+3)];p[b++]=n<<2|l>>4;p[b++]=(l&15)<<4|f>>2;p[b++]=(f&3)<<6|c&63}return k}})()},function(m,d){function h(a){return a.map(function(a){if(a.buffer instanceof ArrayBuffer){var b=a.buffer;if(a.byteLength!==
b.byteLength){var e=new Uint8Array(a.byteLength);e.set(new Uint8Array(b,a.byteOffset,a.byteLength));b=e.buffer}return b}return a})}function e(a,b){b=b||{};var e=new g;h(a).forEach(function(a){e.append(a)});return b.type?e.getBlob(b.type):e.getBlob()}function q(a,b){return new Blob(h(a),b||{})}var g="undefined"!==typeof g?g:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:!1;try{var a=2===(new Blob(["hi"])).size}catch(k){a=
!1}if(d=a)try{d=2===(new Blob([new Uint8Array([1,2])])).size}catch(k){d=!1}var b=g&&g.prototype.append&&g.prototype.getBlob;"undefined"!==typeof Blob&&(e.prototype=Blob.prototype,q.prototype=Blob.prototype);a=a?d?Blob:q:b?e:void 0;m.exports=a},function(m,d,h){function e(a){var b=0,e;for(e in a)b=(b<<5)-b+a.charCodeAt(e),b|=0;return d.colors[Math.abs(b)%d.colors.length]}function q(a){function b(){if(b.enabled){var a=+new Date;b.diff=a-(k||a);b.prev=k;k=b.curr=a;for(var e=Array(arguments.length),a=
0;a<e.length;a++)e[a]=arguments[a];e[0]=d.coerce(e[0]);"string"!==typeof e[0]&&e.unshift("%O");var l=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(a,c){if("%%"===a)return a;l++;c=d.formatters[c];"function"===typeof c&&(a=c.call(b,e[l]),e.splice(l,1),l--);return a});d.formatArgs.call(b,e);(b.log||d.log||console.log.bind(console)).apply(b,e)}}var k;b.namespace=a;b.enabled=d.enabled(a);b.useColors=d.useColors();b.color=e(a);b.destroy=g;"function"===typeof d.init&&d.init(b);d.instances.push(b);return b}
function g(){var a=d.instances.indexOf(this);return-1!==a?(d.instances.splice(a,1),!0):!1}d=m.exports=q.debug=q["default"]=q;d.coerce=function(a){return a instanceof Error?a.stack||a.message:a};d.disable=function(){d.enable("")};d.enable=function(a){d.save(a);d.names=[];d.skips=[];var b,e=("string"===typeof a?a:"").split(/[\s,]+/),p=e.length;for(b=0;b<p;b++)e[b]&&(a=e[b].replace(/\*/g,".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$")));for(b=0;b<d.instances.length;b++)a=
d.instances[b],a.enabled=d.enabled(a.namespace)};d.enabled=function(a){if("*"===a[a.length-1])return!0;var b;var e=0;for(b=d.skips.length;e<b;e++)if(d.skips[e].test(a))return!1;e=0;for(b=d.names.length;e<b;e++)if(d.names[e].test(a))return!0;return!1};d.humanize=h(13);d.instances=[];d.names=[];d.skips=[];d.formatters={}},function(m,d,h){(function(e){function d(){}function g(b){a.call(this,b);this.query=this.query||{};n||(e.___eio||(e.___eio=[]),n=e.___eio);this.index=n.length;var f=this;n.push(function(a){f.onData(a)});
this.query.j=this.index;e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){f.script&&(f.script.onerror=d)},!1)}var a=h(26),b=h(7);m.exports=g;var k=/\n/g,p=/\\n/g,n;b(g,a);g.prototype.supportsBinary=!1;g.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.iframe=this.form=null);a.prototype.doClose.call(this)};g.prototype.doPoll=function(){var a=this,b=document.createElement("script");
this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(c){a.onError("jsonp poll error",c)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b);this.script=b;"undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};g.prototype.doWrite=
function(a,b){function c(){f();b()}function f(){if(d.iframe)try{d.form.removeChild(d.iframe)}catch(t){d.onError("jsonp polling iframe removal error",t)}try{e=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+d.iframeId+'"\x3e')}catch(t){e=document.createElement("iframe"),e.name=d.iframeId,e.src="javascript:0"}e.id=d.iframeId;d.form.appendChild(e);d.iframe=e}var e,d=this;if(!this.form){var l=document.createElement("form"),g=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+
this.index;l.className="socketio";l.style.position="absolute";l.style.top="-1000px";l.style.left="-1000px";l.target=h;l.method="POST";l.setAttribute("accept-charset","utf-8");g.name="d";l.appendChild(g);document.body.appendChild(l);this.form=l;this.area=g}this.form.action=this.uri();f();a=a.replace(p,"\\\n");this.area.value=a.replace(k,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===d.iframe.readyState&&c()}:this.iframe.onload=
c}}).call(d,h(1))},function(m,d,h){(function(e){function d(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;this.usingBrowserWebSocket=l&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(c=f);g.call(this,a)}var g=h(16),a=h(4),b=h(6),k=h(7),p=h(27),n=h(8)("engine.io-client:websocket"),l=e.WebSocket||e.MozWebSocket;if("undefined"===typeof window)try{var f=h(67)}catch(r){}var c=l;c||"undefined"!==typeof window||(c=f);m.exports=d;k(d,g);d.prototype.name=
"websocket";d.prototype.supportsBinary=!0;d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=this.protocols,f={agent:this.agent,perMessageDeflate:this.perMessageDeflate};f.pfx=this.pfx;f.key=this.key;f.passphrase=this.passphrase;f.cert=this.cert;f.ca=this.ca;f.ciphers=this.ciphers;f.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(f.headers=this.extraHeaders);this.localAddress&&(f.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?b?new c(a,b):new c(a):
new c(a,b,f)}catch(A){return this.emit("error",A)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(c){a.onData(c.data)};this.ws.onerror=function(c){a.onError("websocket error",c)}};
d.prototype.write=function(c){function b(){f.emit("flush");setTimeout(function(){f.writable=!0;f.emit("drain")},0)}var f=this;this.writable=!1;for(var d=c.length,l=0,k=d;l<k;l++)(function(c){a.encodePacket(c,f.supportsBinary,function(a){if(!f.usingBrowserWebSocket){var l={};c.options&&(l.compress=c.options.compress);f.perMessageDeflate&&("string"===typeof a?e.Buffer.byteLength(a):a.length)<f.perMessageDeflate.threshold&&(l.compress=!1)}try{f.usingBrowserWebSocket?f.ws.send(a):f.ws.send(a,l)}catch(F){n("websocket closed before onclose event")}--d||
b()})})(c[l])};d.prototype.onClose=function(){g.prototype.onClose.call(this)};d.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};d.prototype.uri=function(){var a=this.query||{},c=this.secure?"wss":"ws",f="";this.port&&("wss"===c&&443!==Number(this.port)||"ws"===c&&80!==Number(this.port))&&(f=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=p());this.supportsBinary||(a.b64=1);a=b.encode(a);a.length&&(a="?"+a);var e=-1!==this.hostname.indexOf(":");return c+"://"+
(e?"["+this.hostname+"]":this.hostname)+f+this.path+a};d.prototype.check=function(){return!!c&&!("__initialize"in c&&this.name===d.prototype.name)}}).call(d,h(1))},function(m,d){},function(m,d){m.exports=function(d,e){for(var h=[],g=(e=e||0)||0;g<d.length;g++)h[g-e]=d[g];return h}},function(m,d){function h(e){e=e||{};this.ms=e.min||100;this.max=e.max||1E4;this.factor=e.factor||2;this.jitter=0<e.jitter&&1>=e.jitter?e.jitter:0;this.attempts=0}m.exports=h;h.prototype.duration=function(){var e=this.ms*
Math.pow(this.factor,this.attempts++);if(this.jitter)var d=Math.random(),g=Math.floor(d*this.jitter*e),e=0==(Math.floor(10*d)&1)?e-g:e+g;return Math.min(e,this.max)|0};h.prototype.reset=function(){this.attempts=0};h.prototype.setMin=function(e){this.ms=e};h.prototype.setMax=function(e){this.max=e};h.prototype.setJitter=function(e){this.jitter=e}},function(m,d){d=function(d,e){this._pending=[];this._events={};this._id=0;this._enabled=!0;this._onAckCB=this._onAck.bind(this);this._onReconnectCB=this._onReconnect.bind(this);
this.setLastAcked(e);this.setSocket(d)};d.prototype.setId=function(d){this._id=0<=d?d:0};d.prototype.id=function(){return this._id};d.prototype.setLastAcked=function(d){this._lastAcked=0<=d?d:-1};d.prototype.lastAcked=function(){return this._lastAcked};d.prototype.setSocket=function(d){var e=this;this._cleanup();if(this._socket=d)Object.keys(this._events).forEach(function(d){for(var g=0;g<e._events[d].length;g+=1)e._socket.on(d,e._events[d][g].wrapped)}),this._socket.on("reconnect",this._onReconnectCB),
this._socket.on("socketgd_ack",this._onAckCB),this.sendPending()};d.prototype.sendPending=function(){var d=this;this._pending.forEach(function(e){d._sendOnSocket(e)})};d.prototype.clearPending=function(){this._pending=[]};d.prototype.getNumberOfPending=function(){return this._pending.length};d.prototype.enable=function(d){this._enabled=d};d.prototype.socket=function(){return this._socket};d.prototype._cleanup=function(){var d=this;this._socket&&(this._socket.removeListener("reconnect",this._onReconnectCB),
this._socket.removeListener("socketgd_ack",this._onAckCB),Object.keys(this._events).forEach(function(e){for(var h=0;h<d._events[e].length;h+=1)d._socket.removeListener(e,d._events[e][h].wrapped)}))};d.prototype._onAck=function(d){for(;0<this._pending.length&&this._pending[0].id<=d.id;)this._pending.shift()};d.prototype._onReconnect=function(){this.sendPending()};d.prototype._sendAck=function(d){if(this._socket)return this._lastAcked=d,this._socket.emit("socketgd_ack",{id:d}),this._lastAcked};d.prototype._sendOnSocket=
function(d){this._enabled&&void 0===d.id&&(d.id=this._id,this._id+=1,d.gd=!0,this._pending.push(d));if(this._socket)if(this._enabled)switch(d.type){case "send":this._socket.send("socketgd:"+d.id+":"+d.msg,d.ack);break;case "emit":this._socket.emit(d.event,{socketgd:d.id,msg:d.msg},d.ack)}else switch(d.type){case "send":this._socket.send(d.msg,d.ack);break;case "emit":this._socket.emit(d.event,d.msg,d.ack)}};d.prototype.send=function(d,e){this._sendOnSocket({type:"send",msg:d,ack:e})};d.prototype.emit=
function(d,e,q){this._sendOnSocket({type:"emit",event:d,msg:e,ack:q})};d.prototype.disconnect=function(d){this._socket&&this._socket.disconnect(d);this._cleanup();this._socket=null};d.prototype.disconnectSync=function(){this._socket&&this._socket.disconnectSync();this._cleanup();this._socket=null};d.prototype.on=function(d,e){var h=this;this._events[d]=this._events[d]||[];var g={cb:e,wrapped:function(a,b){if(a&&"message"===d)if(0!==a.indexOf("socketgd:"))e(a,b);else{var k=a.indexOf(":",9);if(-1===
k)e(a,b);else{var g=parseInt(a.substring(9,k),10);if(!(g<=h._lastAcked)){a=a.substring(k+1);if(e)try{e(a,b)}catch(n){}h._sendAck(g)}}}else if(a&&"object"===typeof a&&void 0!==a.socketgd){if(!(a.socketgd<=h._lastAcked)){if(e)try{e(a.msg,b)}catch(n){}h._sendAck(a.socketgd)}}else e(a,b)}};this._events[d].push(g);if(this._socket)this._socket.on(d,g.wrapped)};d.prototype.off=function(d,e){if(this._events[d])for(var h=0;h<this._events[d].length;h+=1)this._events[d][h].cb===e&&(this._socket&&this._socket.removeListener(d,
this._events[d][h].wrapped),this._events[d].splice(h,1))};m.exports={ReliableSocket:d}},function(m,d,h){m=function(){return{getRandomValue:function(){var e=new Uint16Array(1);window.crypto.getRandomValues(e);return e[0]}}}();d.a=m},function(m,d,h){var e=h(9),q=h(33);d.a=function(d){var a=Object(e.a)({});a.id=d.id;a.stream=d.stream.stream;a.elementID=d.elementID;var b=function(){a.bar.display()},k=function(){a.bar.hide()};a.destroy=function(){a.video.pause();a.parentNode.removeChild(a.div)};a.div=
document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;");!1!==d.options.loader&&(a.loader=document.createElement("img"),a.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),a.loader.setAttribute("id","back_"+a.id),a.loader.setAttribute("class",
"licode_loader"),a.loader.setAttribute("src",a.url+"/assets/loader.gif"));a.video=document.createElement("video");a.video.setAttribute("id","stream"+a.id);a.video.setAttribute("class","licode_stream");a.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: cover");a.video.setAttribute("autoplay","autoplay");a.video.setAttribute("playsinline","playsinline");d.stream.local&&(a.video.volume=0);a.container=void 0!==a.elementID?"object"===typeof a.elementID&&"function"===
typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID):document.body;a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.loader&&a.div.appendChild(a.loader);a.div.appendChild(a.video);a.containerWidth=0;a.containerHeight=0;!1!==d.options.bar?(a.bar=Object(q.a)({elementID:"player_"+a.id,id:a.id,stream:d.stream,media:a.video,options:d.options}),a.div.onmouseover=b,a.div.onmouseout=k):a.media=a.video;a.video.srcObject=a.stream;return a}},function(m,d,h){var e=h(9);
d.a=function(d){var g=Object(e.a)({}),a=50;g.elementID=d.elementID;g.media=d.media;g.id=d.id;g.stream=d.stream;g.div=document.createElement("div");g.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;");g.icon=document.createElement("img");g.icon.setAttribute("id","volume_"+g.id);g.icon.setAttribute("src",g.url+"/assets/sound48.png");g.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;");g.div.appendChild(g.icon);g.icon.onclick=
function(){g.media.muted?(g.media.muted=!1,g.icon.setAttribute("src",g.url+"/assets/sound48.png"),g.stream.local?g.stream.stream.getAudioTracks()[0].enabled=!0:(g.picker.value=a,g.media.volume=g.picker.value/100)):(g.media.muted=!0,g.icon.setAttribute("src",g.url+"/assets/mute48.png"),g.stream.local?g.stream.stream.getAudioTracks()[0].enabled=!1:(a=g.picker.value,g.picker.value=0,g.media.volume=0))};if(!g.stream.local){g.picker=document.createElement("input");g.picker.setAttribute("id","picker_"+
g.id);g.picker.type="range";g.picker.min=0;g.picker.max=100;g.picker.step=10;g.picker.value=a;g.picker.setAttribute("orient","vertical");g.div.appendChild(g.picker);g.media.volume=g.picker.value/100;g.media.muted=!1;g.picker.oninput=function(){0<g.picker.value?(g.media.muted=!1,g.icon.setAttribute("src",g.url+"/assets/sound48.png")):(g.media.muted=!0,g.icon.setAttribute("src",g.url+"/assets/mute48.png"));g.media.volume=g.picker.value/100};var b=function(a){g.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+
g.div.offsetHeight+"px; display: "+a)};g.div.onmouseover=function(){b("block")};g.div.onmouseout=function(){b("none")};b("none")}document.getElementById(g.elementID).appendChild(g.div);return g}},function(m,d,h){var e=h(9),q=h(33);d.a=function(d){var a=Object(e.a)({});a.id=d.id;a.stream=d.stream.stream;a.elementID=d.elementID;a.audio=document.createElement("audio");a.audio.setAttribute("id","stream"+a.id);a.audio.setAttribute("class","licode_stream");a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");
a.audio.setAttribute("autoplay","autoplay");d.stream.local&&(a.audio.volume=0);if(void 0!==a.elementID){a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)};var b=function(){a.bar.display()};var k=function(){a.bar.hide()};a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("class","licode_player");a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;");a.container="object"===typeof a.elementID&&"function"===
typeof a.elementID.appendChild?a.elementID:document.getElementById(a.elementID);a.container.appendChild(a.div);a.parentNode=a.div.parentNode;a.div.appendChild(a.audio);!1!==d.options.bar?(a.bar=Object(q.a)({elementID:"player_"+a.id,id:a.id,stream:d.stream,media:a.audio,options:d.options}),a.div.onmouseover=b,a.div.onmouseout=k):a.media=a.audio}else a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body;a.audio.srcObject=
a.stream;return a}},function(m,d,h){(function(d){m.exports=d.adapter=h(76)}).call(d,h(1))},function(m,d,h){m.exports=function(){return function(){function d(e,g,a){function b(p,l){if(!g[p]){if(!e[p]){if(k)return k(p,!0);l=Error("Cannot find module '"+p+"'");throw l.code="MODULE_NOT_FOUND",l;}l=g[p]={exports:{}};e[p][0].call(l.exports,function(a){return b(e[p][1][a]||a)},l,l.exports,d,e,g,a)}return g[p].exports}for(var k=!1,p=0;p<a.length;p++)b(a[p]);return b}return d}()({1:[function(d,h,g){d=d("./adapter_factory.js");
d=(0,d.adapterFactory)({window:window});h.exports=d},{"./adapter_factory.js":2}],2:[function(d,h,g){function a(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}Object.defineProperty(g,"__esModule",{value:!0});g.adapterFactory=function(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,
shimSafari:!0},k=b.log,g=b.detectBrowser(a),h={browserDetails:g,commonShim:f,extractVersion:b.extractVersion,disableLog:b.disableLog,disableWarnings:b.disableWarnings};switch(g.browser){case "chrome":if(!e||!e.shimPeerConnection||!d.shimChrome){k("Chrome shim is not included in this adapter release.");break}k("adapter.js shimming chrome.");h.browserShim=e;e.shimGetUserMedia(a);e.shimMediaStream(a);e.shimPeerConnection(a);e.shimOnTrack(a);e.shimAddTrackRemoveTrack(a);e.shimGetSendersWithDtmf(a);e.shimGetStats(a);
e.shimSenderReceiverGetStats(a);e.fixNegotiationNeeded(a);f.shimRTCIceCandidate(a);f.shimConnectionState(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);f.removeAllowExtmapMixed(a);break;case "firefox":if(!n||!n.shimPeerConnection||!d.shimFirefox){k("Firefox shim is not included in this adapter release.");break}k("adapter.js shimming firefox.");h.browserShim=n;n.shimGetUserMedia(a);n.shimPeerConnection(a);n.shimOnTrack(a);n.shimRemoveStream(a);n.shimSenderGetStats(a);n.shimReceiverGetStats(a);
n.shimRTCDataChannel(a);f.shimRTCIceCandidate(a);f.shimConnectionState(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);break;case "edge":if(!p||!p.shimPeerConnection||!d.shimEdge){k("MS edge shim is not included in this adapter release.");break}k("adapter.js shimming edge.");h.browserShim=p;p.shimGetUserMedia(a);p.shimGetDisplayMedia(a);p.shimPeerConnection(a);p.shimReplaceTrack(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);break;case "safari":if(!l||!d.shimSafari){k("Safari shim is not included in this adapter release.");
break}k("adapter.js shimming safari.");h.browserShim=l;l.shimRTCIceServerUrls(a);l.shimCreateOfferLegacy(a);l.shimCallbacksAPI(a);l.shimLocalStreamsAPI(a);l.shimRemoteStreamsAPI(a);l.shimTrackEventTransceiver(a);l.shimGetUserMedia(a);f.shimRTCIceCandidate(a);f.shimMaxMessageSize(a);f.shimSendThrowTypeError(a);f.removeAllowExtmapMixed(a);break;default:k("Unsupported browser!")}return h};h=d("./utils");var b=a(h);h=d("./chrome/chrome_shim");var e=a(h);h=d("./edge/edge_shim");var p=a(h);h=d("./firefox/firefox_shim");
var n=a(h);h=d("./safari/safari_shim");var l=a(h);d=d("./common_shim");var f=a(d)},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(d,h,g){function a(a,c,b){c in a?Object.defineProperty(a,c,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[c]=b;return a}function b(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(c){return a._shimmedLocalStreams[c][0]})};
var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,b){if(!b)return c.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var f=c.apply(this,arguments);this._shimmedLocalStreams[b.id]?-1===this._shimmedLocalStreams[b.id].indexOf(f)&&this._shimmedLocalStreams[b.id].push(f):this._shimmedLocalStreams[b.id]=[b,f];return f};var b=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._shimmedLocalStreams=
this._shimmedLocalStreams||{};a.getTracks().forEach(function(a){if(c.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});var f=this.getSenders();b.apply(this,arguments);var d=this.getSenders().filter(function(a){return-1===f.indexOf(a)});this._shimmedLocalStreams[a.id]=[a].concat(d)};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||
{};delete this._shimmedLocalStreams[a.id];return f.apply(this,arguments)};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};a&&Object.keys(this._shimmedLocalStreams).forEach(function(b){var f=c._shimmedLocalStreams[b].indexOf(a);-1!==f&&c._shimmedLocalStreams[b].splice(f,1);1===c._shimmedLocalStreams[b].length&&delete c._shimmedLocalStreams[b]});return d.apply(this,arguments)}}Object.defineProperty(g,
"__esModule",{value:!0});g.shimGetDisplayMedia=g.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p=d("./getusermedia");Object.defineProperty(g,"shimGetUserMedia",{enumerable:!0,get:function(){return p.shimGetUserMedia}});
var n=d("./getdisplaymedia");Object.defineProperty(g,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}});g.shimMediaStream=function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream};g.shimOnTrack=function(a){if("object"!==("undefined"===typeof a?"undefined":e(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)l.wrapPeerConnectionEvent(a,"track",function(a){a.transceiver||Object.defineProperty(a,"transceiver",{value:{receiver:a.receiver}});return a});
else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)},enumerable:!0,configurable:!0});var c=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var b=this;this._ontrackpoly||(this._ontrackpoly=function(c){c.stream.addEventListener("addtrack",function(d){var f=void 0,
f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track},e=new Event("track");e.track=d.track;e.receiver=f;e.transceiver={receiver:f};e.streams=[c.stream];b.dispatchEvent(e)});c.stream.getTracks().forEach(function(d){var f=void 0,f=a.RTCPeerConnection.prototype.getReceivers?b.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d},e=new Event("track");e.track=d;e.receiver=f;e.transceiver={receiver:f};
e.streams=[c.stream];b.dispatchEvent(e)})},this.addEventListener("addstream",this._ontrackpoly));return c.apply(this,arguments)}}};g.shimGetSendersWithDtmf=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var c=function(a,c){return{track:c,get dtmf(){void 0===this._dtmf&&(this._dtmf="audio"===c.kind?a.createDTMFSender(c):null);return this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=
function(){this._senders=this._senders||[];return this._senders.slice()};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var f=b.apply(this,arguments);f||(f=c(this,a),this._senders.push(f));return f};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);var c=this._senders.indexOf(a);-1!==c&&this._senders.splice(c,1)}}var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=
function(a){var b=this;this._senders=this._senders||[];f.apply(this,[a]);a.getTracks().forEach(function(a){b._senders.push(c(b,a))})};var l=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;this._senders=this._senders||[];l.apply(this,[a]);a.getTracks().forEach(function(a){var b=c._senders.find(function(c){return c.track===a});b&&c._senders.splice(c._senders.indexOf(b),1)})}}else if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&
"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var k=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=k.apply(this,[]);c.forEach(function(c){return c._pc=a});return c};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null);
return this._dtmf}})}};g.shimGetStats=function(a){if(a.RTCPeerConnection){var c=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){var a=this,b=Array.prototype.slice.call(arguments),d=b[0],f=b[1],b=b[2];if(0<arguments.length&&"function"===typeof d)return c.apply(this,arguments);if(0===c.length&&(0===arguments.length||"function"!==typeof d))return c.apply(this,[]);var e=function(a){var c={};a.result().forEach(function(a){var b={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",
remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(c){b[c]=a.stat(c)});c[b.id]=b});return c},l=function(a){return new Map(Object.keys(a).map(function(c){return[c,a[c]]}))};return 2<=arguments.length?c.apply(this,[function(a){f(l(e(a)))},d]):(new Promise(function(b,d){c.apply(a,[function(a){b(l(e(a)))},d])})).then(f,b)}}};g.shimSenderReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":e(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver){if(!("getStats"in
a.RTCRtpSender.prototype)){var c=a.RTCPeerConnection.prototype.getSenders;c&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=c.apply(this,[]);b.forEach(function(c){return c._pc=a});return b});var b=a.RTCPeerConnection.prototype.addTrack;b&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=b.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return l.filterStats(c,a.track,!0)})}}if(!("getStats"in
a.RTCRtpReceiver.prototype)){var d=a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=function(){var a=this,c=d.apply(this,[]);c.forEach(function(c){return c._pc=a});return c});l.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){var a=this;return this._pc.getStats().then(function(c){return l.filterStats(c,a.track,!1)})}}if("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype){var f=
a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof a.MediaStreamTrack){var c=arguments[0],b=void 0,d=void 0,e=void 0;this.getSenders().forEach(function(a){a.track===c&&(b?e=!0:b=a)});this.getReceivers().forEach(function(a){a.track===c&&(d?e=!0:d=a);return a.track===c});return e||b&&d?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):b?b.getStats():d?
d.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return f.apply(this,arguments)}}}};g.shimAddTrackRemoveTrackWithNative=b;g.shimAddTrackRemoveTrack=function(d){function c(a,c){var b=c.sdp;Object.keys(a._reverseStreams||[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(a._streams[c.id].id,"g"),c.id)});return new RTCSessionDescription({type:c.type,sdp:b})}function e(a,c){var b=c.sdp;Object.keys(a._reverseStreams||
[]).forEach(function(c){c=a._reverseStreams[c];b=b.replace(new RegExp(c.id,"g"),a._streams[c.id].id)});return new RTCSessionDescription({type:c.type,sdp:b})}if(d.RTCPeerConnection){var f=l.detectBrowser(d);if(d.RTCPeerConnection.prototype.addTrack&&65<=f.version)return b(d);var k=d.RTCPeerConnection.prototype.getLocalStreams;d.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,c=k.apply(this);this._reverseStreams=this._reverseStreams||{};return c.map(function(c){return a._reverseStreams[c.id]})};
var p=d.RTCPeerConnection.prototype.addStream;d.RTCPeerConnection.prototype.addStream=function(a){var c=this;this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};a.getTracks().forEach(function(a){if(c.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");});if(!this._reverseStreams[a.id]){var b=new d.MediaStream(a.getTracks());this._streams[a.id]=b;this._reverseStreams[b.id]=a;a=b}p.apply(this,[a])};var g=d.RTCPeerConnection.prototype.removeStream;
d.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};g.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};d.RTCPeerConnection.prototype.addTrack=function(a,c){var b=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,
1);if(1!==e.length||!e[0].getTracks().find(function(c){return c===a}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(c){return c.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};(e=this._streams[c.id])?(e.addTrack(a),Promise.resolve().then(function(){b.dispatchEvent(new Event("negotiationneeded"))})):
(e=new d.MediaStream([a]),this._streams[c.id]=e,this._reverseStreams[e.id]=c,this.addStream(e));return this.getSenders().find(function(c){return c.track===a})};["createOffer","createAnswer"].forEach(function(b){var e=d.RTCPeerConnection.prototype[b],f=a({},b,function(){var a=this,b=arguments;return arguments.length&&"function"===typeof arguments[0]?e.apply(this,[function(d){d=c(a,d);b[0].apply(null,[d])},function(a){b[1]&&b[1].apply(null,a)},arguments[2]]):e.apply(this,arguments).then(function(b){return c(a,
b)})});d.RTCPeerConnection.prototype[b]=f[b]});var h=d.RTCPeerConnection.prototype.setLocalDescription;d.RTCPeerConnection.prototype.setLocalDescription=function(){if(!arguments.length||!arguments[0].type)return h.apply(this,arguments);arguments[0]=e(this,arguments[0]);return h.apply(this,arguments)};var n=Object.getOwnPropertyDescriptor(d.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(d.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=n.get.apply(this);
return""===a.type?a:c(this,a)}});d.RTCPeerConnection.prototype.removeTrack=function(a){var c=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(a._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};
var b=void 0;Object.keys(this._streams).forEach(function(d){c._streams[d].getTracks().find(function(c){return a.track===c})&&(b=c._streams[d])});b&&(1===b.getTracks().length?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(a.track),this.dispatchEvent(new Event("negotiationneeded")))}}};g.shimPeerConnection=function(b){var c=l.detectBrowser(b);!b.RTCPeerConnection&&b.webkitRTCPeerConnection&&(b.RTCPeerConnection=b.webkitRTCPeerConnection);if(b.RTCPeerConnection){53>c.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(c){var d=b.RTCPeerConnection.prototype[c],e=a({},c,function(){arguments[0]=new ("addIceCandidate"===c?b.RTCIceCandidate:b.RTCSessionDescription)(arguments[0]);return d.apply(this,arguments)});b.RTCPeerConnection.prototype[c]=e[c]});var d=b.RTCPeerConnection.prototype.addIceCandidate;b.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>c.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():d.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};g.fixNegotiationNeeded=function(a){l.wrapPeerConnectionEvent(a,"negotiationneeded",function(a){if("stable"===a.target.signalingState)return a})};var l=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b]);c.default=a;return c}(d("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(d,h,g){Object.defineProperty(g,"__esModule",
{value:!0});g.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||("function"!==typeof b?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):a.navigator.mediaDevices.getDisplayMedia=function(d){return b(d).then(function(b){var e=d.video&&d.video.width,l=d.video&&d.video.height;d.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b,maxFrameRate:d.video&&d.video.frameRate||3}};e&&
(d.video.mandatory.maxWidth=e);l&&(d.video.mandatory.maxHeight=l);return a.navigator.mediaDevices.getUserMedia(d)})})}},{}],5:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==
Symbol.prototype?"symbol":typeof a};g.shimGetUserMedia=function(d){var k=d&&d.navigator;if(k.mediaDevices){var l=b.detectBrowser(d),f=function(c){if("object"!==("undefined"===typeof c?"undefined":a(c))||c.mandatory||c.optional)return c;var b={};Object.keys(c).forEach(function(d){if("require"!==d&&"advanced"!==d&&"mediaSource"!==d){var e="object"===a(c[d])?c[d]:{ideal:c[d]};void 0!==e.exact&&"number"===typeof e.exact&&(e.min=e.max=e.exact);var f=function(a,c){return a?a+c.charAt(0).toUpperCase()+c.slice(1):
"deviceId"===c?"sourceId":c};if(void 0!==e.ideal){b.optional=b.optional||[];var l={};"number"===typeof e.ideal?(l[f("min",d)]=e.ideal,b.optional.push(l),l={},l[f("max",d)]=e.ideal):l[f("",d)]=e.ideal;b.optional.push(l)}void 0!==e.exact&&"number"!==typeof e.exact?(b.mandatory=b.mandatory||{},b.mandatory[f("",d)]=e.exact):["min","max"].forEach(function(a){void 0!==e[a]&&(b.mandatory=b.mandatory||{},b.mandatory[f(a,d)]=e[a])})}});c.advanced&&(b.optional=(b.optional||[]).concat(c.advanced));return b},
c=function(c,b){if(61<=l.version)return b(c);if((c=JSON.parse(JSON.stringify(c)))&&"object"===a(c.audio)){var d=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])};c=JSON.parse(JSON.stringify(c));d(c.audio,"autoGainControl","googAutoGainControl");d(c.audio,"noiseSuppression","googNoiseSuppression");c.audio=f(c.audio)}if(c&&"object"===a(c.video)){var p=c.video.facingMode,p=p&&("object"===("undefined"===typeof p?"undefined":a(p))?p:{ideal:p}),d=66>l.version;if(!(!p||"user"!==p.exact&&"environment"!==
p.exact&&"user"!==p.ideal&&"environment"!==p.ideal||k.mediaDevices.getSupportedConstraints&&k.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete c.video.facingMode;var g=void 0;if("environment"===p.exact||"environment"===p.ideal)g=["back","rear"];else if("user"===p.exact||"user"===p.ideal)g=["front"];if(g)return k.mediaDevices.enumerateDevices().then(function(a){a=a.filter(function(a){return"videoinput"===a.kind});var d=a.find(function(a){return g.some(function(c){return a.label.toLowerCase().includes(c)})});
!d&&a.length&&g.includes("back")&&(d=a[a.length-1]);d&&(c.video.deviceId=p.exact?{exact:d.deviceId}:{ideal:d.deviceId});c.video=f(c.video);e("chrome: "+JSON.stringify(c));return b(c)})}c.video=f(c.video)}e("chrome: "+JSON.stringify(c));return b(c)},p=function(a){return 64<=l.version?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",
MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};k.getUserMedia=function(a,b,d){c(a,function(a){k.webkitGetUserMedia(a,b,function(a){d&&d(p(a))})})}.bind(k);if(k.mediaDevices.getUserMedia){var g=k.mediaDevices.getUserMedia.bind(k.mediaDevices);
k.mediaDevices.getUserMedia=function(a){return c(a,function(a){return g(a).then(function(c){if(a.audio&&!c.getAudioTracks().length||a.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return c},function(a){return Promise.reject(p(a))})})}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(d("../utils.js")),e=b.log},{"../utils.js":15}],
6:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};g.shimRTCIceCandidate=function(d){if(d.RTCIceCandidate&&!(d.RTCIceCandidate&&"foundation"in
d.RTCIceCandidate.prototype)){var k=d.RTCIceCandidate;d.RTCIceCandidate=function(d){"object"===("undefined"===typeof d?"undefined":a(d))&&d.candidate&&0===d.candidate.indexOf("a\x3d")&&(d=JSON.parse(JSON.stringify(d)),d.candidate=d.candidate.substr(2));if(d.candidate&&d.candidate.length){var e=new k(d);d=b.default.parseCandidate(d.candidate);var c=Object.assign(e,d);c.toJSON=function(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}};
return c}return new k(d)};d.RTCIceCandidate.prototype=k.prototype;e.wrapPeerConnectionEvent(d,"icecandidate",function(a){a.candidate&&Object.defineProperty(a,"candidate",{value:new d.RTCIceCandidate(a.candidate),writable:"false"});return a})}};g.shimMaxMessageSize=function(a){if(a.RTCPeerConnection){var d=e.detectBrowser(a);"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var l=
function(a){if(!a||!a.sdp)return!1;a=b.default.splitSections(a.sdp);a.shift();return a.some(function(a){return(a=b.default.parseMLine(a))&&"application"===a.kind&&-1!==a.protocol.indexOf("SCTP")})},f=function(a){a=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===a||2>a.length)return-1;a=parseInt(a[1],10);return a!==a?-1:a},c=function(a){var c=65536;"firefox"===d.browser&&(c=57>d.version?-1===a?16384:2147483637:60>d.version?57===d.version?65535:65536:2147483637);return c},k=function(a,c){var e=
65536;"firefox"===d.browser&&57===d.version&&(e=65535);a=b.default.matchPrefix(a.sdp,"a\x3dmax-message-size:");0<a.length?e=parseInt(a[0].substr(19),10):"firefox"===d.browser&&-1!==c&&(e=2147483637);return e},g=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){this._sctp=null;"chrome"===d.browser&&76<=d.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?
null:this._sctp},enumerable:!0,configurable:!0});if(l(arguments[0])){var a=f(arguments[0]),b=c(a),a=k(arguments[0],a),e=void 0,e=0===b&&0===a?Number.POSITIVE_INFINITY:0===b||0===a?Math.max(b,a):Math.min(b,a),b={};Object.defineProperty(b,"maxMessageSize",{get:function(){return e}});this._sctp=b}return g.apply(this,arguments)}}};g.shimSendThrowTypeError=function(a){function b(a,c){var b=a.send;a.send=function(){var d=arguments[0],d=d.length||d.size||d.byteLength;if("open"===a.readyState&&c.sctp&&d>
c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return b.apply(a,arguments)}}if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var d=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=d.apply(this,arguments);b(a,this);return a};e.wrapPeerConnectionEvent(a,"datachannel",function(a){b(a.channel,a.target);return a})}};g.shimConnectionState=function(a){if(a.RTCPeerConnection&&
!("connectionState"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype;Object.defineProperty(b,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0});Object.defineProperty(b,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(a){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),
delete this._onconnectionstatechange);a&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=a)},enumerable:!0,configurable:!0});["setLocalDescription","setRemoteDescription"].forEach(function(a){var d=b[a];b[a]=function(){this._connectionstatechangepoly||(this._connectionstatechangepoly=function(a){var c=a.target;if(c._lastConnectionState!==c.connectionState){c._lastConnectionState=c.connectionState;var b=new Event("connectionstatechange",a);c.dispatchEvent(b)}return a},this.addEventListener("iceconnectionstatechange",
this._connectionstatechangepoly));return d.apply(this,arguments)}})}};g.removeAllowExtmapMixed=function(a){if(a.RTCPeerConnection){var b=e.detectBrowser(a);if(!("chrome"===b.browser&&71<=b.version)){var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(a){a&&a.sdp&&-1!==a.sdp.indexOf("\na\x3dextmap-allow-mixed")&&(a.sdp=a.sdp.split("\n").filter(function(a){return"a\x3dextmap-allow-mixed"!==a.trim()}).join("\n"));return d.apply(this,arguments)}}}};
var b=(h=d("sdp"))&&h.__esModule?h:{default:h},e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(d("./utils"))},{"./utils":15,sdp:17}],7:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});g.shimGetDisplayMedia=g.shimGetUserMedia=void 0;var a=d("./getusermedia");Object.defineProperty(g,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}});var b=d("./getdisplaymedia");
Object.defineProperty(g,"shimGetDisplayMedia",{enumerable:!0,get:function(){return b.shimGetDisplayMedia}});g.shimPeerConnection=function(a){var b=e.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),15025>b.version)){var c=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){c.set.call(this,
a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null));return this._dtmf}});a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender);var d=(0,n.default)(a,b.version);a.RTCPeerConnection=function(a){a&&a.iceServers&&(a.iceServers=
(0,p.filterIceServers)(a.iceServers,b.version),e.log("ICE servers after filtering:",a.iceServers));return new d(a)};a.RTCPeerConnection.prototype=d.prototype};g.shimReplaceTrack=function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)};var e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(d("../utils")),p=d("./filtericeservers"),
n=(d=d("rtcpeerconnection-shim"))&&d.__esModule?d:{default:d}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});g.filterIceServers=function(b,d){var e=!1;b=JSON.parse(JSON.stringify(b));return b.filter(function(b){if(b&&(b.urls||b.url)){var d=b.urls||b.url;b.url&&!b.urls&&a.deprecated("RTCIceServer.url","RTCIceServer.urls");var f="string"===typeof d;f&&(d=[d]);d=d.filter(function(a){return 0===
a.indexOf("stun:")?!1:(a=a.startsWith("turn")&&!a.startsWith("turn:[")&&a.includes("transport\x3dudp"))&&!e?e=!0:a&&!e});delete b.url;b.urls=f?d[0]:d;return!!d.length}})};var a=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(d("../utils"))},{"../utils":15}],9:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});g.shimGetDisplayMedia=function(a){"getDisplayMedia"in a.navigator&&a.navigator.mediaDevices&&
!(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)&&(a.navigator.mediaDevices.getDisplayMedia=a.navigator.getDisplayMedia.bind(a.navigator))}},{}],10:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});g.shimGetUserMedia=function(a){a=a&&a.navigator;var b=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},d=a.mediaDevices.getUserMedia.bind(a.mediaDevices);
a.mediaDevices.getUserMedia=function(a){return d(a).catch(function(a){return Promise.reject(b(a))})}}},{}],11:[function(d,h,g){function a(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a}Object.defineProperty(g,"__esModule",{value:!0});g.shimGetDisplayMedia=g.shimGetUserMedia=void 0;$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=d("./getusermedia");Object.defineProperty(g,"shimGetUserMedia",{enumerable:!0,get:function(){return e.shimGetUserMedia}});var p=d("./getdisplaymedia");Object.defineProperty(g,"shimGetDisplayMedia",{enumerable:!0,get:function(){return p.shimGetDisplayMedia}});g.shimOnTrack=function(a){"object"===("undefined"===typeof a?"undefined":
b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};g.shimPeerConnection=function(d){var e=n.detectBrowser(d);if("object"===("undefined"===typeof d?"undefined":b(d))&&(d.RTCPeerConnection||d.mozRTCPeerConnection)){!d.RTCPeerConnection&&d.mozRTCPeerConnection&&(d.RTCPeerConnection=d.mozRTCPeerConnection);53>e.version&&["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(c){var b=d.RTCPeerConnection.prototype[c],e=a({},c,function(){arguments[0]=new ("addIceCandidate"===c?d.RTCIceCandidate:d.RTCSessionDescription)(arguments[0]);return b.apply(this,arguments)});d.RTCPeerConnection.prototype[c]=e[c]});if(68>e.version){var c=d.RTCPeerConnection.prototype.addIceCandidate;d.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():c.apply(this,
arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var l={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},k=d.RTCPeerConnection.prototype.getStats;d.RTCPeerConnection.prototype.getStats=function(){var a=Array.prototype.slice.call(arguments),c=a[1],b=a[2];return k.apply(this,[a[0]||null]).then(function(a){if(53>e.version&&!c)try{a.forEach(function(a){a.type=l[a.type]||a.type})}catch(t){if("TypeError"!==
t.name)throw t;a.forEach(function(c,b){a.set(b,Object.assign({},c,{type:l[c.type]||c.type}))})}return a}).then(c,b)}}};g.shimSenderGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)){var d=a.RTCPeerConnection.prototype.getSenders;d&&(a.RTCPeerConnection.prototype.getSenders=function(){var a=this,c=d.apply(this,[]);c.forEach(function(c){return c._pc=a});return c});var c=a.RTCPeerConnection.prototype.addTrack;
c&&(a.RTCPeerConnection.prototype.addTrack=function(){var a=c.apply(this,arguments);a._pc=this;return a});a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};g.shimReceiverGetStats=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&a.RTCRtpSender&&!(a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)){var d=a.RTCPeerConnection.prototype.getReceivers;d&&(a.RTCPeerConnection.prototype.getReceivers=
function(){var a=this,b=d.apply(this,[]);b.forEach(function(c){return c._pc=a});return b});n.wrapPeerConnectionEvent(a,"track",function(a){a.receiver._pc=a.srcElement;return a});a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}};g.shimRemoveStream=function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var c=this;n.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(b){b.track&&
a.getTracks().includes(b.track)&&c.removeTrack(b)})})};g.shimRTCDataChannel=function(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)};var n=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(d("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});g.shimGetDisplayMedia=function(a,b){a.navigator.mediaDevices&&
"getDisplayMedia"in a.navigator.mediaDevices||!a.navigator.mediaDevices||(a.navigator.mediaDevices.getDisplayMedia=function(d){if(!d||!d.video)return d=new DOMException("getDisplayMedia without video constraints is undefined"),d.name="NotFoundError",d.code=8,Promise.reject(d);!0===d.video?d.video={mediaSource:b}:d.video.mediaSource=b;return a.navigator.mediaDevices.getUserMedia(d)})}},{}],13:[function(d,h,g){Object.defineProperty(g,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();
$jscomp.initSymbolIterator();var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};g.shimGetUserMedia=function(d){var e=b.detectBrowser(d),k=d&&d.navigator;d=d&&d.MediaStreamTrack;k.getUserMedia=function(a,c,d){b.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");
k.mediaDevices.getUserMedia(a).then(c,d)};if(!(55<e.version&&"autoGainControl"in k.mediaDevices.getSupportedConstraints())){var l=function(a,c,b){c in a&&!(b in a)&&(a[b]=a[c],delete a[c])},f=k.mediaDevices.getUserMedia.bind(k.mediaDevices);k.mediaDevices.getUserMedia=function(c){"object"===("undefined"===typeof c?"undefined":a(c))&&"object"===a(c.audio)&&(c=JSON.parse(JSON.stringify(c)),l(c.audio,"autoGainControl","mozAutoGainControl"),l(c.audio,"noiseSuppression","mozNoiseSuppression"));return f(c)};
if(d&&d.prototype.getSettings){var c=d.prototype.getSettings;d.prototype.getSettings=function(){var a=c.apply(this,arguments);l(a,"mozAutoGainControl","autoGainControl");l(a,"mozNoiseSuppression","noiseSuppression");return a}}if(d&&d.prototype.applyConstraints){var g=d.prototype.applyConstraints;d.prototype.applyConstraints=function(c){"audio"===this.kind&&"object"===("undefined"===typeof c?"undefined":a(c))&&(c=JSON.parse(JSON.stringify(c)),l(c,"autoGainControl","mozAutoGainControl"),l(c,"noiseSuppression",
"mozNoiseSuppression"));return g.apply(this,[c])}}}};var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(d("../utils"))},{"../utils":15}],14:[function(d,h,g){function a(a){return a&&void 0!==a.video?Object.assign({},a,{video:e.compactObject(a.video)}):a}Object.defineProperty(g,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b="function"===typeof Symbol&&
"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};g.shimLocalStreamsAPI=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){"getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){this._localStreams||(this._localStreams=
[]);return this._localStreams});if(!("addStream"in a.RTCPeerConnection.prototype)){var d=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);this._localStreams.includes(a)||this._localStreams.push(a);a.getAudioTracks().forEach(function(c){return d.call(b,c,a)});a.getVideoTracks().forEach(function(c){return d.call(b,c,a)})};a.RTCPeerConnection.prototype.addTrack=function(a){var b=arguments[1];b&&(this._localStreams?
this._localStreams.includes(b)||this._localStreams.push(b):this._localStreams=[b]);return d.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(a);if(-1!==c){this._localStreams.splice(c,1);var d=a.getTracks();this.getSenders().forEach(function(a){d.includes(a.track)&&b.removeTrack(a)})}})}};g.shimRemoteStreamsAPI=function(a){if("object"===
("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",
this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){b._remoteStreams||(b._remoteStreams=[]);if(!b._remoteStreams.includes(a)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=a;b.dispatchEvent(c)}})})}});var d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;this._onaddstreampoly||this.addEventListener("track",
this._onaddstreampoly=function(b){b.streams.forEach(function(c){a._remoteStreams||(a._remoteStreams=[]);if(!(0<=a._remoteStreams.indexOf(c))){a._remoteStreams.push(c);var b=new Event("addstream");b.stream=c;a.dispatchEvent(b)}})});return d.apply(a,arguments)}}};g.shimCallbacksAPI=function(a){if("object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var d=a.createOffer,e=a.createAnswer,f=a.setLocalDescription,c=a.setRemoteDescription,k=a.addIceCandidate;
a.createOffer=function(a,c){var b=d.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!c)return b;b.then(a,c);return Promise.resolve()};a.createAnswer=function(a,c){var b=e.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);if(!c)return b;b.then(a,c);return Promise.resolve()};var g=function(a,c,b){a=f.apply(this,[a]);if(!b)return a;a.then(c,b);return Promise.resolve()};a.setLocalDescription=g;g=function(a,b,d){a=c.apply(this,[a]);if(!d)return a;a.then(b,d);return Promise.resolve()};
a.setRemoteDescription=g;g=function(a,c,b){a=k.apply(this,[a]);if(!b)return a;a.then(c,b);return Promise.resolve()};a.addIceCandidate=g}};g.shimGetUserMedia=function(b){var d=b&&b.navigator;if(d.mediaDevices&&d.mediaDevices.getUserMedia){b=d.mediaDevices;var e=b.getUserMedia.bind(b);d.mediaDevices.getUserMedia=function(b){return e(a(b))}}!d.getUserMedia&&d.mediaDevices&&d.mediaDevices.getUserMedia&&(d.getUserMedia=function(a,c,b){d.mediaDevices.getUserMedia(a).then(c,b)}.bind(d))};g.shimConstraints=
a;g.shimRTCIceServerUrls=function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,d){if(a&&a.iceServers){for(var c=[],f=0;f<a.iceServers.length;f++){var k=a.iceServers[f];!k.hasOwnProperty("urls")&&k.hasOwnProperty("url")?(e.deprecated("RTCIceServer.url","RTCIceServer.urls"),k=JSON.parse(JSON.stringify(k)),k.urls=k.url,delete k.url,c.push(k)):c.push(a.iceServers[f])}a.iceServers=c}return new b(a,d)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})};g.shimTrackEventTransceiver=function(a){"object"===("undefined"===typeof a?"undefined":b(a))&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};g.shimCreateOfferLegacy=function(a){var b=a.RTCPeerConnection.prototype.createOffer;
a.RTCPeerConnection.prototype.createOffer=function(a){if(a){"undefined"!==typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=this.getTransceivers().find(function(a){return"audio"===a.receiver.track.kind});!1===a.offerToReceiveAudio&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveAudio||d||this.addTransceiver("audio");
"undefined"!==typeof a.offerToReceiveVideo&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);d=this.getTransceivers().find(function(a){return"video"===a.receiver.track.kind});!1===a.offerToReceiveVideo&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):!0!==a.offerToReceiveVideo||d||this.addTransceiver("video")}return b.apply(this,arguments)}};var e=function(a){if(a&&
a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(d("../utils"))},{"../utils":15}],15:[function(d,h,g){function a(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function b(a,b,d){return(a=a.match(b))&&a.length>=d&&parseInt(a[d],10)}function e(c){return"[object Object]"!==Object.prototype.toString.call(c)?c:Object.keys(c).reduce(function(b,d){var f="[object Object]"===
Object.prototype.toString.call(c[d]),k=f?e(c[d]):c[d],f=f&&!Object.keys(k).length;return void 0===k||f?b:Object.assign(b,a({},d,k))},{})}function p(a,b,d){b&&!d.has(b.id)&&(d.set(b.id,b),Object.keys(b).forEach(function(c){c.endsWith("Id")?p(a,a.get(b[c]),d):c.endsWith("Ids")&&b[c].forEach(function(c){p(a,a.get(c),d)})}))}Object.defineProperty(g,"__esModule",{value:!0});$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?
function(a){return typeof a}:function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};g.extractVersion=b;g.wrapPeerConnectionEvent=function(a,b,d){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var c=a.addEventListener;a.addEventListener=function(a,e){if(a!==b)return c.apply(this,arguments);var f=function(a){(a=d(a))&&e(a)};this._eventMap=this._eventMap||{};this._eventMap[e]=
f;return c.apply(this,[a,f])};var e=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return e.apply(this,arguments);var d=this._eventMap[c];delete this._eventMap[c];return e.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)},enumerable:!0,configurable:!0})}};g.disableLog=
function(a){return"boolean"!==typeof a?Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean."):(l=a)?"adapter.js logging disabled":"adapter.js logging enabled"};g.disableWarnings=function(a){if("boolean"!==typeof a)return Error("Argument type: "+("undefined"===typeof a?"undefined":n(a))+". Please use a boolean.");f=!a;return"adapter.js deprecation warnings "+(a?"disabled":"enabled")};g.log=function(){"object"!==("undefined"===typeof window?"undefined":n(window))||
l||"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)};g.deprecated=function(a,b){f&&console.warn(a+" is deprecated, please use "+b+" instead.")};g.detectBrowser=function(a){var c=a.navigator,d={browser:null,version:null};if("undefined"===typeof a||!a.navigator)return d.browser="Not a browser.",d;c.mozGetUserMedia?(d.browser="firefox",d.version=b(c.userAgent,/Firefox\/(\d+)\./,1)):c.webkitGetUserMedia||!1===a.isSecureContext&&a.webkitRTCPeerConnection&&
!a.RTCIceGatherer?(d.browser="chrome",d.version=b(c.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):c.mediaDevices&&c.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.browser="edge",d.version=b(c.userAgent,/Edge\/(\d+).(\d+)$/,2)):a.RTCPeerConnection&&c.userAgent.match(/AppleWebKit\/(\d+)\./)?(d.browser="safari",d.version=b(c.userAgent,/AppleWebKit\/(\d+)\./,1),d.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype):d.browser="Not a supported browser.";return d};g.compactObject=
e;g.walkStats=p;g.filterStats=function(a,b,d){var c=d?"outbound-rtp":"inbound-rtp",e=new Map;if(null===b)return e;var f=[];a.forEach(function(a){"track"===a.type&&a.trackIdentifier===b.id&&f.push(a)});f.forEach(function(b){a.forEach(function(d){d.type===c&&d.trackId===b.id&&p(a,d,e)})});return e};var l=!0,f=!0},{}],16:[function(d,h,g){function a(a,b,d,e,k){b=f.writeRtpDescription(a.kind,b);b+=f.writeIceParameters(a.iceGatherer.getLocalParameters());b+=f.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),
"offer"===d?"actpass":k||"active");b+="a\x3dmid:"+a.mid+"\r\n";b=a.rtpSender&&a.rtpReceiver?b+"a\x3dsendrecv\r\n":a.rtpSender?b+"a\x3dsendonly\r\n":a.rtpReceiver?b+"a\x3drecvonly\r\n":b+"a\x3dinactive\r\n";a.rtpSender&&(d=a.rtpSender._initialTrackId||a.rtpSender.track.id,a.rtpSender._initialTrackId=d,e="msid:"+(e?e.id:"-")+" "+d+"\r\n",b=b+("a\x3d"+e)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+e),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+e,
b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n"));b+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+f.localCName+"\r\n";a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+f.localCName+"\r\n");return b}function b(a,b){var c=!1;a=JSON.parse(JSON.stringify(a));return a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");
var e="string"===typeof d;e&&(d=[d]);d=d.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport\x3dudp"):c=!0});delete a.url;a.urls=e?d[0]:d;return!!d.length}})}function e(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,c){a=parseInt(a,10);for(var b=0;b<c.length;b++)if(c[b].payloadType===a||c[b].preferredPayloadType===a)return c[b]},e=function(a,c,b,e){a=
d(a.parameters.apt,b);c=d(c.parameters.apt,e);return a&&c&&a.name.toLowerCase()===c.name.toLowerCase()};a.codecs.forEach(function(d){for(var f=0;f<b.codecs.length;f++){var k=b.codecs[f];if(d.name.toLowerCase()===k.name.toLowerCase()&&d.clockRate===k.clockRate&&("rtx"!==d.name.toLowerCase()||!d.parameters||!k.parameters.apt||e(d,k,a.codecs,b.codecs))){k=JSON.parse(JSON.stringify(k));k.numChannels=Math.min(d.numChannels,k.numChannels);c.codecs.push(k);k.rtcpFeedback=k.rtcpFeedback.filter(function(a){for(var c=
0;c<d.rtcpFeedback.length;c++)if(d.rtcpFeedback[c].type===a.type&&d.rtcpFeedback[c].parameter===a.parameter)return!0;return!1});break}}});a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}});return c}function p(a,b,d){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer",
"have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(d)}function n(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});c||a.addRemoteCandidate(b);return!c}function l(a,b){b=Error(b);b.name=a;b.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a];return b}var f=
d("sdp");h.exports=function(c,d){function k(a,b){b.addTrack(a);b.dispatchEvent(new c.MediaStreamTrackEvent("addtrack",{track:a}))}function g(a,b){b.removeTrack(a);b.dispatchEvent(new c.MediaStreamTrackEvent("removetrack",{track:a}))}function h(a,b,d,e){var f=new Event("track");f.track=b;f.receiver=d;f.transceiver={receiver:d};f.streams=e;c.setTimeout(function(){a._dispatchEvent("track",f)})}var m=function(a){var e=this,k=document.createDocumentFragment();["addEventListener","removeEventListener",
"dispatchEvent"].forEach(function(a){e[a]=k[a].bind(k)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this._remoteDescription=this._localDescription=null;this.signalingState="stable";this.iceGatheringState=this.connectionState=this.iceConnectionState="new";a=JSON.parse(JSON.stringify(a||{}));this.usingBundle="max-bundle"===a.bundlePolicy;if("negotiate"===a.rtcpMuxPolicy)throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");
a.rtcpMuxPolicy||(a.rtcpMuxPolicy="require");switch(a.iceTransportPolicy){case "all":case "relay":break;default:a.iceTransportPolicy="all"}switch(a.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:a.bundlePolicy="balanced"}a.iceServers=b(a.iceServers||[],d);this._iceGatherers=[];if(a.iceCandidatePoolSize)for(var g=a.iceCandidatePoolSize;0<g;g--)this._iceGatherers.push(new c.RTCIceGatherer({iceServers:a.iceServers,gatherPolicy:a.iceTransportPolicy}));else a.iceCandidatePoolSize=
0;this._config=a;this.transceivers=[];this._sdpSessionId=f.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};Object.defineProperty(m.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}});Object.defineProperty(m.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}});m.prototype.onicecandidate=null;m.prototype.onaddstream=null;m.prototype.ontrack=null;m.prototype.onremovestream=null;
m.prototype.onsignalingstatechange=null;m.prototype.oniceconnectionstatechange=null;m.prototype.onconnectionstatechange=null;m.prototype.onicegatheringstatechange=null;m.prototype.onnegotiationneeded=null;m.prototype.ondatachannel=null;m.prototype._dispatchEvent=function(a,c){if(!this._isClosed&&(this.dispatchEvent(c),"function"===typeof this["on"+a]))this["on"+a](c)};m.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",
a)};m.prototype.getConfiguration=function(){return this._config};m.prototype.getLocalStreams=function(){return this.localStreams};m.prototype.getRemoteStreams=function(){return this.remoteStreams};m.prototype._createTransceiver=function(a,c){var b=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,
associatedRemoteMediaStreams:[],wantReceive:!0};this.usingBundle&&b?(a.iceTransport=this.transceivers[0].iceTransport,a.dtlsTransport=this.transceivers[0].dtlsTransport):(b=this._createIceAndDtlsTransports(),a.iceTransport=b.iceTransport,a.dtlsTransport=b.dtlsTransport);c||this.transceivers.push(a);return a};m.prototype.addTrack=function(a,b){if(this._isClosed)throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(c){return c.track===
a}))throw l("InvalidAccessError","Track already exists.");for(var d,e=0;e<this.transceivers.length;e++)this.transceivers[e].track||this.transceivers[e].kind!==a.kind||(d=this.transceivers[e]);d||(d=this._createTransceiver(a.kind));this._maybeFireNegotiationNeeded();-1===this.localStreams.indexOf(b)&&this.localStreams.push(b);d.track=a;d.stream=b;d.rtpSender=new c.RTCRtpSender(a,d.dtlsTransport);return d.rtpSender};m.prototype.addStream=function(a){var c=this;if(15025<=d)a.getTracks().forEach(function(b){c.addTrack(b,
a)});else{var b=a.clone();a.getTracks().forEach(function(a,c){var d=b.getTracks()[c];a.addEventListener("enabled",function(a){d.enabled=a.enabled})});b.getTracks().forEach(function(a){c.addTrack(a,b)})}};m.prototype.removeTrack=function(a){if(this._isClosed)throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(a instanceof c.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var b=this.transceivers.find(function(c){return c.rtpSender===
a});if(!b)throw l("InvalidAccessError","Sender was not created by this connection.");var d=b.stream;b.rtpSender.stop();b.rtpSender=null;b.track=null;b.stream=null;-1===this.transceivers.map(function(a){return a.stream}).indexOf(d)&&-1<this.localStreams.indexOf(d)&&this.localStreams.splice(this.localStreams.indexOf(d),1);this._maybeFireNegotiationNeeded()};m.prototype.removeStream=function(a){var c=this;a.getTracks().forEach(function(a){var b=c.getSenders().find(function(c){return c.track===a});b&&
c.removeTrack(b)})};m.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})};m.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})};m.prototype._createIceGatherer=function(a,b){var d=this;if(b&&0<a)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var e=new c.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(e,"state",{value:"new",writable:!0});this.transceivers[a].bufferedCandidateEvents=[];this.transceivers[a].bufferCandidates=function(c){var b=!c.candidate||0===Object.keys(c.candidate).length;e.state=b?"completed":"gathering";null!==d.transceivers[a].bufferedCandidateEvents&&d.transceivers[a].bufferedCandidateEvents.push(c)};e.addEventListener("localcandidate",this.transceivers[a].bufferCandidates);return e};m.prototype._gather=function(a,
b){var d=this,e=this.transceivers[b].iceGatherer;if(!e.onlocalcandidate){var k=this.transceivers[b].bufferedCandidateEvents;this.transceivers[b].bufferedCandidateEvents=null;e.removeEventListener("localcandidate",this.transceivers[b].bufferCandidates);e.onlocalcandidate=function(c){if(!(d.usingBundle&&0<b)){var k=new Event("icecandidate");k.candidate={sdpMid:a,sdpMLineIndex:b};var g=c.candidate;if(c=!g||0===Object.keys(g).length){if("new"===e.state||"gathering"===e.state)e.state="completed"}else"new"===
e.state&&(e.state="gathering"),g.component=1,g.ufrag=e.getLocalParameters().usernameFragment,g=f.writeCandidate(g),k.candidate=Object.assign(k.candidate,f.parseCandidate(g)),k.candidate.candidate=g,k.candidate.toJSON=function(){return{candidate:k.candidate.candidate,sdpMid:k.candidate.sdpMid,sdpMLineIndex:k.candidate.sdpMLineIndex,usernameFragment:k.candidate.usernameFragment}};g=f.getMediaSections(d._localDescription.sdp);g[k.candidate.sdpMLineIndex]=c?g[k.candidate.sdpMLineIndex]+"a\x3dend-of-candidates\r\n":
g[k.candidate.sdpMLineIndex]+("a\x3d"+k.candidate.candidate+"\r\n");d._localDescription.sdp=f.getDescription(d._localDescription.sdp)+g.join("");g=d.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange());c||d._dispatchEvent("icecandidate",k);g&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}};
c.setTimeout(function(){k.forEach(function(a){e.onlocalcandidate(a)})},0)}};m.prototype._createIceAndDtlsTransports=function(){var a=this,b=new c.RTCIceTransport(null);b.onicestatechange=function(){a._updateIceConnectionState();a._updateConnectionState()};var d=new c.RTCDtlsTransport(b);d.ondtlsstatechange=function(){a._updateConnectionState()};d.onerror=function(){Object.defineProperty(d,"state",{value:"failed",writable:!0});a._updateConnectionState()};return{iceTransport:b,dtlsTransport:d}};m.prototype._disposeIceAndDtlsTransports=
function(a){var c=this.transceivers[a].iceGatherer;c&&(delete c.onlocalcandidate,delete this.transceivers[a].iceGatherer);if(c=this.transceivers[a].iceTransport)delete c.onicestatechange,delete this.transceivers[a].iceTransport;if(c=this.transceivers[a].dtlsTransport)delete c.ondtlsstatechange,delete c.onerror,delete this.transceivers[a].dtlsTransport};m.prototype._transceive=function(a,c,b){var k=e(a.localCapabilities,a.remoteCapabilities);c&&a.rtpSender&&(k.encodings=a.sendEncodingParameters,k.rtcp=
{cname:f.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(k.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(k));b&&a.rtpReceiver&&0<k.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>d&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),k.encodings=a.recvEncodingParameters.length?a.recvEncodingParameters:[{}],k.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(k.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&
(k.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(k))};m.prototype.setLocalDescription=function(a){var c=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",'Unsupported type "'+a.type+'"'));if(!p("setLocalDescription",a.type,c.signalingState)||c._isClosed)return Promise.reject(l("InvalidStateError","Can not set local "+a.type+" in state "+c.signalingState));if("offer"===a.type){var b=f.splitSections(a.sdp);var d=b.shift();b.forEach(function(a,b){a=
f.parseRtpParameters(a);c.transceivers[b].localCapabilities=a});c.transceivers.forEach(function(a,b){c._gather(a.mid,b)})}else if("answer"===a.type){b=f.splitSections(c._remoteDescription.sdp);d=b.shift();var k=0<f.matchPrefix(d,"a\x3dice-lite").length;b.forEach(function(a,b){var g=c.transceivers[b],l=g.iceGatherer,h=g.iceTransport,p=g.dtlsTransport,n=g.localCapabilities,m=g.remoteCapabilities;if(!(f.isRejected(a)&&0===f.matchPrefix(a,"a\x3dbundle-only").length||g.rejected)){var q=f.getIceParameters(a,
d);a=f.getDtlsParameters(a,d);k&&(a.role="server");c.usingBundle&&0!==b||(c._gather(g.mid,b),"new"===h.state&&h.start(l,q,k?"controlling":"controlled"),"new"===p.state&&p.start(a));b=e(n,m);c._transceive(g,0<b.codecs.length,!1)}})}c._localDescription={type:a.type,sdp:a.sdp};"offer"===a.type?c._updateSignalingState("have-local-offer"):c._updateSignalingState("stable");return Promise.resolve()};m.prototype.setRemoteDescription=function(a){var b=this;if(-1===["offer","answer"].indexOf(a.type))return Promise.reject(l("TypeError",
'Unsupported type "'+a.type+'"'));if(!p("setRemoteDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(l("InvalidStateError","Can not set remote "+a.type+" in state "+b.signalingState));var m={};b.remoteStreams.forEach(function(a){m[a.id]=a});var q=[],t=f.splitSections(a.sdp),r=t.shift(),u=0<f.matchPrefix(r,"a\x3dice-lite").length,y=0<f.matchPrefix(r,"a\x3dgroup:BUNDLE ").length;b.usingBundle=y;var v=f.matchPrefix(r,"a\x3dice-options:")[0];b.canTrickleIceCandidates=v?0<=v.substr(14).split(" ").indexOf("trickle"):
!1;t.forEach(function(l,h){var p=f.splitLines(l),t=f.getKind(l),x=f.isRejected(l)&&0===f.matchPrefix(l,"a\x3dbundle-only").length,E=p[0].substr(2).split(" ")[2],p=f.getDirection(l,r),z=f.parseMsid(l),D=f.getMid(l)||f.generateIdentifier();if(x||"application"===t&&("DTLS/SCTP"===E||"UDP/DTLS/SCTP"===E))b.transceivers[h]={mid:D,kind:t,protocol:E,rejected:!0};else{!x&&b.transceivers[h]&&b.transceivers[h].rejected&&(b.transceivers[h]=b._createTransceiver(t,!0));var F=f.parseRtpParameters(l);if(!x){var v=
f.getIceParameters(l,r);var I=f.getDtlsParameters(l,r);I.role="client"}var E=f.parseRtpEncodingParameters(l),G=f.parseRtcpParameters(l),H=0<f.matchPrefix(l,"a\x3dend-of-candidates",r).length,A=f.matchPrefix(l,"a\x3dcandidate:").map(function(a){return f.parseCandidate(a)}).filter(function(a){return 1===a.component});("offer"===a.type||"answer"===a.type)&&!x&&y&&0<h&&b.transceivers[h]&&(b._disposeIceAndDtlsTransports(h),b.transceivers[h].iceGatherer=b.transceivers[0].iceGatherer,b.transceivers[h].iceTransport=
b.transceivers[0].iceTransport,b.transceivers[h].dtlsTransport=b.transceivers[0].dtlsTransport,b.transceivers[h].rtpSender&&b.transceivers[h].rtpSender.setTransport(b.transceivers[0].dtlsTransport),b.transceivers[h].rtpReceiver&&b.transceivers[h].rtpReceiver.setTransport(b.transceivers[0].dtlsTransport));if("offer"!==a.type||x)"answer"!==a.type||x||(w=b.transceivers[h],B=w.iceGatherer,t=w.iceTransport,D=w.dtlsTransport,C=w.rtpReceiver,x=w.sendEncodingParameters,l=w.localCapabilities,b.transceivers[h].recvEncodingParameters=
E,b.transceivers[h].remoteCapabilities=F,b.transceivers[h].rtcpParameters=G,A.length&&"new"===t.state&&(!u&&!H||y&&0!==h?A.forEach(function(a){n(w.iceTransport,a)}):t.setRemoteCandidates(A)),y&&0!==h||("new"===t.state&&t.start(B,v,"controlling"),"new"===D.state&&D.start(I)),!e(w.localCapabilities,w.remoteCapabilities).codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,b._transceive(w,"sendrecv"===p||"recvonly"===
p,"sendrecv"===p||"sendonly"===p),!C||"sendrecv"!==p&&"sendonly"!==p?delete w.rtpReceiver:(p=C.track,z?(m[z.stream]||(m[z.stream]=new c.MediaStream),k(p,m[z.stream]),q.push([p,C,m[z.stream]])):(m.default||(m.default=new c.MediaStream),k(p,m.default),q.push([p,C,m.default]))));else{var w=b.transceivers[h]||b._createTransceiver(t);w.mid=D;w.iceGatherer||(w.iceGatherer=b._createIceGatherer(h,y));A.length&&"new"===w.iceTransport.state&&(!H||y&&0!==h?A.forEach(function(a){n(w.iceTransport,a)}):w.iceTransport.setRemoteCandidates(A));
l=c.RTCRtpReceiver.getCapabilities(t);15019>d&&(l.codecs=l.codecs.filter(function(a){return"rtx"!==a.name}));x=w.sendEncodingParameters||[{ssrc:1001*(2*h+2)}];v=!1;if("sendrecv"===p||"sendonly"===p){v=!w.rtpReceiver;var C=w.rtpReceiver||new c.RTCRtpReceiver(w.dtlsTransport,t);if(v){p=C.track;if(!z||"-"!==z.stream)if(z){m[z.stream]||(m[z.stream]=new c.MediaStream,Object.defineProperty(m[z.stream],"id",{get:function(){return z.stream}}));Object.defineProperty(p,"id",{get:function(){return z.track}});
var B=m[z.stream]}else m.default||(m.default=new c.MediaStream),B=m.default;B&&(k(p,B),w.associatedRemoteMediaStreams.push(B));q.push([p,C,B])}}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===w.rtpReceiver.track.id});b&&g(b,a)}),w.associatedRemoteMediaStreams=[]);w.localCapabilities=l;w.remoteCapabilities=F;w.rtpReceiver=C;w.rtcpParameters=G;w.sendEncodingParameters=x;w.recvEncodingParameters=E;b._transceive(b.transceivers[h],
!1,v)}}});void 0===b._dtlsRole&&(b._dtlsRole="offer"===a.type?"active":"passive");b._remoteDescription={type:a.type,sdp:a.sdp};"offer"===a.type?b._updateSignalingState("have-remote-offer"):b._updateSignalingState("stable");Object.keys(m).forEach(function(a){var d=m[a];if(d.getTracks().length){if(-1===b.remoteStreams.indexOf(d)){b.remoteStreams.push(d);var e=new Event("addstream");e.stream=d;c.setTimeout(function(){b._dispatchEvent("addstream",e)})}q.forEach(function(a){d.id===a[2].id&&h(b,a[0],a[1],
[d])})}});q.forEach(function(a){a[2]||h(b,a[0],a[1],[])});c.setTimeout(function(){b&&b.transceivers&&b.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3);return Promise.resolve()};m.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();
a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._isClosed=!0;this._updateSignalingState("closed")};m.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",a)};m.prototype._maybeFireNegotiationNeeded=function(){var a=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,c.setTimeout(function(){if(a.needNegotiation){a.needNegotiation=
!1;var b=new Event("negotiationneeded");a._dispatchEvent("negotiationneeded",b)}},0))};m.prototype._updateIceConnectionState=function(){var a={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&a[b.iceTransport.state]++});var b="new";0<a.failed?b="failed":0<a.checking?b="checking":0<a.disconnected?b="disconnected":0<a.new?b="new":0<a.connected?b="connected":0<a.completed&&(b="completed");b!==this.iceConnectionState&&
(this.iceConnectionState=b,b=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",b))};m.prototype._updateConnectionState=function(){var a={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(a[b.iceTransport.state]++,a[b.dtlsTransport.state]++)});a.connected+=a.completed;var b="new";0<a.failed?b="failed":0<a.connecting?b="connecting":0<a.disconnected?b="disconnected":
0<a.new?b="new":0<a.connected&&(b="connected");b!==this.connectionState&&(this.connectionState=b,b=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",b))};m.prototype.createOffer=function(b){var e=this;if(e._isClosed)return Promise.reject(l("InvalidStateError","Can not call createOffer after close"));var k=e.transceivers.filter(function(a){return"audio"===a.kind}).length,g=e.transceivers.filter(function(a){return"video"===a.kind}).length;if(b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");
void 0!==b.offerToReceiveAudio&&(k=!0===b.offerToReceiveAudio?1:!1===b.offerToReceiveAudio?0:b.offerToReceiveAudio);void 0!==b.offerToReceiveVideo&&(g=!0===b.offerToReceiveVideo?1:!1===b.offerToReceiveVideo?0:b.offerToReceiveVideo)}for(e.transceivers.forEach(function(a){"audio"===a.kind?(k--,0>k&&(a.wantReceive=!1)):"video"===a.kind&&(g--,0>g&&(a.wantReceive=!1))});0<k||0<g;)0<k&&(e._createTransceiver("audio"),k--),0<g&&(e._createTransceiver("video"),g--);var h=f.writeSessionBoilerplate(e._sdpSessionId,
e._sdpSessionVersion++);e.transceivers.forEach(function(a,b){var k=a.track,g=a.kind,l=a.mid||f.generateIdentifier();a.mid=l;a.iceGatherer||(a.iceGatherer=e._createIceGatherer(b,e.usingBundle));l=c.RTCRtpSender.getCapabilities(g);15019>d&&(l.codecs=l.codecs.filter(function(a){return"rtx"!==a.name}));l.codecs.forEach(function(b){"H264"===b.name&&void 0===b.parameters["level-asymmetry-allowed"]&&(b.parameters["level-asymmetry-allowed"]="1");a.remoteCapabilities&&a.remoteCapabilities.codecs&&a.remoteCapabilities.codecs.forEach(function(a){b.name.toLowerCase()===
a.name.toLowerCase()&&b.clockRate===a.clockRate&&(b.preferredPayloadType=a.payloadType)})});l.headerExtensions.forEach(function(b){(a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[]).forEach(function(a){b.uri===a.uri&&(b.id=a.id)})});b=a.sendEncodingParameters||[{ssrc:1001*(2*b+1)}];k&&15019<=d&&"video"===g&&!b[0].rtx&&(b[0].rtx={ssrc:b[0].ssrc+1});a.wantReceive&&(a.rtpReceiver=new c.RTCRtpReceiver(a.dtlsTransport,g));a.localCapabilities=l;a.sendEncodingParameters=b});"max-compat"!==
e._config.bundlePolicy&&(h+="a\x3dgroup:BUNDLE "+e.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");h+="a\x3dice-options:trickle\r\n";e.transceivers.forEach(function(b,c){h+=a(b,b.localCapabilities,"offer",b.stream,e._dtlsRole);h+="a\x3drtcp-rsize\r\n";!b.iceGatherer||"new"===e.iceGatheringState||0!==c&&e.usingBundle||(b.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;h+="a\x3d"+f.writeCandidate(a)+"\r\n"}),"completed"===b.iceGatherer.state&&(h+="a\x3dend-of-candidates\r\n"))});
b=new c.RTCSessionDescription({type:"offer",sdp:h});return Promise.resolve(b)};m.prototype.createAnswer=function(){var b=this;if(b._isClosed)return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==b.signalingState&&"have-local-pranswer"!==b.signalingState)return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+b.signalingState));var k=f.writeSessionBoilerplate(b._sdpSessionId,b._sdpSessionVersion++);b.usingBundle&&
(k+="a\x3dgroup:BUNDLE "+b.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var k=k+"a\x3dice-options:trickle\r\n",g=f.getMediaSections(b._remoteDescription.sdp).length;b.transceivers.forEach(function(c,f){if(!(f+1>g))if(c.rejected)"application"===c.kind?k="DTLS/SCTP"===c.protocol?k+"m\x3dapplication 0 DTLS/SCTP 5000\r\n":k+("m\x3dapplication 0 "+c.protocol+" webrtc-datachannel\r\n"):"audio"===c.kind?k+="m\x3daudio 0 UDP/TLS/RTP/SAVPF 0\r\na\x3drtpmap:0 PCMU/8000\r\n":"video"===c.kind&&
(k+="m\x3dvideo 0 UDP/TLS/RTP/SAVPF 120\r\na\x3drtpmap:120 VP8/90000\r\n"),k+="c\x3dIN IP4 0.0.0.0\r\na\x3dinactive\r\na\x3dmid:"+c.mid+"\r\n";else{if(c.stream){var l;"audio"===c.kind?l=c.stream.getAudioTracks()[0]:"video"===c.kind&&(l=c.stream.getVideoTracks()[0]);l&&15019<=d&&"video"===c.kind&&!c.sendEncodingParameters[0].rtx&&(c.sendEncodingParameters[0].rtx={ssrc:c.sendEncodingParameters[0].ssrc+1})}f=e(c.localCapabilities,c.remoteCapabilities);!f.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length&&
c.sendEncodingParameters[0].rtx&&delete c.sendEncodingParameters[0].rtx;k+=a(c,f,"answer",c.stream,b._dtlsRole);c.rtcpParameters&&c.rtcpParameters.reducedSize&&(k+="a\x3drtcp-rsize\r\n")}});var h=new c.RTCSessionDescription({type:"answer",sdp:k});return Promise.resolve(h)};m.prototype.addIceCandidate=function(a){var b=this,c;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(d,e){if(b._remoteDescription)if(a&&""!==a.candidate){var k=
a.sdpMLineIndex;if(a.sdpMid)for(var g=0;g<b.transceivers.length;g++)if(b.transceivers[g].mid===a.sdpMid){k=g;break}var h=b.transceivers[k];if(h){if(h.rejected)return d();g=0<Object.keys(a.candidate).length?f.parseCandidate(a.candidate):{};if("tcp"===g.protocol&&(0===g.port||9===g.port)||g.component&&1!==g.component)return d();if((0===k||0<k&&h.iceTransport!==b.transceivers[0].iceTransport)&&!n(h.iceTransport,g))return e(l("OperationError","Can not add ICE candidate"));e=a.candidate.trim();0===e.indexOf("a\x3d")&&
(e=e.substr(2));c=f.getMediaSections(b._remoteDescription.sdp);c[k]+="a\x3d"+(g.type?e:"end-of-candidates")+"\r\n";b._remoteDescription.sdp=f.getDescription(b._remoteDescription.sdp)+c.join("")}else return e(l("OperationError","Can not add ICE candidate"))}else for(k=0;k<b.transceivers.length&&(b.transceivers[k].rejected||(b.transceivers[k].iceTransport.addRemoteCandidate({}),c=f.getMediaSections(b._remoteDescription.sdp),c[k]+="a\x3dend-of-candidates\r\n",b._remoteDescription.sdp=f.getDescription(b._remoteDescription.sdp)+
c.join(""),!b.usingBundle));k++);else return e(l("InvalidStateError","Can not add ICE candidate without a remote description"));d()})};m.prototype.getStats=function(a){if(a&&a instanceof c.MediaStreamTrack){var b=null;this.transceivers.forEach(function(c){c.rtpSender&&c.rtpSender.track===a?b=c.rtpSender:c.rtpReceiver&&c.rtpReceiver.track===a&&(b=c.rtpReceiver)});if(!b)throw l("InvalidAccessError","Invalid selector.");return b.getStats()}var d=[];this.transceivers.forEach(function(a){["rtpSender",
"rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(b){a[b]&&d.push(a[b].getStats())})});return Promise.all(d).then(function(a){var b=new Map;a.forEach(function(a){a.forEach(function(a){b.set(a.id,a)})});return b})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(a){if((a=c[a])&&a.prototype&&a.prototype.getStats){var b=a.prototype.getStats;a.prototype.getStats=function(){return b.apply(this).then(function(a){var b=new Map;
Object.keys(a).forEach(function(c){var d=a[c];a[c].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[d.type]||d.type;b.set(c,a[c])});return b})}}});var q=["createOffer","createAnswer"];q.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===typeof a[0]||"function"===typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"===typeof a[0]&&
a[0].apply(null,[b])},function(b){"function"===typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}});q=["setLocalDescription","setRemoteDescription","addIceCandidate"];q.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]||"function"===typeof a[2]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)},function(b){"function"===typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}});["getStats"].forEach(function(a){var b=
m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"===typeof a[1]?b.apply(this,arguments).then(function(){"function"===typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}});return m}},{sdp:17}],17:[function(d,h,g){var a={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};a.localCName=a.generateIdentifier();a.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};a.splitSections=function(a){return a.split("\nm\x3d").map(function(a,
b){return(0<b?"m\x3d"+a:a).trim()+"\r\n"})};a.getDescription=function(b){return(b=a.splitSections(b))&&b[0]};a.getMediaSections=function(b){b=a.splitSections(b);b.shift();return b};a.matchPrefix=function(b,d){return a.splitLines(b).filter(function(a){return 0===a.indexOf(d)})};a.parseCandidate=function(a){a=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var b={foundation:a[0],component:parseInt(a[1],10),protocol:a[2].toLowerCase(),priority:parseInt(a[3],
10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]},d=8;d<a.length;d+=2)switch(a[d]){case "raddr":b.relatedAddress=a[d+1];break;case "rport":b.relatedPort=parseInt(a[d+1],10);break;case "tcptype":b.tcpType=a[d+1];break;case "ufrag":b.ufrag=a[d+1];b.usernameFragment=a[d+1];break;default:b[a[d]]=a[d+1]}return b};a.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.address||a.ip);b.push(a.port);var d=a.type;
b.push("typ");b.push(d);"host"!==d&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort));a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType));if(a.usernameFragment||a.ufrag)b.push("ufrag"),b.push(a.usernameFragment||a.ufrag);return"candidate:"+b.join(" ")};a.parseIceOptions=function(a){return a.substr(14).split(" ")};a.parseRtpMap=function(a){a=a.substr(9).split(" ");var b={payloadType:parseInt(a.shift(),10)};
a=a[0].split("/");b.name=a[0];b.clockRate=parseInt(a[1],10);b.channels=3===a.length?parseInt(a[2],10):1;b.numChannels=b.channels;return b};a.writeRtpMap=function(a){var b=a.payloadType;void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType);var d=a.channels||a.numChannels||1;return"a\x3drtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==d?"/"+d:"")+"\r\n"};a.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",uri:a[1]}};
a.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};a.parseFmtp=function(a){for(var b={},d=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<d.length;e++)a=d[e].trim().split("\x3d"),b[a[0].trim()]=a[1];return b};a.writeFmtp=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);if(a.parameters&&Object.keys(a.parameters).length){var e=[];Object.keys(a.parameters).forEach(function(b){a.parameters[b]?
e.push(b+"\x3d"+a.parameters[b]):e.push(b)});b+="a\x3dfmtp:"+d+" "+e.join(";")+"\r\n"}return b};a.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};a.writeRtcpFb=function(a){var b="",d=a.payloadType;void 0!==a.preferredPayloadType&&(d=a.preferredPayloadType);a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a\x3drtcp-fb:"+d+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"});return b};a.parseSsrcMedia=
function(a){var b=a.indexOf(" "),d={ssrc:parseInt(a.substr(7,b-7),10)},e=a.indexOf(":",b);-1<e?(d.attribute=a.substr(b+1,e-b-1),d.value=a.substr(e+1)):d.attribute=a.substr(b+1);return d};a.parseSsrcGroup=function(a){a=a.substr(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(function(a){return parseInt(a,10)})}};a.getMid=function(b){if(b=a.matchPrefix(b,"a\x3dmid:")[0])return b.substr(6)};a.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};
a.getDtlsParameters=function(b,d){return{role:"auto",fingerprints:a.matchPrefix(b+d,"a\x3dfingerprint:").map(a.parseFingerprint)}};a.writeDtlsParameters=function(a,d){var b="a\x3dsetup:"+d+"\r\n";a.fingerprints.forEach(function(a){b+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"});return b};a.getIceParameters=function(b,d){b=a.splitLines(b);b=b.concat(a.splitLines(d));return{usernameFragment:b.filter(function(a){return 0===a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:b.filter(function(a){return 0===
a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};a.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+a.password+"\r\n"};a.parseRtpParameters=function(b){for(var d={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},e=a.splitLines(b)[0].split(" "),g=3;g<e.length;g++){var l=e[g],f=a.matchPrefix(b,"a\x3drtpmap:"+l+" ")[0];if(f){var f=a.parseRtpMap(f),c=a.matchPrefix(b,"a\x3dfmtp:"+l+" ");f.parameters=c.length?a.parseFmtp(c[0]):{};f.rtcpFeedback=a.matchPrefix(b,
"a\x3drtcp-fb:"+l+" ").map(a.parseRtcpFb);d.codecs.push(f);switch(f.name.toUpperCase()){case "RED":case "ULPFEC":d.fecMechanisms.push(f.name.toUpperCase())}}}a.matchPrefix(b,"a\x3dextmap:").forEach(function(b){d.headerExtensions.push(a.parseExtmap(b))});return d};a.writeRtpDescription=function(b,d){var e="",e=e+("m\x3d"+b+" "),e=e+(0<d.codecs.length?"9":"0"),e=e+" UDP/TLS/RTP/SAVPF ",e=e+(d.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+
"\r\n"),e=e+"c\x3dIN IP4 0.0.0.0\r\n",e=e+"a\x3drtcp:9 IN IP4 0.0.0.0\r\n";d.codecs.forEach(function(b){e+=a.writeRtpMap(b);e+=a.writeFmtp(b);e+=a.writeRtcpFb(b)});var g=0;d.codecs.forEach(function(a){a.maxptime>g&&(g=a.maxptime)});0<g&&(e+="a\x3dmaxptime:"+g+"\r\n");e+="a\x3drtcp-mux\r\n";d.headerExtensions&&d.headerExtensions.forEach(function(b){e+=a.writeExtmap(b)});return e};a.parseRtpEncodingParameters=function(b){var d=[],e=a.parseRtpParameters(b),g=-1!==e.fecMechanisms.indexOf("RED"),h=-1!==
e.fecMechanisms.indexOf("ULPFEC"),f=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===a.attribute}),c=0<f.length&&f[0].ssrc,m,f=a.matchPrefix(b,"a\x3dssrc-group:FID").map(function(a){return a.substr(17).split(" ").map(function(a){return parseInt(a,10)})});0<f.length&&1<f[0].length&&f[0][0]===c&&(m=f[0][1]);e.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:c,codecPayloadType:parseInt(a.parameters.apt,10)},
c&&m&&(a.rtx={ssrc:m}),d.push(a),g&&(a=JSON.parse(JSON.stringify(a)),a.fec={ssrc:c,mechanism:h?"red+ulpfec":"red"},d.push(a)))});0===d.length&&c&&d.push({ssrc:c});var q=a.matchPrefix(b,"b\x3d");q.length&&(q=0===q[0].indexOf("b\x3dTIAS:")?parseInt(q[0].substr(7),10):0===q[0].indexOf("b\x3dAS:")?950*parseInt(q[0].substr(5),10)-16E3:void 0,d.forEach(function(a){a.maxBitrate=q}));return d};a.parseRtcpParameters=function(b){var d={},e=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"cname"===
a.attribute})[0];e&&(d.cname=e.value,d.ssrc=e.ssrc);e=a.matchPrefix(b,"a\x3drtcp-rsize");d.reducedSize=0<e.length;d.compound=0===e.length;b=a.matchPrefix(b,"a\x3drtcp-mux");d.mux=0<b.length;return d};a.parseMsid=function(b){var d=a.matchPrefix(b,"a\x3dmsid:");if(1===d.length)return b=d[0].substr(7).split(" "),{stream:b[0],track:b[1]};b=a.matchPrefix(b,"a\x3dssrc:").map(function(b){return a.parseSsrcMedia(b)}).filter(function(a){return"msid"===a.attribute});if(0<b.length)return b=b[0].value.split(" "),
{stream:b[0],track:b[1]}};a.generateSessionId=function(){return Math.random().toString().substr(2,21)};a.writeSessionBoilerplate=function(b,d,e){d=void 0!==d?d:2;b=b?b:a.generateSessionId();return"v\x3d0\r\no\x3d"+(e||"thisisadapterortc")+" "+b+" "+d+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};a.writeMediaSection=function(b,d,e,g){d=a.writeRtpDescription(b.kind,d);d+=a.writeIceParameters(b.iceGatherer.getLocalParameters());d+=a.writeDtlsParameters(b.dtlsTransport.getLocalParameters(),"offer"===
e?"actpass":"active");d+="a\x3dmid:"+b.mid+"\r\n";d=b.direction?d+("a\x3d"+b.direction+"\r\n"):b.rtpSender&&b.rtpReceiver?d+"a\x3dsendrecv\r\n":b.rtpSender?d+"a\x3dsendonly\r\n":b.rtpReceiver?d+"a\x3drecvonly\r\n":d+"a\x3dinactive\r\n";b.rtpSender&&(e="msid:"+g.id+" "+b.rtpSender.track.id+"\r\n",d=d+("a\x3d"+e)+("a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" "+e),b.sendEncodingParameters[0].rtx&&(d+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" "+e,d+="a\x3dssrc-group:FID "+b.sendEncodingParameters[0].ssrc+
" "+b.sendEncodingParameters[0].rtx.ssrc+"\r\n"));d+="a\x3dssrc:"+b.sendEncodingParameters[0].ssrc+" cname:"+a.localCName+"\r\n";b.rtpSender&&b.sendEncodingParameters[0].rtx&&(d+="a\x3dssrc:"+b.sendEncodingParameters[0].rtx.ssrc+" cname:"+a.localCName+"\r\n");return d};a.getDirection=function(b,d){b=a.splitLines(b);for(var e=0;e<b.length;e++)switch(b[e]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return b[e].substr(2)}return d?a.getDirection(d):"sendrecv"};
a.getKind=function(b){return a.splitLines(b)[0].split(" ")[0].substr(2)};a.isRejected=function(a){return"0"===a.split(" ",2)[1]};a.parseMLine=function(b){b=a.splitLines(b)[0].substr(2).split(" ");return{kind:b[0],port:parseInt(b[1],10),protocol:b[2],fmt:b.slice(3).join(" ")}};a.parseOLine=function(b){b=a.matchPrefix(b,"o\x3d")[0].substr(2).split(" ");return{username:b[0],sessionId:b[1],sessionVersion:parseInt(b[2],10),netType:b[3],addressType:b[4],address:b[5]}};a.isValidSDP=function(b){if("string"!==
typeof b||0===b.length)return!1;b=a.splitLines(b);for(var d=0;d<b.length;d++)if(2>b[d].length||"\x3d"!==b[d].charAt(1))return!1;return!0};"object"===typeof h&&(h.exports=a)},{}]},{},[1])(1)}()}])["default"];
//# sourceMappingURL=erizo.js.map
